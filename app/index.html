<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AdInstalGaz - Sistem Management</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#2d2d2d">
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-storage-compat.js"></script>
    
    <!-- EmailJS -->
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script>
        emailjs.init("WLo1YE_LtC7iyQrCx");
    </script>
    
    <!-- SheetJS pentru export Excel -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <style>
        /* Reset și variabile globale */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Paletă de gri */
            --bg-dark: #1a1a1a;
            --bg-primary: #2d2d2d;
            --bg-secondary: #3a3a3a;
            --bg-light: #f5f5f5;
            --bg-card: #ffffff;
            
            /* Text */
            --text-primary: #333333;
            --text-secondary: #666666;
            --text-light: #999999;
            --text-white: #ffffff;
            
            /* Accent */
            --accent: #4a90e2;
            --accent-hover: #357abd;
            --success: #27ae60;
            --warning: #f39c12;
            --danger: #e74c3c;
            
            /* Borders */
            --border-light: #e0e0e0;
            --border-medium: #cccccc;
            
            /* Shadows */
            --shadow-sm: 0 1px 3px rgba(0,0,0,0.1);
            --shadow-md: 0 2px 6px rgba(0,0,0,0.1);
            --shadow-lg: 0 4px 12px rgba(0,0,0,0.1);
            
            /* Font sizes */
            --font-xs: 0.75rem;
            --font-sm: 0.875rem;
            --font-base: 0.938rem;
            --font-lg: 1.125rem;
            --font-xl: 1.5rem;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--bg-light);
            color: var(--text-primary);
            line-height: 1.5;
            font-size: var(--font-base);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 1rem;
        }

        /* Header minimalist */
        .header {
            background: var(--bg-card);
            border-bottom: 1px solid var(--border-light);
            padding: 1rem 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-sm);
        }

        .header h1 {
            font-size: var(--font-xl);
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .header .subtitle {
            color: var(--text-secondary);
            font-size: var(--font-sm);
            margin-top: 0.25rem;
        }

        /* Navigation minimalist */
        .nav-tabs {
            display: flex;
            background: var(--bg-card);
            border-radius: 8px;
            padding: 4px;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-sm);
            overflow-x: auto;
            gap: 2px;
        }

        .nav-tab {
            flex: 1;
            min-width: 100px;
            padding: 0.75rem 1rem;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            font-size: var(--font-sm);
            font-weight: 500;
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.2s ease;
            white-space: nowrap;
            text-align: center;
        }

        .nav-tab:hover {
            background: var(--bg-light);
            color: var(--text-primary);
        }

        .nav-tab.active {
            background: var(--bg-primary);
            color: var(--text-white);
        }

        /* Tab Content */
        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Cards simplificați */
        .card {
            background: var(--bg-card);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-light);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-light);
        }

        .card-header h2 {
            color: var(--text-primary);
            font-size: var(--font-lg);
            font-weight: 600;
        }

        /* Stats minimalist */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border-light);
            padding: 1.5rem;
            border-radius: 8px;
            text-align: center;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .stat-card.warning { border-color: var(--warning); }
        .stat-card.success { border-color: var(--success); }
        .stat-card.info { border-color: var(--accent); }
        .stat-card.danger { border-color: var(--danger); }

        .stat-number {
            font-size: 2rem;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0.5rem 0;
        }

        .stat-label {
            font-size: var(--font-sm);
            color: var(--text-secondary);
        }

        /* Forms minimalist */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
            font-size: var(--font-sm);
            font-weight: 500;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            padding: 0.75rem;
            border: 1px solid var(--border-light);
            border-radius: 6px;
            font-size: var(--font-sm);
            transition: border-color 0.2s ease;
            background: var(--bg-card);
            color: var(--text-primary);
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--accent);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        /* Buttons minimalist */
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 6px;
            font-size: var(--font-sm);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--bg-primary);
            color: var(--text-white);
        }

        .btn-primary:hover {
            background: var(--bg-secondary);
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--bg-light);
            color: var(--text-primary);
            border: 1px solid var(--border-light);
        }

        .btn-secondary:hover {
            background: var(--border-light);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: white;
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: var(--font-xs);
        }

        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        /* Tables minimalist */
        .table-responsive {
            overflow-x: auto;
            border-radius: 8px;
            border: 1px solid var(--border-light);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: var(--bg-card);
        }

        th {
            background: var(--bg-light);
            color: var(--text-secondary);
            font-weight: 600;
            text-align: left;
            padding: 1rem;
            font-size: var(--font-sm);
            border-bottom: 1px solid var(--border-light);
        }

        td {
            padding: 1rem;
            border-bottom: 1px solid var(--border-light);
            font-size: var(--font-sm);
            color: var(--text-primary);
        }

        tr:hover {
            background: var(--bg-light);
        }

        td.text-center {
            text-align: center;
            color: #999;
            font-style: italic;
        }

        /* Badges minimalist */
        .badge {
            padding: 0.25rem 0.75rem;
            border-radius: 4px;
            font-size: var(--font-xs);
            font-weight: 500;
            display: inline-block;
        }

        .badge-success {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .badge-warning {
            background: #fff3e0;
            color: #ef6c00;
        }

        .badge-danger {
            background: #ffebee;
            color: #c62828;
        }

        .badge-info {
            background: #e3f2fd;
            color: #1565c0;
        }

        /* Search Box */
        .search-box {
            position: relative;
            max-width: 400px;
            margin-bottom: 20px;
        }

        .search-box input {
            width: 100%;
            padding: 12px 45px 12px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .search-box input:focus {
            outline: none;
            border-color: #1e3c72;
        }

        /* Modal minimalist */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background: var(--bg-card);
            max-width: 600px;
            margin: 3rem auto;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: var(--shadow-lg);
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-header h3 {
            color: var(--text-primary);
            font-size: var(--font-lg);
            font-weight: 600;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-light);
            padding: 0;
            width: 2rem;
            height: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            transition: background 0.2s ease;
        }

        .close-btn:hover {
            background: var(--bg-light);
            color: var(--text-primary);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }

        .empty-state h3 {
            color: #666;
            margin-bottom: 10px;
        }

        /* Login minimalist */
        .login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-light);
        }

        .login-card {
            background: var(--bg-card);
            padding: 3rem;
            border-radius: 8px;
            box-shadow: var(--shadow-lg);
            width: 100%;
            max-width: 400px;
            border: 1px solid var(--border-light);
        }

        .login-card h2 {
            text-align: center;
            color: var(--text-primary);
            margin-bottom: 2rem;
            font-weight: 600;
        }

        /* Notification minimalist */
        .notification {
            position: fixed;
            top: 1rem;
            right: 1rem;
            max-width: 350px;
            padding: 1rem 1.5rem;
            background: var(--bg-card);
            border-radius: 6px;
            box-shadow: var(--shadow-lg);
            transform: translateX(400px);
            transition: transform 0.3s ease;
            z-index: 2000;
            border: 1px solid var(--border-light);
            font-size: var(--font-sm);
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            border-left: 4px solid var(--success);
        }

        .notification.error {
            border-left: 4px solid var(--danger);
        }

        .notification.warning {
            border-left: 4px solid var(--warning);
        }

        .notification.info {
            border-left: 4px solid var(--accent);
        }

        /* Alert */
        .alert {
            padding: 1rem;
            border-radius: 6px;
            margin-bottom: 1rem;
            font-size: var(--font-sm);
        }

        .alert-info {
            background: #e3f2fd;
            color: #1565c0;
            border: 1px solid #90caf9;
        }

        .alert-warning {
            background: #fff3e0;
            color: #e65100;
            border: 1px solid #ffcc80;
        }

        .alert-success {
            background: #e8f5e9;
            color: #2e7d32;
            border: 1px solid #a5d6a7;
        }

        .alert-danger {
            background: #ffebee;
            color: #c62828;
            border: 1px solid #ef9a9a;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 0.5rem;
            }
            
            .header {
                padding: 1rem;
            }
            
            .nav-tabs {
                gap: 1px;
            }
            
            .nav-tab {
                padding: 0.5rem;
                font-size: var(--font-xs);
            }
            
            .card {
                padding: 1rem;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
            
            table {
                font-size: 14px;
            }
            
            th, td {
                padding: 10px;
            }
        }

        /* Utilities */
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .text-muted { color: var(--text-secondary); }
        .text-small { font-size: var(--font-sm); }
        .mb-0 { margin-bottom: 0; }
        .mb-1 { margin-bottom: 0.5rem; }
        .mb-2 { margin-bottom: 1rem; }
        .mb-3 { margin-bottom: 1.5rem; }
        .mt-1 { margin-top: 0.5rem; }
        .mt-2 { margin-top: 1rem; }
        .mt-3 { margin-top: 1.5rem; }
        .ml-2 { margin-left: 0.5rem; }
    </style>
</head>
<body>
    <!-- Login Section cu 2FA -->
    <div id="loginSection" class="login-container">
        <div class="login-card">
            <div style="text-align: center; margin-bottom: 30px;">
                <h2 style="margin: 0;">AdInstalGaz</h2>
                <p style="color: #666;">Sistem Management Intern</p>
            </div>
            
            <!-- Pasul 1: Email -->
            <div id="emailStep">
                <form onsubmit="trimiteCodeEmail(event)">
                    <div class="form-group">
                        <label>Email Autorizat</label>
                        <input type="email" id="loginEmail" required 
                               placeholder="nume@adinstalgaz.ro" 
                               style="font-size: 16px; padding: 15px;">
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%; padding: 15px; font-size: 16px;">
                        Trimite Cod Verificare
                    </button>
                </form>
            </div>
            
            <!-- Pasul 2: Cod Verificare -->
            <div id="codeStep" style="display: none;">
                <form onsubmit="verificaCod(event)">
                    <p style="text-align: center; margin-bottom: 20px;">
                        Cod trimis la: <strong id="emailAfisare"></strong>
                    </p>
                    <div class="form-group">
                        <label>Cod Verificare (6 cifre)</label>
                        <input type="text" id="codVerificare" 
                               maxlength="6" 
                               pattern="[0-9]{6}" 
                               required 
                               placeholder="000000" 
                               style="text-align: center; font-size: 32px; letter-spacing: 10px; font-weight: bold;">
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%; padding: 15px; font-size: 16px;">
                        Verifică Cod
                    </button>
                    <div style="text-align: center; margin-top: 20px;">
                        <small style="color: #666;">Codul expiră în: <span id="timpRamas" style="color: #dc3545; font-weight: bold;">5:00</span></small>
                    </div>
                </form>
                <button onclick="resetLogin()" class="btn btn-secondary" style="width: 100%; margin-top: 10px;">
                    Înapoi la Email
                </button>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="mainApp" class="container" style="display: none;">
        <!-- Header -->
        <div class="header">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <h1>AdInstalGaz</h1>
                    <div class="subtitle">Sistem Complet de Gestionare Servicii Gaz</div>
                </div>
                <div style="text-align: right;">
                    <div style="color: #666;">
                        <strong id="headerNumeUtilizator">-</strong><br>
                        <small id="headerRolUtilizator">-</small>
                    </div>
                    <button class="btn btn-secondary btn-sm" onclick="logout()" style="margin-top: 10px;">
                        Ieșire
                    </button>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('dashboard')">Dashboard</button>
            <button class="nav-tab" onclick="showTab('clienti')">Clienți</button>
            <button class="nav-tab" onclick="showTab('servicii')">Servicii</button>
            <button class="nav-tab" onclick="showTab('lucrari')">Lucrări</button>
            <button class="nav-tab" onclick="showTab('monitorizare')">Monitorizare</button>
            <button class="nav-tab" onclick="showTab('rapoarte')">Rapoarte</button>
            <button class="nav-tab" onclick="showTab('setari')">Setări</button>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Total Clienți</div>
                    <div class="stat-number" id="totalClienti">0</div>
                    <div class="stat-label">în sistem</div>
                </div>
                <div class="stat-card success">
                    <div class="stat-label">Servicii Active</div>
                    <div class="stat-number" id="serviciiActive">0</div>
                    <div class="stat-label">monitorizate</div>
                </div>
                <div class="stat-card warning" id="expirariCard">
                    <div class="stat-label">Expirări în 7 zile</div>
                    <div class="stat-number" id="expirari7Zile">0</div>
                    <div class="stat-label">necesită atenție</div>
                </div>
                <div class="stat-card info">
                    <div class="stat-label">Lucrări Finalizate</div>
                    <div class="stat-number" id="lucrariFinalizate">0</div>
                    <div class="stat-label">luna aceasta</div>
                </div>
            </div>

            <div id="alerteSMS"></div>

            <div class="card" id="expirariUrgente" style="display: none;">
                <div class="card-header">
                    <h2>Servicii Care Expiră Curând</h2>
                    <button class="btn btn-warning" onclick="exportExpirari()">Export Excel</button>
                </div>
                <div id="listaExpirariUrgente"></div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2>Activitate Recentă</h2>
                </div>
                <div id="activitateRecenta"></div>
            </div>
        </div>

        <!-- Clienți Tab -->
        <div id="clienti" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2>Adaugă Client Nou</h2>
                </div>
                <form id="formClient" onsubmit="adaugaClient(event)">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Nume Complet*</label>
                            <input type="text" id="numeClient" required placeholder="Ex: Ion Popescu">
                        </div>
                        <div class="form-group">
                            <label>Telefon*</label>
                            <input type="tel" id="telefonClient" required placeholder="Ex: 0721234567">
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input type="email" id="emailClient" placeholder="Ex: client@email.com">
                        </div>
                        <div class="form-group">
                            <label>Oraș*</label>
                            <select id="orasClient" required>
                                <option value="">Selectează orașul</option>
                                <option value="Alexandria">Alexandria</option>
                                <option value="Roșiorii de Vede">Roșiorii de Vede</option>
                                <option value="Turnu Măgurele">Turnu Măgurele</option>
                                <option value="Zimnicea">Zimnicea</option>
                                <option value="Videle">Videle</option>
                                <option value="Altul">Altul</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Adresă*</label>
                            <input type="text" id="adresaClient" required placeholder="Ex: Str. Libertății Nr. 25">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Observații</label>
                        <textarea id="observatiiClient" placeholder="Note adiționale despre client"></textarea>
                    </div>
                    <div class="btn-group">
                        <button type="submit" class="btn btn-primary">Salvează Client</button>
                        <button type="button" class="btn btn-secondary" onclick="resetFormClient()">Resetează</button>
                    </div>
                </form>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2>Lista Clienți</h2>
                    <div class="search-box">
                        <input type="text" id="cautaClient" placeholder="Caută după nume sau telefon..." onkeyup="filtreazaClienti()">
                    </div>
                </div>
                <div class="table-responsive">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nume</th>
                                <th>Telefon</th>
                                <th>Email</th>
                                <th>Adresă</th>
                                <th>Servicii</th>
                                <th>Acțiuni</th>
                            </tr>
                        </thead>
                        <tbody id="listaClienti"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Servicii Tab -->
        <div id="servicii" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2>Adaugă Serviciu Nou</h2>
                </div>
                <form id="formServiciu" onsubmit="adaugaServiciu(event)">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Client*</label>
                            <select id="clientServiciu" required>
                                <option value="">Selectează clientul</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Tip Serviciu*</label>
                            <select id="tipServiciu" required onchange="calculeazaDataExpirareAutomata()">
                                <option value="">Selectează tipul</option>
                                <option value="Verificare Instalație Gaz" data-ani="2" data-pret="150">Verificare Instalație Gaz</option>
                                <option value="Revizie Instalație Gaz" data-ani="1" data-pret="250">Revizie Instalație Gaz</option>
                                <option value="Verificare Centrală" data-ani="2" data-pret="150">Verificare Centrală</option>
                                <option value="Instalații Gaz + Centrală" data-ani="2" data-pret="250">Instalații Gaz + Centrală</option>
                                <option value="Servicii de Urgență" data-ani="0" data-pret="0">Servicii de Urgență</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Data Început*</label>
                            <input type="date" id="dataInceputServiciu" required onchange="calculeazaDataExpirareAutomata()">
                        </div>
                        <div class="form-group">
                            <label>Data Expirare*</label>
                            <input type="date" id="dataExpirareServiciu" required>
                        </div>
                        <div class="form-group">
                            <label>Preț*</label>
                            <input type="number" id="pretServiciu" required placeholder="Ex: 150" min="0">
                        </div>
                        <div class="form-group">
                            <label>Observații</label>
                            <textarea id="observatiiServiciu" placeholder="Detalii despre serviciu"></textarea>
                        </div>
                    </div>
                    <div class="btn-group">
                        <button type="submit" class="btn btn-primary">Salvează Serviciu</button>
                        <button type="button" class="btn btn-secondary" onclick="resetFormServiciu()">Resetează</button>
                    </div>
                </form>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2>Lista Servicii</h2>
                    <div class="search-box">
                        <input type="text" id="cautaServiciu" placeholder="Caută serviciu..." onkeyup="filtreazaServicii()">
                    </div>
                </div>
                <div class="table-responsive">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Client</th>
                                <th>Tip Serviciu</th>
                                <th>Data Început</th>
                                <th>Data Expirare</th>
                                <th>Preț</th>
                                <th>Status</th>
                                <th>Zile Rămase</th>
                                <th>Acțiuni</th>
                            </tr>
                        </thead>
                        <tbody id="listaServicii"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Lucrări Tab -->
        <div id="lucrari" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2>Programează Lucrare Nouă</h2>
                </div>
                <form id="formLucrare" onsubmit="adaugaLucrare(event)">
                    <div class="form-grid">
                        <div class="form-group">
                            <label>Client*</label>
                            <select id="clientLucrare" required>
                                <option value="">Selectează clientul</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Serviciu*</label>
                            <select id="serviciuLucrare" required>
                                <option value="">Selectează serviciul</option>
                                <option value="Verificare Instalație Gaz">Verificare Instalație Gaz</option>
                                <option value="Revizie Instalație Gaz">Revizie Instalație Gaz</option>
                                <option value="Verificare Centrală">Verificare Centrală</option>
                                <option value="Instalații Gaz + Centrală">Instalații Gaz + Centrală</option>
                                <option value="Servicii de Urgență">Servicii de Urgență</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Data Programare*</label>
                            <input type="date" id="dataProgramareLucrare" required>
                        </div>
                        <div class="form-group">
                            <label>Preț*</label>
                            <input type="number" id="pretLucrare" required placeholder="Ex: 150" min="0">
                        </div>
                        <div class="form-group">
                            <label>Status</label>
                            <select id="statusLucrare">
                                <option value="programata">Programată</option>
                                <option value="in-curs">În Curs</option>
                                <option value="finalizata">Finalizată</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Observații</label>
                            <textarea id="observatiiLucrare" placeholder="Detalii despre lucrare"></textarea>
                        </div>
                    </div>
                    <div class="btn-group">
                        <button type="submit" class="btn btn-primary">Salvează Lucrare</button>
                        <button type="button" class="btn btn-secondary" onclick="resetFormLucrare()">Resetează</button>
                    </div>
                </form>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2>Lista Lucrări</h2>
                    <div class="btn-group">
                        <button class="btn btn-secondary" onclick="filtreazaLucrari('toate')">Toate</button>
                        <button class="btn btn-info" onclick="filtreazaLucrari('programata')">Programate</button>
                        <button class="btn btn-warning" onclick="filtreazaLucrari('in-curs')">În Curs</button>
                        <button class="btn btn-success" onclick="filtreazaLucrari('finalizata')">Finalizate</button>
                    </div>
                </div>
                <div class="table-responsive">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Client</th>
                                <th>Serviciu</th>
                                <th>Data Programare</th>
                                <th>Preț</th>
                                <th>Status</th>
                                <th>Acțiuni</th>
                            </tr>
                        </thead>
                        <tbody id="listaLucrari"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Monitorizare Tab -->
        <div id="monitorizare" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2>Monitorizare Servicii</h2>
                    <div class="btn-group">
                        <button class="btn btn-warning" onclick="exportExpirari()">Export Excel</button>
                        <button class="btn btn-primary" onclick="trimiteNotificari()">Trimite SMS</button>
                    </div>
                </div>
                
                <div id="listaMonitorizare"></div>
            </div>
        </div>

        <!-- Rapoarte Tab -->
        <div id="rapoarte" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2>Generator Rapoarte</h2>
                </div>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Tip Raport</label>
                        <select id="tipRaport">
                            <option value="lunar">Raport Lunar</option>
                            <option value="trimestrial">Raport Trimestrial</option>
                            <option value="anual">Raport Anual</option>
                            <option value="expirari">Raport Expirări</option>
                            <option value="clienti">Raport Clienți</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Data Început</label>
                        <input type="date" id="dataStartRaport">
                    </div>
                    <div class="form-group">
                        <label>Data Sfârșit</label>
                        <input type="date" id="dataEndRaport">
                    </div>
                </div>
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="genereazaRaport()">Generează Raport</button>
                    <button class="btn btn-success" onclick="exportRaportExcel()">Export Excel</button>
                </div>
            </div>

            <div id="containerRaport" class="card" style="display: none;">
                <div class="card-header">
                    <h2 id="titluRaport">Raport</h2>
                </div>
                <div id="continutRaport"></div>
            </div>
        </div>

        <!-- Setări Tab -->
        <div id="setari" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2>Setări Generale</h2>
                </div>
                <div class="form-grid">
                    <div class="form-group">
                        <label>Utilizator Conectat</label>
                        <input type="text" id="utilizatorConectat" readonly>
                    </div>
                    <div class="form-group">
                        <label>Rol</label>
                        <input type="text" id="rolUtilizator" readonly>
                    </div>
                </div>
                <div class="btn-group">
                    <button class="btn btn-danger" onclick="logout()">Delogare</button>
                    <button class="btn btn-primary" onclick="salveazaSetari()">Salvează Setări</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal pentru editare -->
    <div id="modalEdit" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Editare</h3>
                <button class="close-btn" onclick="inchideModal()">&times;</button>
            </div>
            <div id="modalBody">
                <!-- Conținutul va fi adăugat dinamic -->
            </div>
        </div>
    </div>

    <!-- Notificări -->
    <div id="notification" class="notification"></div>

    <script>
        // Date simulate - în producție ar trebui să fie dintr-o bază de date
        let clienti = JSON.parse(localStorage.getItem('adinstalgaz_clienti') || '[]');
        let servicii = JSON.parse(localStorage.getItem('adinstalgaz_servicii') || '[]');
        let lucrari = JSON.parse(localStorage.getItem('adinstalgaz_lucrari') || '[]');
        let utilizatori = JSON.parse(localStorage.getItem('adinstalgaz_utilizatori') || '[{"id":1,"nume":"Administrator","email":"admin@adinstalgaz.ro","rol":"administrator"}]');
        let utilizatorCurent = JSON.parse(localStorage.getItem('adinstalgaz_user') || 'null');
        
        // Variabile pentru 2FA
        let codTrimis = null;
        let emailCurent = null;
        let timerInterval = null;

        // Funcții pentru notificări
        function arataNotificare(mesaj, tip = 'info') {
            const notification = document.getElementById('notification');
            notification.className = `notification ${tip} show`;
            notification.innerHTML = mesaj;
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Funcții pentru 2FA
        async function trimiteCodeEmail(event) {
            event.preventDefault();
            
            const email = document.getElementById('loginEmail').value.trim();
            
            // Verifică dacă utilizatorul există
            const utilizator = utilizatori.find(u => u.email === email);
            if (!utilizator) {
                arataNotificare('Email invalid sau utilizator inexistent!', 'error');
                return;
            }
            
            // Generează cod 6 cifre
            codTrimis = Math.floor(100000 + Math.random() * 900000).toString();
            emailCurent = email;
            
            try {
                // Trimite email cu EmailJS
                const templateParams = {
                    to_email: email,
                    to_name: utilizator.nume,
                    verification_code: codTrimis,
                    company_name: 'AdInstalGaz'
                };
                
                await emailjs.send('service_dtzcww7', 'template_2eeo9lr', templateParams);
                
                // Afișează pasul 2
                document.getElementById('emailStep').style.display = 'none';
                document.getElementById('codeStep').style.display = 'block';
                document.getElementById('emailAfisare').textContent = email;
                
                // Pornește timer
                startTimer(300);
                
                arataNotificare('Cod trimis pe email! Verificați inbox-ul.', 'success');
                
            } catch (error) {
                console.error('Eroare trimitere email:', error);
                arataNotificare('Eroare la trimiterea codului pe email!', 'error');
                
                // TEMPORAR pentru testare - afișează codul
                alert(`COD DE TEST: ${codTrimis}`);
                
                // Afișează pasul 2
                document.getElementById('emailStep').style.display = 'none';
                document.getElementById('codeStep').style.display = 'block';
                document.getElementById('emailAfisare').textContent = email;
                
                // Pornește timer
                startTimer(300);
            }
        }

        function verificaCod(event) {
            event.preventDefault();
            
            const codIntrodus = document.getElementById('codVerificare').value;
            
            if (codIntrodus !== codTrimis) {
                arataNotificare('Cod invalid!', 'error');
                return;
            }
            
            // Găsește utilizatorul
            const utilizator = utilizatori.find(u => u.email === emailCurent);
            if (!utilizator) {
                arataNotificare('Eroare autentificare!', 'error');
                return;
            }
            
            // Autentificare reușită
            utilizatorCurent = utilizator;
            localStorage.setItem('adinstalgaz_user', JSON.stringify(utilizator));
            
            // Oprește timer
            if (timerInterval) {
                clearInterval(timerInterval);
            }
            
            // Inițializează aplicația
            initializeApp();
            
            // Resetează formularul
            resetLogin();
        }

        function resetLogin() {
            document.getElementById('emailStep').style.display = 'block';
            document.getElementById('codeStep').style.display = 'none';
            document.getElementById('loginEmail').value = '';
            document.getElementById('codVerificare').value = '';
            codTrimis = null;
            emailCurent = null;
            
            if (timerInterval) {
                clearInterval(timerInterval);
            }
        }

        function startTimer(duration) {
            let timer = duration;
            const display = document.getElementById('timpRamas');
            
            timerInterval = setInterval(() => {
                const minutes = parseInt(timer / 60, 10);
                const seconds = parseInt(timer % 60, 10);
                
                display.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
                
                if (--timer < 0) {
                    clearInterval(timerInterval);
                    codTrimis = null;
                    arataNotificare('Codul a expirat! Încercați din nou.', 'warning');
                    resetLogin();
                }
            }, 1000);
        }

        function logout() {
            if (confirm('Sigur doriți să ieșiți din aplicație?')) {
                utilizatorCurent = null;
                localStorage.removeItem('adinstalgaz_user');
                
                // Resetează 2FA
                resetLogin();
                
                // Arată login și ascunde aplicația
                document.getElementById('loginSection').style.display = 'flex';
                document.getElementById('mainApp').style.display = 'none';
            }
        }

        // Funcție pentru inițializare aplicație
        function initializeApp() {
            document.getElementById('loginSection').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
            
            // Actualizează interfața
            document.getElementById('headerNumeUtilizator').textContent = utilizatorCurent.nume;
            document.getElementById('headerRolUtilizator').textContent = utilizatorCurent.rol === 'administrator' ? 'Administrator' : 'Utilizator';
            document.getElementById('utilizatorConectat').value = utilizatorCurent.nume;
            document.getElementById('rolUtilizator').value = utilizatorCurent.rol;
            
            actualizeazaDashboard();
            populeazaSelectClienti();
            
            arataNotificare(`Bine ai venit, ${utilizatorCurent.nume}!`, 'success');
        }

        // Funcție pentru verificare autentificare
        function verificaAutentificare() {
            if (utilizatorCurent) {
                document.getElementById('loginSection').style.display = 'none';
                document.getElementById('mainApp').style.display = 'block';
                
                // Actualizează interfața
                document.getElementById('headerNumeUtilizator').textContent = utilizatorCurent.nume;
                document.getElementById('headerRolUtilizator').textContent = utilizatorCurent.rol === 'administrator' ? 'Administrator' : 'Utilizator';
                document.getElementById('utilizatorConectat').value = utilizatorCurent.nume;
                document.getElementById('rolUtilizator').value = utilizatorCurent.rol;
                
                return true;
            }
            
            document.getElementById('loginSection').style.display = 'flex';
            document.getElementById('mainApp').style.display = 'none';
            return false;
        }

        // Funcții pentru salvare
        function salveazaInLocalStorage() {
            localStorage.setItem('adinstalgaz_clienti', JSON.stringify(clienti));
            localStorage.setItem('adinstalgaz_servicii', JSON.stringify(servicii));
            localStorage.setItem('adinstalgaz_lucrari', JSON.stringify(lucrari));
            localStorage.setItem('adinstalgaz_utilizatori', JSON.stringify(utilizatori));
        }

        // Funcții pentru tabs
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('.nav-tab').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            // Actualizare conținut specific
            if (tabName === 'dashboard') {
                actualizeazaDashboard();
            } else if (tabName === 'clienti') {
                afiseazaClienti();
            } else if (tabName === 'servicii') {
                afiseazaServicii();
                populeazaSelectClienti();
            } else if (tabName === 'lucrari') {
                afiseazaLucrari();
                populeazaSelectClienti();
            } else if (tabName === 'monitorizare') {
                afiseazaMonitorizare();
            } else if (tabName === 'rapoarte') {
                // Rapoarte
            }
        }

        // Funcții pentru Dashboard
        function actualizeazaDashboard() {
            const totalClienti = clienti.length;
            const serviciiActive = servicii.filter(s => {
                const dataExpirare = new Date(s.dataExpirare);
                return dataExpirare > new Date();
            }).length;
            
            const expirari7Zile = servicii.filter(s => {
                const dataExpirare = new Date(s.dataExpirare);
                const diferenta = Math.ceil((dataExpirare - new Date()) / (1000 * 60 * 60 * 24));
                return diferenta >= 0 && diferenta <= 7;
            }).length;
            
            const lucrariFinalizateLunaAceasta = lucrari.filter(l => {
                if (l.status !== 'finalizata') return false;
                const dataCreare = new Date(l.dataCreare);
                const now = new Date();
                return dataCreare.getMonth() === now.getMonth() && 
                       dataCreare.getFullYear() === now.getFullYear();
            }).length;
            
            document.getElementById('totalClienti').textContent = totalClienti;
            document.getElementById('serviciiActive').textContent = serviciiActive;
            document.getElementById('expirari7Zile').textContent = expirari7Zile;
            document.getElementById('lucrariFinalizate').textContent = lucrariFinalizateLunaAceasta;
            
            // Verifică SMS-uri de trimis
            verificaSMSuriDeTrimis();
            
            // Activitate recentă
            afiseazaActivitateRecenta();
        }

        function verificaSMSuriDeTrimis() {
            const serviciiExpira3Zile = servicii.filter(s => {
                const dataExpirare = new Date(s.dataExpirare);
                const diferenta = Math.ceil((dataExpirare - new Date()) / (1000 * 60 * 60 * 24));
                return diferenta === 3;
            });
            
            if (serviciiExpira3Zile.length > 0) {
                const alertDiv = document.createElement('div');
                alertDiv.className = 'alert alert-warning mb-3';
                alertDiv.innerHTML = `
                    <strong>SMS-uri de trimis astăzi!</strong><br>
                    ${serviciiExpira3Zile.length} clienți au servicii care expiră în 3 zile.
                    <button class="btn btn-sm btn-primary ml-2" onclick="trimiteNotificari()">
                        Trimite SMS-uri
                    </button>
                `;
                
                const alerteSMS = document.getElementById('alerteSMS');
                alerteSMS.innerHTML = '';
                alerteSMS.appendChild(alertDiv);
            }
        }

        function afiseazaActivitateRecenta() {
            const container = document.getElementById('activitateRecenta');
            const activitati = [];
            
            // Ultimii 5 clienți
            clienti.slice(-5).reverse().forEach(c => {
                activitati.push({
                    tip: 'client',
                    descriere: `Client nou: ${c.nume}`,
                    data: new Date(c.dataCreare || Date.now())
                });
            });
            
            // Ultimele 5 servicii
            servicii.slice(-5).reverse().forEach(s => {
                const client = clienti.find(c => c.id === s.clientId);
                activitati.push({
                    tip: 'serviciu',
                    descriere: `Serviciu nou: ${s.tip} pentru ${client ? client.nume : 'Client necunoscut'}`,
                    data: new Date(s.dataCreare || Date.now())
                });
            });
            
            activitati.sort((a, b) => b.data - a.data);
            
            if (activitati.length === 0) {
                container.innerHTML = '<div class="empty-state"><p>Nu există activitate recentă</p></div>';
                return;
            }
            
            container.innerHTML = activitati.slice(0, 10).map(a => `
                <div style="padding: 10px; border-bottom: 1px solid #f0f0f0;">
                    <div>${a.descriere}</div>
                    <small style="color: #666;">${a.data.toLocaleString('ro-RO')}</small>
                </div>
            `).join('');
        }

        // Funcții pentru Clienți
        function adaugaClient(event) {
            event.preventDefault();
            
            const client = {
                id: Date.now(),
                nume: document.getElementById('numeClient').value,
                telefon: document.getElementById('telefonClient').value,
                email: document.getElementById('emailClient').value,
                oras: document.getElementById('orasClient').value,
                adresa: document.getElementById('adresaClient').value,
                observatii: document.getElementById('observatiiClient').value,
                dataCreare: new Date().toISOString()
            };
            
            clienti.push(client);
            salveazaInLocalStorage();
            arataNotificare('Client adăugat cu succes!', 'success');
            resetFormClient();
            afiseazaClienti();
            populeazaSelectClienti();
        }

        function resetFormClient() {
            document.getElementById('formClient').reset();
        }

        function afiseazaClienti() {
            const tbody = document.getElementById('listaClienti');
            const searchTerm = document.getElementById('cautaClient').value.toLowerCase();
            
            const clientiFiltrati = clienti.filter(client => 
                client.nume.toLowerCase().includes(searchTerm) ||
                client.telefon.includes(searchTerm)
            );
            
            tbody.innerHTML = clientiFiltrati.map(client => {
                const nrServicii = servicii.filter(s => s.clientId === client.id).length;
                
                return `
                    <tr>
                        <td>${client.id}</td>
                        <td><strong>${client.nume}</strong></td>
                        <td>${client.telefon}</td>
                        <td>${client.email || '-'}</td>
                        <td>${client.adresa}, ${client.oras}</td>
                        <td><span class="badge badge-info">${nrServicii} servicii</span></td>
                        <td>
                            <button class="btn btn-primary btn-sm" onclick="editeazaClient(${client.id})">
                                Editează
                            </button>
                            <button class="btn btn-danger btn-sm" onclick="stergeClient(${client.id})">
                                Șterge
                            </button>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function filtreazaClienti() {
            afiseazaClienti();
        }

        function stergeClient(id) {
            if (confirm('Sigur doriți să ștergeți acest client?')) {
                clienti = clienti.filter(c => c.id !== id);
                servicii = servicii.filter(s => s.clientId !== id);
                lucrari = lucrari.filter(l => l.clientId !== id);
                salveazaInLocalStorage();
                arataNotificare('Client șters cu succes!', 'success');
                afiseazaClienti();
                populeazaSelectClienti();
            }
        }

        // Funcții pentru Servicii
        function populeazaSelectClienti() {
            const selects = ['clientServiciu', 'clientLucrare'];
            
            selects.forEach(selectId => {
                const select = document.getElementById(selectId);
                if (select) {
                    select.innerHTML = '<option value="">Selectează clientul</option>' +
                        clienti.map(c => `<option value="${c.id}">${c.nume} - ${c.telefon}</option>`).join('');
                }
            });
        }

        function calculeazaDataExpirareAutomata() {
            const tipServiciu = document.getElementById('tipServiciu');
            const dataInceput = document.getElementById('dataInceputServiciu').value;
            const dataExpirare = document.getElementById('dataExpirareServiciu');
            const pretServiciu = document.getElementById('pretServiciu');
            
            if (!tipServiciu.value || !dataInceput) return;
            
            const selectedOption = tipServiciu.options[tipServiciu.selectedIndex];
            const ani = parseInt(selectedOption.getAttribute('data-ani') || '0');
            const pret = selectedOption.getAttribute('data-pret') || '0';
            
            // Calculează data expirare
            if (ani > 0) {
                const dataStart = new Date(dataInceput);
                dataStart.setFullYear(dataStart.getFullYear() + ani);
                dataExpirare.value = dataStart.toISOString().split('T')[0];
            }
            
            // Setează prețul
            if (pret !== '0') {
                pretServiciu.value = pret;
            }
        }

        function adaugaServiciu(event) {
            event.preventDefault();
            
            const serviciu = {
                id: Date.now(),
                clientId: parseInt(document.getElementById('clientServiciu').value),
                tip: document.getElementById('tipServiciu').value,
                dataInceput: document.getElementById('dataInceputServiciu').value,
                dataExpirare: document.getElementById('dataExpirareServiciu').value,
                pret: parseFloat(document.getElementById('pretServiciu').value),
                observatii: document.getElementById('observatiiServiciu').value,
                dataCreare: new Date().toISOString()
            };
            
            servicii.push(serviciu);
            salveazaInLocalStorage();
            arataNotificare('Serviciu adăugat cu succes!', 'success');
            resetFormServiciu();
            afiseazaServicii();
        }

        function resetFormServiciu() {
            document.getElementById('formServiciu').reset();
        }

        function afiseazaServicii() {
            const tbody = document.getElementById('listaServicii');
            const searchTerm = document.getElementById('cautaServiciu').value.toLowerCase();
            
            const serviciiFiltrare = servicii.filter(serviciu => {
                const client = clienti.find(c => c.id === serviciu.clientId);
                return client && (
                    client.nume.toLowerCase().includes(searchTerm) ||
                    serviciu.tip.toLowerCase().includes(searchTerm)
                );
            });
            
            tbody.innerHTML = serviciiFiltrare.map(serviciu => {
                const client = clienti.find(c => c.id === serviciu.clientId);
                const dataExpirare = new Date(serviciu.dataExpirare);
                const zileRamase = Math.ceil((dataExpirare - new Date()) / (1000 * 60 * 60 * 24));
                
                let statusBadge = '';
                let zileBadge = '';
                
                if (zileRamase < 0) {
                    statusBadge = '<span class="badge badge-danger">Expirat</span>';
                    zileBadge = `<span class="badge badge-danger">${Math.abs(zileRamase)} zile depășite</span>`;
                } else if (zileRamase <= 7) {
                    statusBadge = '<span class="badge badge-warning">Expiră curând</span>';
                    zileBadge = `<span class="badge badge-warning">${zileRamase} zile</span>`;
                } else if (zileRamase <= 30) {
                    statusBadge = '<span class="badge badge-info">Activ</span>';
                    zileBadge = `<span class="badge badge-info">${zileRamase} zile</span>`;
                } else {
                    statusBadge = '<span class="badge badge-success">Activ</span>';
                    zileBadge = `<span class="badge badge-success">${zileRamase} zile</span>`;
                }
                
                return `
                    <tr>
                        <td>${serviciu.id}</td>
                        <td><strong>${client ? client.nume : 'Client șters'}</strong></td>
                        <td>${serviciu.tip}</td>
                        <td>${formatDate(serviciu.dataInceput)}</td>
                        <td>${formatDate(serviciu.dataExpirare)}</td>
                        <td>${serviciu.pret} Lei</td>
                        <td>${statusBadge}</td>
                        <td>${zileBadge}</td>
                        <td>
                            <button class="btn btn-primary btn-sm" onclick="editeazaServiciu(${serviciu.id})">
                                Editează
                            </button>
                            <button class="btn btn-danger btn-sm" onclick="stergeServiciu(${serviciu.id})">
                                Șterge
                            </button>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function filtreazaServicii() {
            afiseazaServicii();
        }

        function stergeServiciu(id) {
            if (confirm('Sigur doriți să ștergeți acest serviciu?')) {
                servicii = servicii.filter(s => s.id !== id);
                salveazaInLocalStorage();
                arataNotificare('Serviciu șters cu succes!', 'success');
                afiseazaServicii();
            }
        }

        // Funcții pentru Lucrări
        function adaugaLucrare(event) {
            event.preventDefault();
            
            const lucrare = {
                id: Date.now(),
                clientId: parseInt(document.getElementById('clientLucrare').value),
                serviciu: document.getElementById('serviciuLucrare').value,
                dataProgramare: document.getElementById('dataProgramareLucrare').value,
                pret: parseFloat(document.getElementById('pretLucrare').value),
                status: document.getElementById('statusLucrare').value,
                observatii: document.getElementById('observatiiLucrare').value,
                dataCreare: new Date().toISOString()
            };
            
            lucrari.push(lucrare);
            salveazaInLocalStorage();
            arataNotificare('Lucrare adăugată cu succes!', 'success');
            resetFormLucrare();
            afiseazaLucrari();
        }

        function resetFormLucrare() {
            document.getElementById('formLucrare').reset();
        }

        function afiseazaLucrari() {
            const tbody = document.getElementById('listaLucrari');
            
            tbody.innerHTML = lucrari.map(lucrare => {
                const client = clienti.find(c => c.id === lucrare.clientId);
                
                return `
                    <tr>
                        <td>${lucrare.id}</td>
                        <td><strong>${client ? client.nume : 'Client șters'}</strong></td>
                        <td>${lucrare.serviciu}</td>
                        <td>${formatDate(lucrare.dataProgramare)}</td>
                        <td>${lucrare.pret} Lei</td>
                        <td>${getStatusBadge(lucrare.status)}</td>
                        <td>
                            <button class="btn btn-primary btn-sm" onclick="editeazaLucrare(${lucrare.id})">
                                Editează
                            </button>
                            <button class="btn btn-danger btn-sm" onclick="stergeLucrare(${lucrare.id})">
                                Șterge
                            </button>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function getStatusBadge(status) {
            const badges = {
                'programata': '<span class="badge badge-info">Programată</span>',
                'in-curs': '<span class="badge badge-warning">În Curs</span>',
                'finalizata': '<span class="badge badge-success">Finalizată</span>'
            };
            return badges[status] || status;
        }

        function filtreazaLucrari(status) {
            const tbody = document.getElementById('listaLucrari');
            let lucrariFiltrare = lucrari;
            
            if (status !== 'toate') {
                lucrariFiltrare = lucrari.filter(l => l.status === status);
            }
            
            tbody.innerHTML = lucrariFiltrare.map(lucrare => {
                const client = clienti.find(c => c.id === lucrare.clientId);
                
                return `
                    <tr>
                        <td>${lucrare.id}</td>
                        <td><strong>${client ? client.nume : 'Client șters'}</strong></td>
                        <td>${lucrare.serviciu}</td>
                        <td>${formatDate(lucrare.dataProgramare)}</td>
                        <td>${lucrare.pret} Lei</td>
                        <td>${getStatusBadge(lucrare.status)}</td>
                        <td>
                            <button class="btn btn-primary btn-sm" onclick="editeazaLucrare(${lucrare.id})">
                                Editează
                            </button>
                            <button class="btn btn-danger btn-sm" onclick="stergeLucrare(${lucrare.id})">
                                Șterge
                            </button>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function stergeLucrare(id) {
            if (confirm('Sigur doriți să ștergeți această lucrare?')) {
                lucrari = lucrari.filter(l => l.id !== id);
                salveazaInLocalStorage();
                arataNotificare('Lucrare ștearsă cu succes!', 'success');
                afiseazaLucrari();
            }
        }

        // Funcții pentru Monitorizare
        function afiseazaMonitorizare() {
            const container = document.getElementById('listaMonitorizare');
            
            const serviciiSortate = servicii.sort((a, b) => new Date(a.dataExpirare) - new Date(b.dataExpirare));
            
            container.innerHTML = serviciiSortate.map(serviciu => {
                const client = clienti.find(c => c.id === serviciu.clientId);
                const dataExpirare = new Date(serviciu.dataExpirare);
                const zileRamase = Math.ceil((dataExpirare - new Date()) / (1000 * 60 * 60 * 24));
                
                let clasa = '';
                let badge = '';
                
                if (zileRamase < 0) {
                    clasa = 'alert-danger';
                    badge = `<span class="badge badge-danger">${Math.abs(zileRamase)} zile depășite</span>`;
                } else if (zileRamase <= 7) {
                    clasa = 'alert-warning';
                    badge = `<span class="badge badge-warning">${zileRamase} zile</span>`;
                } else if (zileRamase <= 30) {
                    clasa = 'alert-info';
                    badge = `<span class="badge badge-info">${zileRamase} zile</span>`;
                } else {
                    clasa = 'alert-success';
                    badge = `<span class="badge badge-success">${zileRamase} zile</span>`;
                }
                
                return `
                    <div class="alert ${clasa}" style="margin-bottom: 10px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong>${client ? client.nume : 'Client necunoscut'}</strong><br>
                                <small>${serviciu.tip}</small><br>
                                <small>Expiră: ${formatDate(serviciu.dataExpirare)}</small>
                            </div>
                            ${badge}
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Funcții pentru SMS
        function trimiteNotificari() {
            const serviciiExpira = servicii.filter(s => {
                const dataExpirare = new Date(s.dataExpirare);
                const diferenta = Math.ceil((dataExpirare - new Date()) / (1000 * 60 * 60 * 24));
                return diferenta === 3;
            });
            
            if (serviciiExpira.length === 0) {
                arataNotificare('Nu există servicii care expiră în exact 3 zile.', 'info');
                return;
            }
            
            const modal = document.getElementById('modalEdit');
            const modalTitle = document.getElementById('modalTitle');
            const modalBody = document.getElementById('modalBody');
            
            modalTitle.textContent = 'Trimite SMS Notificare Expirare';
            
            let htmlContent = `
                <div class="alert alert-info mb-3">
                    <strong>Servicii care expiră în 3 zile: ${serviciiExpira.length}</strong><br>
                    <small>SMS-urile vor fi trimise manual prin telefon</small>
                </div>
                
                <div style="max-height: 400px; overflow-y: auto; margin-bottom: 20px;">
                    <table>
                        <thead>
                            <tr>
                                <th>Client</th>
                                <th>Telefon</th>
                                <th>Serviciu</th>
                                <th>Expiră la</th>
                                <th>Mesaj SMS</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            serviciiExpira.forEach(s => {
                const client = clienti.find(c => c.id === s.clientId);
                if (!client) return;
                
                const dataExpirare = new Date(s.dataExpirare).toLocaleDateString('ro-RO');
                const mesaj = `Buna ziua! Dl/Dna ${client.nume}, va reamintim ca serviciul de ${s.tip} contractat expira la data de ${dataExpirare}. Va rugam sa ne contactati pentru reinnoire la 0762614401. Multumim! AdInstalGaz`;
                
                htmlContent += `
                    <tr>
                        <td><strong>${client.nume}</strong></td>
                        <td>${client.telefon}</td>
                        <td>${s.tip}</td>
                        <td>${dataExpirare}</td>
                        <td style="font-size: 12px; max-width: 200px;">${mesaj}</td>
                    </tr>
                `;
            });
            
            htmlContent += `
                        </tbody>
                    </table>
                </div>
                
                <div class="alert alert-warning">
                    <strong>Instrucțiuni pentru trimitere SMS:</strong>
                    <ol style="margin-bottom: 0; padding-left: 20px;">
                        <li>Copiați mesajul pentru fiecare client</li>
                        <li>Trimiteți SMS-ul manual de pe telefon</li>
                        <li>Confirmați trimiterea în aplicație</li>
                    </ol>
                </div>
                
                <div class="btn-group" style="width: 100%;">
                    <button class="btn btn-success" onclick="genereazaListaSMS()">
                        Generează Lista SMS
                    </button>
                    <button class="btn btn-primary" onclick="deschideWhatsApp()">
                        Deschide WhatsApp
                    </button>
                    <button class="btn btn-warning" onclick="marcheazaSMSTrimise()">
                        Confirmă Trimitere
                    </button>
                    <button class="btn btn-secondary" onclick="inchideModal()">
                        Închide
                    </button>
                </div>
            `;
            
            modalBody.innerHTML = htmlContent;
            modal.style.display = 'block';
        }

        function genereazaListaSMS() {
            const serviciiExpira = servicii.filter(s => {
                const dataExpirare = new Date(s.dataExpirare);
                const diferenta = Math.ceil((dataExpirare - new Date()) / (1000 * 60 * 60 * 24));
                return diferenta === 3;
            });
            
            let txtContent = 'LISTĂ SMS NOTIFICARE EXPIRARE SERVICII\n';
            txtContent += `Data: ${new Date().toLocaleDateString('ro-RO')}\n`;
            txtContent += `Total SMS-uri: ${serviciiExpira.length}\n`;
            txtContent += '=====================================\n\n';
            
            serviciiExpira.forEach((s, index) => {
                const client = clienti.find(c => c.id === s.clientId);
                if (!client) return;
                
                const dataExpirare = new Date(s.dataExpirare).toLocaleDateString('ro-RO');
                const mesaj = `Buna ziua! Dl/Dna ${client.nume}, va reamintim ca serviciul de ${s.tip} contractat expira la data de ${dataExpirare}. Va rugam sa ne contactati pentru reinnoire la 0762614401. Multumim! AdInstalGaz`;
                
                txtContent += `${index + 1}. ${client.nume}\n`;
                txtContent += `Tel: ${client.telefon}\n`;
                txtContent += `Serviciu: ${s.tip}\n`;
                txtContent += `Expiră: ${dataExpirare}\n`;
                txtContent += `Mesaj: ${mesaj}\n`;
                txtContent += '---\n\n';
            });
            
            const blob = new Blob([txtContent], { type: 'text/plain;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `sms-notificari-${new Date().toISOString().split('T')[0]}.txt`;
            link.click();
            
            arataNotificare(`Lista generată cu ${serviciiExpira.length} SMS-uri!`, 'success');
        }

        function deschideWhatsApp() {
            const serviciiExpira = servicii.filter(s => {
                const dataExpirare = new Date(s.dataExpirare);
                const diferenta = Math.ceil((dataExpirare - new Date()) / (1000 * 60 * 60 * 24));
                return diferenta === 3;
            });
            
            if (serviciiExpira.length === 0) {
                arataNotificare('Nu există servicii care expiră în 3 zile!', 'warning');
                return;
            }
            
            const maxTabs = Math.min(serviciiExpira.length, 5);
            
            for (let i = 0; i < maxTabs; i++) {
                const s = serviciiExpira[i];
                const client = clienti.find(c => c.id === s.clientId);
                if (!client) continue;
                
                let telefon = client.telefon;
                if (telefon.startsWith('0')) {
                    telefon = '40' + telefon.substring(1);
                }
                
                const dataExpirare = new Date(s.dataExpirare).toLocaleDateString('ro-RO');
                const mesaj = `Buna ziua! Dl/Dna ${client.nume}, va reamintim ca serviciul de ${s.tip} contractat expira la data de ${dataExpirare}. Va rugam sa ne contactati pentru reinnoire la 0762614401. Multumim! AdInstalGaz`;
                
                const whatsappURL = `https://wa.me/${telefon}?text=${encodeURIComponent(mesaj)}`;
                
                setTimeout(() => {
                    window.open(whatsappURL, '_blank');
                }, i * 1000);
            }
            
            if (serviciiExpira.length > 5) {
                arataNotificare(`Primele 5 din ${serviciiExpira.length} SMS-uri deschise în WhatsApp`, 'info');
            }
        }

        function marcheazaSMSTrimise() {
            const serviciiExpira = servicii.filter(s => {
                const dataExpirare = new Date(s.dataExpirare);
                const diferenta = Math.ceil((dataExpirare - new Date()) / (1000 * 60 * 60 * 24));
                return diferenta === 3;
            });
            
            if (!confirm(`Confirmați trimiterea a ${serviciiExpira.length} SMS-uri?`)) {
                return;
            }
            
            // Salvează în localStorage că SMS-urile au fost trimise
            const smsHistory = JSON.parse(localStorage.getItem('adinstalgaz_sms_history') || '[]');
            const today = new Date().toISOString().split('T')[0];
            
            smsHistory.push({
                data: today,
                numarSMS: serviciiExpira.length,
                utilizator: utilizatorCurent.nume
            });
            
            localStorage.setItem('adinstalgaz_sms_history', JSON.stringify(smsHistory));
            
            arataNotificare(`${serviciiExpira.length} SMS-uri marcate ca trimise!`, 'success');
            inchideModal();
        }

        // Funcții pentru Export Excel
        function exportExpirari() {
            const expirari = servicii.filter(s => {
                const zileRamase = Math.ceil((new Date(s.dataExpirare) - new Date()) / (1000 * 60 * 60 * 24));
                return zileRamase >= -30 && zileRamase <= 30;
            }).sort((a, b) => new Date(a.dataExpirare) - new Date(b.dataExpirare));
            
            const datePentruExport = expirari.map(s => {
                const client = clienti.find(c => c.id === s.clientId);
                const zileRamase = Math.ceil((new Date(s.dataExpirare) - new Date()) / (1000 * 60 * 60 * 24));
                const status = zileRamase < 0 ? 'EXPIRAT' : zileRamase <= 7 ? 'URGENT' : zileRamase <= 30 ? 'ATENȚIE' : 'OK';
                
                return {
                    'Client': client ? client.nume : 'Client necunoscut',
                    'Telefon': client ? client.telefon : '',
                    'Email': client ? client.email || '' : '',
                    'Adresa': client ? client.adresa : '',
                    'Oras': client ? client.oras : '',
                    'Tip Serviciu': s.tip,
                    'Data Expirare': formatDate(s.dataExpirare),
                    'Zile Ramase': Math.abs(zileRamase),
                    'Status': status,
                    'Pret': s.pret + ' Lei'
                };
            });
            
            const ws = XLSX.utils.json_to_sheet(datePentruExport);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Expirari Servicii');
            
            XLSX.writeFile(wb, `expirari-servicii-${new Date().toISOString().split('T')[0]}.xlsx`);
            
            arataNotificare(`Export realizat cu succes! ${expirari.length} servicii exportate.`, 'success');
        }

        // Funcții pentru Rapoarte
        function genereazaRaport() {
            const tipRaport = document.getElementById('tipRaport').value;
            const dataStart = document.getElementById('dataStartRaport').value;
            const dataEnd = document.getElementById('dataEndRaport').value;
            
            const containerRaport = document.getElementById('containerRaport');
            const titluRaport = document.getElementById('titluRaport');
            const continutRaport = document.getElementById('continutRaport');
            
            containerRaport.style.display = 'block';
            
            let continut = '';
            
            switch (tipRaport) {
                case 'lunar':
                    titluRaport.textContent = 'Raport Lunar';
                    continut = genereazaRaportLunar(dataStart, dataEnd);
                    break;
                case 'trimestrial':
                    titluRaport.textContent = 'Raport Trimestrial';
                    continut = genereazaRaportTrimestrial(dataStart, dataEnd);
                    break;
                case 'anual':
                    titluRaport.textContent = 'Raport Anual';
                    continut = genereazaRaportAnual(dataStart, dataEnd);
                    break;
                case 'expirari':
                    titluRaport.textContent = 'Raport Expirări';
                    continut = genereazaRaportExpirari();
                    break;
                case 'clienti':
                    titluRaport.textContent = 'Raport Clienți';
                    continut = genereazaRaportClienti();
                    break;
                default:
                    continut = '<p>Selectați un tip de raport valid.</p>';
            }
            
            continutRaport.innerHTML = continut;
        }

        function genereazaRaportLunar(dataStart, dataEnd) {
            const start = dataStart ? new Date(dataStart) : new Date(new Date().getFullYear(), new Date().getMonth(), 1);
            const end = dataEnd ? new Date(dataEnd) : new Date();
            
            const lucrariPeriada = lucrari.filter(l => {
                const dataLucrare = new Date(l.dataProgramare);
                return dataLucrare >= start && dataLucrare <= end;
            });
            
            const totalIncasari = lucrariPeriada
                .filter(l => l.status === 'finalizata')
                .reduce((sum, l) => sum + l.pret, 0);
            
            return `
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number">${lucrariPeriada.length}</div>
                        <div class="stat-label">Total Lucrări</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${lucrariPeriada.filter(l => l.status === 'finalizata').length}</div>
                        <div class="stat-label">Finalizate</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${totalIncasari} Lei</div>
                        <div class="stat-label">Total Încasări</div>
                    </div>
                </div>
                
                <h3>Detalii Lucrări</h3>
                <div class="table-responsive">
                    <table>
                        <thead>
                            <tr>
                                <th>Data</th>
                                <th>Client</th>
                                <th>Serviciu</th>
                                <th>Preț</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${lucrariPeriada.map(l => {
                                const client = clienti.find(c => c.id === l.clientId);
                                return `
                                    <tr>
                                        <td>${formatDate(l.dataProgramare)}</td>
                                        <td>${client ? client.nume : 'Client necunoscut'}</td>
                                        <td>${l.serviciu}</td>
                                        <td>${l.pret} Lei</td>
                                        <td>${getStatusBadge(l.status)}</td>
                                    </tr>
                                `;
                            }).join('')}
                        </tbody>
                    </table>
                </div>
            `;
        }

        function genereazaRaportTrimestrial(dataStart, dataEnd) {
            return genereazaRaportLunar(dataStart, dataEnd);
        }

        function genereazaRaportAnual(dataStart, dataEnd) {
            return genereazaRaportLunar(dataStart, dataEnd);
        }

        function genereazaRaportExpirari() {
            const expirari = servicii.map(s => {
                const client = clienti.find(c => c.id === s.clientId);
                const dataExpirare = new Date(s.dataExpirare);
                const zileRamase = Math.ceil((dataExpirare - new Date()) / (1000 * 60 * 60 * 24));
                
                return {
                    ...s,
                    client: client,
                    zileRamase: zileRamase
                };
            }).sort((a, b) => a.zileRamase - b.zileRamase);
            
            const expirate = expirari.filter(e => e.zileRamase < 0);
            const urgent = expirari.filter(e => e.zileRamase >= 0 && e.zileRamase <= 7);
            
            return `
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number">${expirate.length}</div>
                        <div class="stat-label">Servicii Expirate</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${urgent.length}</div>
                        <div class="stat-label">Expiră în 7 zile</div>
                    </div>
                </div>
                
                ${expirate.length > 0 ? `
                    <h3 style="color: #dc3545;">Servicii Expirate</h3>
                    <div class="table-responsive">
                        <table>
                            <thead>
                                <tr>
                                    <th>Client</th>
                                    <th>Telefon</th>
                                    <th>Serviciu</th>
                                    <th>Data Expirare</th>
                                    <th>Zile Depășite</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${expirate.map(e => `
                                    <tr>
                                        <td><strong>${e.client ? e.client.nume : 'Client necunoscut'}</strong></td>
                                        <td>${e.client ? e.client.telefon : '-'}</td>
                                        <td>${e.tip}</td>
                                        <td>${formatDate(e.dataExpirare)}</td>
                                        <td><span class="badge badge-danger">${Math.abs(e.zileRamase)} zile</span></td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                ` : ''}
            `;
        }

        function genereazaRaportClienti() {
            const clientiCuStatistici = clienti.map(client => {
                const serviciiClient = servicii.filter(s => s.clientId === client.id);
                const lucrariClient = lucrari.filter(l => l.clientId === client.id);
                const totalCheltuit = lucrariClient
                    .filter(l => l.status === 'finalizata')
                    .reduce((sum, l) => sum + l.pret, 0);
                
                return {
                    ...client,
                    nrServicii: serviciiClient.length,
                    nrLucrari: lucrariClient.length,
                    totalCheltuit: totalCheltuit
                };
            }).sort((a, b) => b.totalCheltuit - a.totalCheltuit);
            
            return `
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number">${clienti.length}</div>
                        <div class="stat-label">Total Clienți</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${clientiCuStatistici.filter(c => c.nrServicii > 0).length}</div>
                        <div class="stat-label">Clienți Activi</div>
                    </div>
                </div>
                
                <h3>Top Clienți</h3>
                <div class="table-responsive">
                    <table>
                        <thead>
                            <tr>
                                <th>Client</th>
                                <th>Telefon</th>
                                <th>Oraș</th>
                                <th>Servicii</th>
                                <th>Lucrări</th>
                                <th>Total Cheltuit</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${clientiCuStatistici.map(client => `
                                <tr>
                                    <td><strong>${client.nume}</strong></td>
                                    <td>${client.telefon}</td>
                                    <td>${client.oras || '-'}</td>
                                    <td><span class="badge badge-info">${client.nrServicii}</span></td>
                                    <td><span class="badge badge-primary">${client.nrLucrari}</span></td>
                                    <td><strong>${client.totalCheltuit} Lei</strong></td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            `;
        }

        function exportRaportExcel() {
            const tipRaport = document.getElementById('tipRaport').value;
            let datePentruExport = [];
            let numeFile = '';
            
            switch (tipRaport) {
                case 'clienti':
                    datePentruExport = clienti.map(client => {
                        const serviciiClient = servicii.filter(s => s.clientId === client.id);
                        const lucrariClient = lucrari.filter(l => l.clientId === client.id);
                        const totalCheltuit = lucrariClient
                            .filter(l => l.status === 'finalizata')
                            .reduce((sum, l) => sum + l.pret, 0);
                        
                        return {
                            'Nume': client.nume,
                            'Telefon': client.telefon,
                            'Email': client.email || '',
                            'Adresa': client.adresa,
                            'Oras': client.oras,
                            'Nr Servicii': serviciiClient.length,
                            'Nr Lucrari': lucrariClient.length,
                            'Total Cheltuit': totalCheltuit + ' Lei'
                        };
                    });
                    numeFile = 'raport-clienti';
                    break;
                    
                case 'expirari':
                    datePentruExport = servicii.map(s => {
                        const client = clienti.find(c => c.id === s.clientId);
                        const zileRamase = Math.ceil((new Date(s.dataExpirare) - new Date()) / (1000 * 60 * 60 * 24));
                        const status = zileRamase < 0 ? 'EXPIRAT' : zileRamase <= 7 ? 'URGENT' : 'OK';
                        
                        return {
                            'Client': client ? client.nume : 'Client necunoscut',
                            'Telefon': client ? client.telefon : '',
                            'Tip Serviciu': s.tip,
                            'Data Expirare': formatDate(s.dataExpirare),
                            'Zile Ramase': Math.abs(zileRamase),
                            'Status': status,
                            'Pret': s.pret + ' Lei'
                        };
                    });
                    numeFile = 'raport-expirari';
                    break;
                    
                default:
                    datePentruExport = lucrari.map(l => {
                        const client = clienti.find(c => c.id === l.clientId);
                        return {
                            'Client': client ? client.nume : 'Client necunoscut',
                            'Serviciu': l.serviciu,
                            'Data Programare': formatDate(l.dataProgramare),
                            'Pret': l.pret + ' Lei',
                            'Status': l.status
                        };
                    });
                    numeFile = 'raport-lucrari';
            }
            
            const ws = XLSX.utils.json_to_sheet(datePentruExport);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Raport');
            
            XLSX.writeFile(wb, `${numeFile}-${new Date().toISOString().split('T')[0]}.xlsx`);
            
            arataNotificare('Raport exportat cu succes în Excel!', 'success');
        }

        // Funcții pentru Setări
        function salveazaSetari() {
            arataNotificare('Setările au fost salvate!', 'success');
        }

        // Funcții utilitare
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('ro-RO');
        }

        function inchideModal() {
            document.getElementById('modalEdit').style.display = 'none';
        }

        // Event listeners
        window.onclick = function(event) {
            const modal = document.getElementById('modalEdit');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        }

        // Inițializare aplicație
        document.addEventListener('DOMContentLoaded', function() {
            // Verifică autentificarea
            if (!verificaAutentificare()) {
                document.getElementById('loginSection').style.display = 'flex';
                document.getElementById('mainApp').style.display = 'none';
            } else {
                actualizeazaDashboard();
                populeazaSelectClienti();
            }
        });
    </script>
</body>
</html>
