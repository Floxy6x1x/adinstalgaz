<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#2563eb">
    <title>AdInstalGaz - Management Instala»õii</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIkFkSW5zdGFsR2F6IC0gTWFuYWdlbWVudCBJbnN0YWxhdGlpIiwKICAic2hvcnRfbmFtZSI6ICJBZEluc3RhbEdheiIsCiAgInN0YXJ0X3VybCI6ICIuLyIsCiAgImRpc3BsYXkiOiAic3RhbmRhbG9uZSIsCiAgInRoZW1lX2NvbG9yIjogIiMyNTYzZWIiLAogICJiYWNrZ3JvdW5kX2NvbG9yIjogIiNmOWZhZmIiLAogICJpY29ucyI6IFsKICAgIHsKICAgICAgInNyYyI6ICJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUJwWkQwaWFXTnZiaUlnZG1sbGQwSnZlRDBpTUNBd0lESTBJREkwSWlCbWFXeHNQU0pqZFhKeVpXNTBRMjlzYjNJaUlHaGxhV2RvZEQwaU1qUWlJSGRwWkhSb1BTSXlOQ0lnZUcxc2JuTTlJbWgwZEhBNkx5OTNkM2N1ZHpNdWIzSm5Mekl3TURBdmMzWm5JajQ4Y0dGMGFDQmtQU0pOTmpBeU9Ua3lPRFkzSWkxNE1UUTJNallsSWs4M2JDZEpjeTF5ZFhCcmFqVnJibGtyYkdzeFZqSm5aVFV6WVVzeE9UQldjSFZ1Y3lCc01qa3lZeXNqYzNKaU5HSnphMllnWVhZNmN6RmllV1J5YjNOdUlpOCtQSEJoZEdnZ1pEMGlUVEUwTGpVNEwySkpNaUlnZUMxT00yMDJZWGhoY0MxM2MzUXhObWwyWVMxcU9UcENWVzgyZERSdEx6VjVJaTh3SWo0OEwzTjJaejQ9IiwKICAgICAgInNpemVzIjogIjI0eDI0IiwKICAgICAgInR5cGUiOiAiaW1hZ2Uvc3ZnK3htbCIKICAgIH0sCiAgICB7CiAgICAgICJzcmMiOiAiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCcFpEMGlhV052YmlJZ2RtbGxkMEp2ZUQwaU1DQXdJVEkxTmlBeU5UWWlJR1pwYkd3OUltTjFjbkpsYm5SRGIyeHZjaUlnYUdWcFoyaDBQU0l5TlRZaUlIZHBaSFJvUFNJeU5UWWlJSGh0Ykc1elBTSm9kSFJ3T2k4dmQzZDNMbmN6TG05eVp5OHlNREF3TDNOMlp5SStQSEpsWTNRZ2VEMGlOREFpSUhrOUlqUXdJaUIzYVdSMGFEMGlNVGMySWlCb1pXbG5hSFE5SWpFM05pSWdabWxzYkQwaVF6SXdReUl2UGp4MFpYaDBJSGc5SWpVNUlpQjVQU0l4TmpZaVBrVWdRVVJmU1U1VFZFRk1RMEZhUEM5MFpYaDBQand2YzNabklqND0iLAogICAgICAic2l6ZXMiOiAiMjU2eDI1NiIsCiAgICAgICJ0eXBlIjogImltYWdlL3N2Zyt4bWwiCiAgICB9CiAgXQp9">
    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('data:text/javascript;base64,c2VsZi5hZGRFdmVudExpc3RlbmVyKCdpbnN0YWxsJywgZnVuY3Rpb24oZXZlbnQpIHsKICBjb25zb2xlLmxvZygnU2VydmljZSBXb3JrZXIgaW5zdGFsbGVkJyk7Cn0pOwoKc2VsZi5hZGRFdmVudExpc3RlbmVyKCdhY3RpdmF0ZScsIGZ1bmN0aW9uKGV2ZW50KSB7CiAgY29uc29sZS5sb2coJ1NlcnZpY2UgV29ya2VyIGFjdGl2ZScpOwp9KTs=');
            });
        }
    </script>
    
    <style>
        :root {
            --primary-color: #2563eb;
            --secondary-color: #1e40af;
            --success-color: #10b981;
            --danger-color: #ef4444;
            --warning-color: #f59e0b;
            --light-bg: #f9fafb;
            --border-color: #e5e7eb;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--light-bg);
            color: #1f2937;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px 0;
            margin-bottom: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            text-align: center;
            margin-bottom: 10px;
        }

        .header .subtitle {
            text-align: center;
            opacity: 0.9;
        }

        .nav-tabs {
            display: flex;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
            overflow: hidden;
        }

        .nav-tab {
            flex: 1;
            padding: 15px 20px;
            background: white;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            border-bottom: 3px solid transparent;
        }

        .nav-tab:hover {
            background: #f3f4f6;
        }

        .nav-tab.active {
            background: var(--primary-color);
            color: white;
            border-bottom-color: var(--secondary-color);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--border-color);
        }

        .card h3 {
            color: var(--primary-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--light-bg);
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #374151;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
            margin: 5px;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-success:hover {
            background: #059669;
            transform: translateY(-2px);
        }

        .btn-danger {
            background: var(--danger-color);
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
            transform: translateY(-2px);
        }

        .btn-warning {
            background: var(--warning-color);
            color: white;
        }

        .btn-warning:hover {
            background: #d97706;
            transform: translateY(-2px);
        }

        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 20px;
        }

        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        th {
            background: var(--light-bg);
            font-weight: 600;
            color: var(--primary-color);
        }

        tr:hover {
            background: #f9fafb;
        }

        .status {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }

        .status.pending {
            background: #fef3c7;
            color: #92400e;
        }

        .status.in-progress {
            background: #dbeafe;
            color: #1e40af;
        }

        .status.completed {
            background: #d1fae5;
            color: #065f46;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
        }

        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 10px;
            width: 90%;
            max-width: 600px;
            position: relative;
            animation: modalSlideIn 0.3s ease;
        }

        @keyframes modalSlideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .close {
            position: absolute;
            right: 20px;
            top: 20px;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            color: #9ca3af;
        }

        .close:hover {
            color: #374151;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 500;
            z-index: 1001;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.3s ease;
        }

        .notification.show {
            opacity: 1;
            transform: translateX(0);
        }

        .notification.success {
            background: var(--success-color);
        }

        .notification.error {
            background: var(--danger-color);
        }

        .notification.warning {
            background: var(--warning-color);
        }

        .sync-status {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 10px 15px;
            background: white;
            border-radius: 25px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border: 2px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .sync-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--success-color);
            animation: pulse 2s infinite;
        }

        .sync-indicator.syncing {
            background: var(--warning-color);
            animation: spin 1s linear infinite;
        }

        .sync-indicator.error {
            background: var(--danger-color);
            animation: none;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .search-container {
            margin-bottom: 20px;
        }

        .search-input {
            width: 100%;
            max-width: 400px;
            padding: 10px 15px;
            border: 2px solid var(--border-color);
            border-radius: 25px;
            font-size: 14px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .nav-tabs {
                flex-direction: column;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .btn-group {
                flex-direction: column;
            }

            .modal-content {
                width: 95%;
                margin: 10% auto;
                padding: 20px;
            }
        }

        .file-input-wrapper {
            position: relative;
            display: inline-block;
            cursor: pointer;
            width: 100%;
        }

        .file-input-wrapper input[type=file] {
            position: absolute;
            left: -9999px;
        }

        .file-input-label {
            display: flex;
            align-items: center;
            padding: 12px;
            background: var(--light-bg);
            border: 2px dashed var(--border-color);
            border-radius: 8px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .file-input-label:hover {
            border-color: var(--primary-color);
            background: #eff6ff;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: var(--border-color);
            border-radius: 3px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: var(--primary-color);
            width: 0%;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîß AdInstalGaz</h1>
            <p class="subtitle">Sistem de Management pentru Instala»õii de Gaz</p>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('dashboard')">üìä Dashboard</button>
            <button class="nav-tab" onclick="showTab('clients')">üë• Clien»õi</button>
            <button class="nav-tab" onclick="showTab('projects')">üîß LucrƒÉri</button>
            <button class="nav-tab" onclick="showTab('reports')">üìÑ Rapoarte</button>
            <button class="nav-tab" onclick="showTab('settings')">‚öôÔ∏è SetƒÉri</button>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content active">
            <div class="card">
                <h3>üìä Rezumat Activitate</h3>
                <div class="form-row">
                    <div style="text-align: center; padding: 20px; background: linear-gradient(135deg, #10b981, #059669); color: white; border-radius: 10px;">
                        <h2 id="totalClients">0</h2>
                        <p>Clien»õi Activi</p>
                    </div>
                    <div style="text-align: center; padding: 20px; background: linear-gradient(135deg, #3b82f6, #2563eb); color: white; border-radius: 10px;">
                        <h2 id="totalProjects">0</h2>
                        <p>LucrƒÉri √Æn Curs</p>
                    </div>
                    <div style="text-align: center; padding: 20px; background: linear-gradient(135deg, #f59e0b, #d97706); color: white; border-radius: 10px;">
                        <h2 id="totalRevenue">0 RON</h2>
                        <p>Venituri Luna CurentƒÉ</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>üìã LucrƒÉri Recente</h3>
                <div class="table-container">
                    <table id="recentProjectsTable">
                        <thead>
                            <tr>
                                <th>Client</th>
                                <th>Tip Lucrare</th>
                                <th>Status</th>
                                <th>Data</th>
                                <th>Ac»õiuni</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Clients Tab -->
        <div id="clients" class="tab-content">
            <div class="card">
                <h3>üë• Management Clien»õi</h3>
                
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="showAddClientModal()">‚ûï AdaugƒÉ Client</button>
                    <button class="btn btn-success" onclick="importClients()">üì• Import Clien»õi</button>
                    <button class="btn btn-warning" onclick="exportClients()">üì§ Export Clien»õi</button>
                </div>

                <div class="search-container">
                    <input type="text" class="search-input" id="clientSearch" placeholder="üîç CautƒÉ clien»õi..." onkeyup="searchClients()">
                </div>

                <div class="table-container">
                    <table id="clientsTable">
                        <thead>
                            <tr>
                                <th>Nume</th>
                                <th>Telefon</th>
                                <th>Email</th>
                                <th>AdresƒÉ</th>
                                <th>Tip Client</th>
                                <th>Ac»õiuni</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Projects Tab -->
        <div id="projects" class="tab-content">
            <div class="card">
                <h3>üîß Management LucrƒÉri</h3>
                
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="showAddProjectModal()">‚ûï AdaugƒÉ Lucrare</button>
                    <button class="btn btn-success" onclick="generateProjectReport()">üìä GenereazƒÉ Raport</button>
                </div>

                <div class="search-container">
                    <input type="text" class="search-input" id="projectSearch" placeholder="üîç CautƒÉ lucrƒÉri..." onkeyup="searchProjects()">
                </div>

                <div class="table-container">
                    <table id="projectsTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Client</th>
                                <th>Tip Lucrare</th>
                                <th>Status</th>
                                <th>Data √énceput</th>
                                <th>Pre»õ</th>
                                <th>Ac»õiuni</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Reports Tab -->
        <div id="reports" class="tab-content">
            <div class="card">
                <h3>üìÑ Generare Rapoarte</h3>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Tip Raport:</label>
                        <select id="reportType">
                            <option value="monthly">Raport Lunar</option>
                            <option value="quarterly">Raport Trimestrial</option>
                            <option value="yearly">Raport Anual</option>
                            <option value="clients">Raport Clien»õi</option>
                            <option value="projects">Raport LucrƒÉri</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Perioada:</label>
                        <input type="month" id="reportPeriod">
                    </div>
                </div>

                <div class="btn-group">
                    <button class="btn btn-primary" onclick="generatePDFReport()">üìÑ GenereazƒÉ PDF</button>
                    <button class="btn btn-success" onclick="generateExcelReport()">üìä GenereazƒÉ Excel</button>
                    <button class="btn btn-warning" onclick="emailReport()">üìß Trimite Email</button>
                </div>

                <div class="progress-bar" id="reportProgress" style="display: none;">
                    <div class="progress-fill" id="reportProgressFill"></div>
                </div>
            </div>

            <div class="card">
                <h3>üìà Statistici</h3>
                <div id="statisticsContainer">
                    <div class="form-row">
                        <div style="text-align: center; padding: 15px; background: #f3f4f6; border-radius: 8px;">
                            <h3 id="monthlyEarnings">0 RON</h3>
                            <p>Venituri Luna CurentƒÉ</p>
                        </div>
                        <div style="text-align: center; padding: 15px; background: #f3f4f6; border-radius: 8px;">
                            <h3 id="completedProjectsCount">0</h3>
                            <p>LucrƒÉri Finalizate</p>
                        </div>
                        <div style="text-align: center; padding: 15px; background: #f3f4f6; border-radius: 8px;">
                            <h3 id="averageProjectValue">0 RON</h3>
                            <p>Valoare Medie Lucrare</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Tab -->
        <div id="settings" class="tab-content">
            <div class="card">
                <h3>‚öôÔ∏è ConfigurƒÉri Aplica»õie</h3>
                
                <div class="form-group">
                    <label>Numele Companiei:</label>
                    <input type="text" id="companyName" value="AdInstalGaz SRL">
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Email Contact:</label>
                        <input type="email" id="contactEmail" value="office@adinstalgaz.ro">
                    </div>
                    <div class="form-group">
                        <label>Telefon Contact:</label>
                        <input type="tel" id="contactPhone" value="+40 XXX XXX XXX">
                    </div>
                </div>

                <div class="form-group">
                    <label>Adresa Companie:</label>
                    <textarea id="companyAddress" placeholder="Adresa completƒÉ a companiei...">Strada Exemplu Nr. 123, Bucure»ôti, Rom√¢nia</textarea>
                </div>

                <div class="btn-group">
                    <button class="btn btn-primary" onclick="saveSettings()">üíæ SalveazƒÉ SetƒÉri</button>
                    <button class="btn btn-warning" onclick="exportData()">üì§ Export Date</button>
                    <button class="btn btn-danger" onclick="clearData()">üóëÔ∏è »òterge Toate Datele</button>
                </div>
            </div>

            <div class="card">
                <h3>‚òÅÔ∏è Sincronizare</h3>
                <p>Status sincronizare: <span id="syncStatus">Activ</span></p>
                <div class="btn-group">
                    <button class="btn btn-primary" onclick="manualSync()">üîÑ Sincronizare ManualƒÉ</button>
                    <button class="btn btn-success" onclick="backupData()">üíæ Backup Date</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="addClientModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('addClientModal')">&times;</span>
            <h3>‚ûï AdaugƒÉ Client Nou</h3>
            
            <form id="addClientForm">
                <div class="form-row">
                    <div class="form-group">
                        <label>Nume Complet/Companie:</label>
                        <input type="text" id="clientName" required>
                    </div>
                    <div class="form-group">
                        <label>Tip Client:</label>
                        <select id="clientType" required>
                            <option value="">SelecteazƒÉ tipul</option>
                            <option value="fizic">PersoanƒÉ FizicƒÉ</option>
                            <option value="juridic">PersoanƒÉ JuridicƒÉ</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Telefon:</label>
                        <input type="tel" id="clientPhone" required>
                    </div>
                    <div class="form-group">
                        <label>Email:</label>
                        <input type="email" id="clientEmail">
                    </div>
                </div>

                <div class="form-group">
                    <label>AdresƒÉ:</label>
                    <textarea id="clientAddress" required></textarea>
                </div>

                <div class="form-group">
                    <label>Observa»õii:</label>
                    <textarea id="clientNotes"></textarea>
                </div>

                <div class="btn-group">
                    <button type="submit" class="btn btn-primary">üíæ SalveazƒÉ</button>
                    <button type="button" class="btn btn-danger" onclick="closeModal('addClientModal')">‚ùå AnuleazƒÉ</button>
                </div>
            </form>
        </div>
    </div>

    <div id="addProjectModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('addProjectModal')">&times;</span>
            <h3>üîß AdaugƒÉ Lucrare NouƒÉ</h3>
            
            <form id="addProjectForm">
                <div class="form-row">
                    <div class="form-group">
                        <label>Client:</label>
                        <select id="projectClient" required>
                            <option value="">SelecteazƒÉ clientul</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Tip Lucrare:</label>
                        <select id="projectType" required>
                            <option value="">SelecteazƒÉ tipul</option>
                            <option value="instalare">Instalare Gaz</option>
                            <option value="verificare">Verificare Instala»õie</option>
                            <option value="reparatie">Repara»õie</option>
                            <option value="modernizare">Modernizare</option>
                            <option value="deconectare">Deconectare</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Data √énceput:</label>
                        <input type="date" id="projectStartDate" required>
                    </div>
                    <div class="form-group">
                        <label>Data EstimatƒÉ Finalizare:</label>
                        <input type="date" id="projectEndDate">
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Pre»õ (RON):</label>
                        <input type="number" id="projectPrice" required min="0" step="0.01">
                    </div>
                    <div class="form-group">
                        <label>Status:</label>
                        <select id="projectStatus" required>
                            <option value="pending">√én A»ôteptare</option>
                            <option value="in-progress">√én Curs</option>
                            <option value="completed">Finalizat</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label>Descriere Lucrare:</label>
                    <textarea id="projectDescription" required></textarea>
                </div>

                <div class="btn-group">
                    <button type="submit" class="btn btn-primary">üíæ SalveazƒÉ</button>
                    <button type="button" class="btn btn-danger" onclick="closeModal('addProjectModal')">‚ùå AnuleazƒÉ</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Sync Status -->
    <div class="sync-status">
        <div class="sync-indicator" id="syncIndicator"></div>
        <span id="syncText">Sincronizat</span>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <script>
        // Global variables
        let clients = JSON.parse(localStorage.getItem('adinstalgaz_clients') || '[]');
        let projects = JSON.parse(localStorage.getItem('adinstalgaz_projects') || '[]');
        let settings = JSON.parse(localStorage.getItem('adinstalgaz_settings') || '{}');

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            updateDashboard();
            updateClientSelect();
            simulateSync();
            setInterval(autoSync, 30000); // Auto sync every 30 seconds
        });

        // Tab management
        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all nav tabs
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            // Refresh data for current tab
            if (tabName === 'clients') {
                refreshClientsTable();
            } else if (tabName === 'projects') {
                refreshProjectsTable();
            } else if (tabName === 'dashboard') {
                updateDashboard();
            } else if (tabName === 'reports') {
                updateStatistics();
            }
        }

        // Load data from localStorage
        function loadData() {
            refreshClientsTable();
            refreshProjectsTable();
            loadSettings();
        }

        // Save data to localStorage
        function saveData() {
            localStorage.setItem('adinstalgaz_clients', JSON.stringify(clients));
            localStorage.setItem('adinstalgaz_projects', JSON.stringify(projects));
            localStorage.setItem('adinstalgaz_settings', JSON.stringify(settings));
        }

        // Client management
        function showAddClientModal() {
            document.getElementById('addClientModal').style.display = 'block';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // Client form submission
        document.getElementById('addClientForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const client = {
                id: Date.now(),
                name: document.getElementById('clientName').value,
                type: document.getElementById('clientType').value,
                phone: document.getElementById('clientPhone').value,
                email: document.getElementById('clientEmail').value,
                address: document.getElementById('clientAddress').value,
                notes: document.getElementById('clientNotes').value,
                createdAt: new Date().toISOString()
            };
            
            clients.push(client);
            saveData();
            refreshClientsTable();
            updateClientSelect();
            updateDashboard();
            closeModal('addClientModal');
            
            // Reset form
            document.getElementById('addClientForm').reset();
            
            showNotification('Client adƒÉugat cu succes!', 'success');
            triggerSync();
        });

        // Project form submission
        document.getElementById('addProjectForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const project = {
                id: Date.now(),
                clientId: document.getElementById('projectClient').value,
                type: document.getElementById('projectType').value,
                startDate: document.getElementById('projectStartDate').value,
                endDate: document.getElementById('projectEndDate').value,
                price: parseFloat(document.getElementById('projectPrice').value),
                status: document.getElementById('projectStatus').value,
                description: document.getElementById('projectDescription').value,
                createdAt: new Date().toISOString()
            };
            
            projects.push(project);
            saveData();
            refreshProjectsTable();
            updateDashboard();
            closeModal('addProjectModal');
            
            // Reset form
            document.getElementById('addProjectForm').reset();
            
            showNotification('Lucrare adƒÉugatƒÉ cu succes!', 'success');
            triggerSync();
            
            // Send completion email if status is completed
            if (project.status === 'completed') {
                sendCompletionEmail(project);
            }
        });

        // Refresh clients table
        function refreshClientsTable() {
            const tbody = document.querySelector('#clientsTable tbody');
            tbody.innerHTML = '';
            
            clients.forEach(client => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${client.name}</td>
                    <td>${client.phone}</td>
                    <td>${client.email || '-'}</td>
                    <td>${client.address}</td>
                    <td><span class="status ${client.type}">${client.type === 'fizic' ? 'PersoanƒÉ FizicƒÉ' : 'PersoanƒÉ JuridicƒÉ'}</span></td>
                    <td>
                        <button class="btn btn-primary" onclick="editClient(${client.id})">‚úèÔ∏è</button>
                        <button class="btn btn-danger" onclick="deleteClient(${client.id})">üóëÔ∏è</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Refresh projects table
        function refreshProjectsTable() {
            const tbody = document.querySelector('#projectsTable tbody');
            tbody.innerHTML = '';
            
            projects.forEach(project => {
                const client = clients.find(c => c.id == project.clientId);
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>#${project.id}</td>
                    <td>${client ? client.name : 'Client »ôters'}</td>
                    <td>${getProjectTypeText(project.type)}</td>
                    <td><span class="status ${project.status}">${getStatusText(project.status)}</span></td>
                    <td>${formatDate(project.startDate)}</td>
                    <td>${project.price.toFixed(2)} RON</td>
                    <td>
                        <button class="btn btn-primary" onclick="editProject(${project.id})">‚úèÔ∏è</button>
                        <button class="btn btn-danger" onclick="deleteProject(${project.id})">üóëÔ∏è</button>
                        ${project.status === 'completed' ? '<button class="btn btn-success" onclick="sendCompletionEmail(' + JSON.stringify(project).replace(/"/g, '&quot;') + ')">üìß</button>' : ''}
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Update client select in project form
        function updateClientSelect() {
            const select = document.getElementById('projectClient');
            select.innerHTML = '<option value="">SelecteazƒÉ clientul</option>';
            
            clients.forEach(client => {
                const option = document.createElement('option');
                option.value = client.id;
                option.textContent = client.name;
                select.appendChild(option);
            });
        }

        // Update dashboard statistics
        function updateDashboard() {
            document.getElementById('totalClients').textContent = clients.length;
            document.getElementById('totalProjects').textContent = projects.filter(p => p.status === 'in-progress').length;
            
            const currentMonth = new Date().getMonth();
            const currentYear = new Date().getFullYear();
            const monthlyRevenue = projects
                .filter(p => {
                    const projectDate = new Date(p.createdAt);
                    return projectDate.getMonth() === currentMonth && 
                           projectDate.getFullYear() === currentYear &&
                           p.status === 'completed';
                })
                .reduce((sum, p) => sum + p.price, 0);
            
            document.getElementById('totalRevenue').textContent = monthlyRevenue.toFixed(2) + ' RON';
            
            // Update recent projects table
            updateRecentProjectsTable();
        }

        // Update recent projects table
        function updateRecentProjectsTable() {
            const tbody = document.querySelector('#recentProjectsTable tbody');
            tbody.innerHTML = '';
            
            const recentProjects = projects
                .sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt))
                .slice(0, 5);
            
            recentProjects.forEach(project => {
                const client = clients.find(c => c.id == project.clientId);
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${client ? client.name : 'Client »ôters'}</td>
                    <td>${getProjectTypeText(project.type)}</td>
                    <td><span class="status ${project.status}">${getStatusText(project.status)}</span></td>
                    <td>${formatDate(project.startDate)}</td>
                    <td>
                        <button class="btn btn-primary" onclick="editProject(${project.id})">‚úèÔ∏è</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        // Search functions
        function searchClients() {
            const searchTerm = document.getElementById('clientSearch').value.toLowerCase();
            const rows = document.querySelectorAll('#clientsTable tbody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }

        function searchProjects() {
            const searchTerm = document.getElementById('projectSearch').value.toLowerCase();
            const rows = document.querySelectorAll('#projectsTable tbody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }

        // Import/Export functions
        function importClients() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json,.csv,.xlsx';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        let importedData;
                        if (file.name.endsWith('.json')) {
                            importedData = JSON.parse(e.target.result);
                        } else if (file.name.endsWith('.csv')) {
                            importedData = parseCSV(e.target.result);
                        }
                        
                        if (importedData && Array.isArray(importedData)) {
                            importedData.forEach(clientData => {
                                if (clientData.name && clientData.phone) {
                                    const client = {
                                        id: Date.now() + Math.random(),
                                        name: clientData.name,
                                        type: clientData.type || 'fizic',
                                        phone: clientData.phone,
                                        email: clientData.email || '',
                                        address: clientData.address || '',
                                        notes: clientData.notes || '',
                                        createdAt: new Date().toISOString()
                                    };
                                    clients.push(client);
                                }
                            });
                            
                            saveData();
                            refreshClientsTable();
                            updateClientSelect();
                            updateDashboard();
                            showNotification(`${importedData.length} clien»õi importa»õi cu succes!`, 'success');
                            triggerSync();
                        }
                    } catch (error) {
                        showNotification('Eroare la importul fi»ôierului!', 'error');
                    }
                };
                reader.readAsText(file);
            };
            input.click();
        }

        function exportClients() {
            const dataStr = JSON.stringify(clients, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `clienti_adinstalgaz_${new Date().toISOString().split('T')[0]}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
            
            showNotification('Clien»õi exporta»õi cu succes!', 'success');
        }

        // Report generation functions
        function generatePDFReport() {
            showProgress();
            
            setTimeout(() => {
                try {
                    const { jsPDF } = window.jspdf;
                    const doc = new jsPDF();
                    
                    // Add title
                    doc.setFontSize(20);
                    doc.text('Raport AdInstalGaz', 20, 30);
                    
                    // Add date
                    doc.setFontSize(12);
                    doc.text(`Data generarii: ${new Date().toLocaleDateString('ro-RO')}`, 20, 45);
                    
                    // Add statistics
                    doc.text(`Total clienti: ${clients.length}`, 20, 60);
                    doc.text(`Total lucrari: ${projects.length}`, 20, 75);
                    
                    const completedProjects = projects.filter(p => p.status === 'completed');
                    const totalRevenue = completedProjects.reduce((sum, p) => sum + p.price, 0);
                    doc.text(`Venituri totale: ${totalRevenue.toFixed(2)} RON`, 20, 90);
                    
                    // Add projects list
                    doc.text('Lucrari recente:', 20, 110);
                    let yPos = 125;
                    
                    projects.slice(0, 10).forEach((project, index) => {
                        const client = clients.find(c => c.id == project.clientId);
                        const text = `${index + 1}. ${client ? client.name : 'N/A'} - ${getProjectTypeText(project.type)} - ${project.price.toFixed(2)} RON`;
                        doc.text(text, 25, yPos);
                        yPos += 15;
                    });
                    
                    doc.save(`raport_adinstalgaz_${new Date().toISOString().split('T')[0]}.pdf`);
                    hideProgress();
                    showNotification('Raport PDF generat cu succes!', 'success');
                } catch (error) {
                    hideProgress();
                    showNotification('Eroare la generarea raportului PDF!', 'error');
                }
            }, 1000);
        }

        function generateExcelReport() {
            showProgress();
            
            setTimeout(() => {
                try {
                    const wb = XLSX.utils.book_new();
                    
                    // Clients sheet
                    const clientsData = clients.map(client => ({
                        'Nume': client.name,
                        'Tip': client.type === 'fizic' ? 'PersoanƒÉ FizicƒÉ' : 'PersoanƒÉ JuridicƒÉ',
                        'Telefon': client.phone,
                        'Email': client.email,
                        'AdresƒÉ': client.address,
                        'Data CreƒÉrii': formatDate(client.createdAt)
                    }));
                    const clientsWS = XLSX.utils.json_to_sheet(clientsData);
                    XLSX.utils.book_append_sheet(wb, clientsWS, 'Clien»õi');
                    
                    // Projects sheet
                    const projectsData = projects.map(project => {
                        const client = clients.find(c => c.id == project.clientId);
                        return {
                            'ID': project.id,
                            'Client': client ? client.name : 'N/A',
                            'Tip Lucrare': getProjectTypeText(project.type),
                            'Status': getStatusText(project.status),
                            'Data √énceput': formatDate(project.startDate),
                            'Data Sf√¢r»ôit': formatDate(project.endDate),
                            'Pre»õ (RON)': project.price,
                            'Descriere': project.description
                        };
                    });
                    const projectsWS = XLSX.utils.json_to_sheet(projectsData);
                    XLSX.utils.book_append_sheet(wb, projectsWS, 'LucrƒÉri');
                    
                    XLSX.writeFile(wb, `raport_adinstalgaz_${new Date().toISOString().split('T')[0]}.xlsx`);
                    hideProgress();
                    showNotification('Raport Excel generat cu succes!', 'success');
                } catch (error) {
                    hideProgress();
                    showNotification('Eroare la generarea raportului Excel!', 'error');
                }
            }, 1000);
        }

        function emailReport() {
            showProgress();
            
            setTimeout(() => {
                const reportData = {
                    totalClients: clients.length,
                    totalProjects: projects.length,
                    completedProjects: projects.filter(p => p.status === 'completed').length,
                    totalRevenue: projects.filter(p => p.status === 'completed').reduce((sum, p) => sum + p.price, 0)
                };
                
                const emailBody = `
Raport AdInstalGaz - ${new Date().toLocaleDateString('ro-RO')}

Statistici:
- Total clien»õi: ${reportData.totalClients}
- Total lucrƒÉri: ${reportData.totalProjects}
- LucrƒÉri finalizate: ${reportData.completedProjects}
- Venituri totale: ${reportData.totalRevenue.toFixed(2)} RON

Acest raport a fost generat automat de aplica»õia AdInstalGaz.
                `;
                
                const mailtoLink = `mailto:${settings.contactEmail || 'office@adinstalgaz.ro'}?subject=Raport AdInstalGaz - ${new Date().toLocaleDateString('ro-RO')}&body=${encodeURIComponent(emailBody)}`;
                window.open(mailtoLink);
                
                hideProgress();
                showNotification('Email cu raportul pregƒÉtit pentru trimitere!', 'success');
            }, 1000);
        }

        // Send completion email
        function sendCompletionEmail(project) {
            const client = clients.find(c => c.id == project.clientId);
            if (!client) return;
            
            const emailBody = `
Stimate ${client.name},

VƒÉ informƒÉm cƒÉ lucrarea de ${getProjectTypeText(project.type)} a fost finalizatƒÉ cu succes.

Detalii lucrare:
- Tip: ${getProjectTypeText(project.type)}
- Data √Ænceput: ${formatDate(project.startDate)}
- Data finalizare: ${formatDate(new Date())}
- Pre»õ: ${project.price.toFixed(2)} RON

Descriere: ${project.description}

VƒÉ mul»õumim pentru √Æncrederea acordatƒÉ!

Cu stimƒÉ,
${settings.companyName || 'AdInstalGaz SRL'}
${settings.contactPhone || ''}
${settings.contactEmail || ''}
            `;
            
            const mailtoLink = `mailto:${client.email}?subject=Lucrare finalizatƒÉ - ${getProjectTypeText(project.type)}&body=${encodeURIComponent(emailBody)}`;
            window.open(mailtoLink);
            
            showNotification('Email de finalizare pregƒÉtit pentru trimitere!', 'success');
        }

        // Progress bar functions
        function showProgress() {
            const progressBar = document.getElementById('reportProgress');
            const progressFill = document.getElementById('reportProgressFill');
            progressBar.style.display = 'block';
            progressFill.style.width = '0%';
            
            let progress = 0;
            const interval = setInterval(() => {
                progress += 10;
                progressFill.style.width = progress + '%';
                if (progress >= 100) {
                    clearInterval(interval);
                }
            }, 100);
        }

        function hideProgress() {
            setTimeout(() => {
                document.getElementById('reportProgress').style.display = 'none';
            }, 500);
        }

        // Update statistics in reports tab
        function updateStatistics() {
            const currentMonth = new Date().getMonth();
            const currentYear = new Date().getFullYear();
            
            const monthlyProjects = projects.filter(p => {
                const projectDate = new Date(p.createdAt);
                return projectDate.getMonth() === currentMonth && 
                       projectDate.getFullYear() === currentYear &&
                       p.status === 'completed';
            });
            
            const monthlyEarnings = monthlyProjects.reduce((sum, p) => sum + p.price, 0);
            const completedCount = projects.filter(p => p.status === 'completed').length;
            const averageValue = completedCount > 0 ? projects.filter(p => p.status === 'completed').reduce((sum, p) => sum + p.price, 0) / completedCount : 0;
            
            document.getElementById('monthlyEarnings').textContent = monthlyEarnings.toFixed(2) + ' RON';
            document.getElementById('completedProjectsCount').textContent = completedCount;
            document.getElementById('averageProjectValue').textContent = averageValue.toFixed(2) + ' RON';
        }

        // Settings functions
        function loadSettings() {
            if (settings.companyName) document.getElementById('companyName').value = settings.companyName;
            if (settings.contactEmail) document.getElementById('contactEmail').value = settings.contactEmail;
            if (settings.contactPhone) document.getElementById('contactPhone').value = settings.contactPhone;
            if (settings.companyAddress) document.getElementById('companyAddress').value = settings.companyAddress;
        }

        function saveSettings() {
            settings = {
                companyName: document.getElementById('companyName').value,
                contactEmail: document.getElementById('contactEmail').value,
                contactPhone: document.getElementById('contactPhone').value,
                companyAddress: document.getElementById('companyAddress').value
            };
            
            saveData();
            showNotification('SetƒÉri salvate cu succes!', 'success');
            triggerSync();
        }

        function exportData() {
            const allData = {
                clients: clients,
                projects: projects,
                settings: settings,
                exportDate: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(allData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `adinstalgaz_backup_${new Date().toISOString().split('T')[0]}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
            
            showNotification('Date exportate cu succes!', 'success');
        }

        function clearData() {
            if (confirm('Sigur dori»õi sƒÉ »ôterge»õi toate datele? AceastƒÉ ac»õiune nu poate fi anulatƒÉ!')) {
                clients = [];
                projects = [];
                localStorage.removeItem('adinstalgaz_clients');
                localStorage.removeItem('adinstalgaz_projects');
                
                refreshClientsTable();
                refreshProjectsTable();
                updateClientSelect();
                updateDashboard();
                
                showNotification('Toate datele au fost »ôterse!', 'warning');
                triggerSync();
            }
        }

        // Sync functions
        function simulateSync() {
            const syncIndicator = document.getElementById('syncIndicator');
            const syncText = document.getElementById('syncText');
            
            // Simulate successful sync
            syncIndicator.className = 'sync-indicator';
            syncText.textContent = 'Sincronizat';
        }

        function triggerSync() {
            const syncIndicator = document.getElementById('syncIndicator');
            const syncText = document.getElementById('syncText');
            
            syncIndicator.className = 'sync-indicator syncing';
            syncText.textContent = 'Se sincronizeazƒÉ...';
            
            setTimeout(() => {
                syncIndicator.className = 'sync-indicator';
                syncText.textContent = 'Sincronizat';
            }, 2000);
        }

        function manualSync() {
            triggerSync();
            showNotification('Sincronizare manualƒÉ ini»õiatƒÉ!', 'success');
        }

        function autoSync() {
            // Auto sync every 30 seconds
            saveData();
        }

        function backupData() {
            exportData();
            showNotification('Backup realizat cu succes!', 'success');
        }

        // Utility functions
        function getProjectTypeText(type) {
            const types = {
                'instalare': 'Instalare Gaz',
                'verificare': 'Verificare Instala»õie',
                'reparatie': 'Repara»õie',
                'modernizare': 'Modernizare',
                'deconectare': 'Deconectare'
            };
            return types[type] || type;
        }

        function getStatusText(status) {
            const statuses = {
                'pending': '√én A»ôteptare',
                'in-progress': '√én Curs',
                'completed': 'Finalizat'
            };
            return statuses[status] || status;
        }

        function formatDate(dateString) {
            if (!dateString) return '-';
            return new Date(dateString).toLocaleDateString('ro-RO');
        }

        function parseCSV(csvText) {
            const lines = csvText.split('\n');
            const headers = lines[0].split(',').map(h => h.trim());
            const data = [];
            
            for (let i = 1; i < lines.length; i++) {
                if (lines[i].trim()) {
                    const values = lines[i].split(',').map(v => v.trim());
                    const obj = {};
                    headers.forEach((header, index) => {
                        obj[header] = values[index] || '';
                    });
                    data.push(obj);
                }
            }
            
            return data;
        }

        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type} show`;
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        function deleteClient(clientId) {
            if (confirm('Sigur dori»õi sƒÉ »ôterge»õi acest client?')) {
                clients = clients.filter(c => c.id !== clientId);
                saveData();
                refreshClientsTable();
                updateClientSelect();
                updateDashboard();
                showNotification('Client »ôters cu succes!', 'success');
                triggerSync();
            }
        }

        function deleteProject(projectId) {
            if (confirm('Sigur dori»õi sƒÉ »ôterge»õi aceastƒÉ lucrare?')) {
                projects = projects.filter(p => p.id !== projectId);
                saveData();
                refreshProjectsTable();
                updateDashboard();
                showNotification('Lucrare »ôtearsƒÉ cu succes!', 'success');
                triggerSync();
            }
        }

        function editClient(clientId) {
            const client = clients.find(c => c.id === clientId);
            if (client) {
                document.getElementById('clientName').value = client.name;
                document.getElementById('clientType').value = client.type;
                document.getElementById('clientPhone').value = client.phone;
                document.getElementById('clientEmail').value = client.email;
                document.getElementById('clientAddress').value = client.address;
                document.getElementById('clientNotes').value = client.notes;
                
                // Remove old client and add updated one on form submit
                const form = document.getElementById('addClientForm');
                form.onsubmit = function(e) {
                    e.preventDefault();
                    
                    // Update existing client
                    const index = clients.findIndex(c => c.id === clientId);
                    if (index !== -1) {
                        clients[index] = {
                            ...client,
                            name: document.getElementById('clientName').value,
                            type: document.getElementById('clientType').value,
                            phone: document.getElementById('clientPhone').value,
                            email: document.getElementById('clientEmail').value,
                            address: document.getElementById('clientAddress').value,
                            notes: document.getElementById('clientNotes').value
                        };
                        
                        saveData();
                        refreshClientsTable();
                        updateClientSelect();
                        updateDashboard();
                        closeModal('addClientModal');
                        form.reset();
                        
                        // Reset form handler
                        form.onsubmit = function(e) {
                            e.preventDefault();
                            // Original add client logic here
                        };
                        
                        showNotification('Client actualizat cu succes!', 'success');
                        triggerSync();
                    }
                };
                
                showAddClientModal();
            }
        }

        function editProject(projectId) {
            const project = projects.find(p => p.id === projectId);
            if (project) {
                document.getElementById('projectClient').value = project.clientId;
                document.getElementById('projectType').value = project.type;
                document.getElementById('projectStartDate').value = project.startDate;
                document.getElementById('projectEndDate').value = project.endDate;
                document.getElementById('projectPrice').value = project.price;
                document.getElementById('projectStatus').value = project.status;
                document.getElementById('projectDescription').value = project.description;
                
                showAddProjectModal();
                
                // Handle form submission for editing
                const form = document.getElementById('addProjectForm');
                form.onsubmit = function(e) {
                    e.preventDefault();
                    
                    const index = projects.findIndex(p => p.id === projectId);
                    if (index !== -1) {
                        projects[index] = {
                            ...project,
                            clientId: document.getElementById('projectClient').value,
                            type: document.getElementById('projectType').value,
                            startDate: document.getElementById('projectStartDate').value,
                            endDate: document.getElementById('projectEndDate').value,
                            price: parseFloat(document.getElementById('projectPrice').value),
                            status: document.getElementById('projectStatus').value,
                            description: document.getElementById('projectDescription').value
                        };
                        
                        saveData();
                        refreshProjectsTable();
                        updateDashboard();
                        closeModal('addProjectModal');
                        form.reset();
                        
                        showNotification('Lucrare actualizatƒÉ cu succes!', 'success');
                        triggerSync();
                        
                        // Send completion email if status changed to completed
                        if (projects[index].status === 'completed' && project.status !== 'completed') {
                            sendCompletionEmail(projects[index]);
                        }
                    }
                };
            }
        }

        function showAddProjectModal() {
            updateClientSelect();
            document.getElementById('addProjectModal').style.display = 'block';
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        }

        // Set default date for project period
        document.getElementById('reportPeriod').value = new Date().toISOString().substring(0, 7);
    </script>
</body>
</html>
