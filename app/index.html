<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ad Instal Gaz SRL - Management</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1e40af">
    <!-- Removed icon links that cause 404 errors -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, addDoc, getDocs, updateDoc, deleteDoc, doc, onSnapshot } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        
        // Firebase configuration - CONFIGURAÈšIA TA REALÄ‚
        const firebaseConfig = {
            apiKey: "AIzaSyD9yoIQ__cK0zIPlvSRlu1h7O1MtmrfLXA",
            authDomain: "adinstalgaz-pwa.firebaseapp.com",
            projectId: "adinstalgaz-pwa",
            storageBucket: "adinstalgaz-pwa.firebasestorage.app",
            messagingSenderId: "623851795901",
            appId: "1:623851795901:web:63072fdef30693f4698ed4"
        };
        
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        window.db = getFirestore(app);
        window.firestore = { collection, addDoc, getDocs, updateDoc, deleteDoc, doc, onSnapshot };
        
        console.log('ğŸ”¥ Firebase initialized successfully!');
    </script>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Biblioteci pentru rapoarte -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <style>
        .tab-button.active {
            background-color: #1e40af;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(30, 64, 175, 0.3);
        }
        .tab-button {
            transition: all 0.3s ease;
            border-radius: 8px 8px 0 0;
            position: relative;
        }
        .tab-button:hover {
            background-color: #f3f4f6;
            transform: translateY(-1px);
        }
        .tab-button.active:hover {
            background-color: #1e40af;
        }
        .notification-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #ef4444;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .floating-add {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
        .logo-placeholder {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #1e40af, #3b82f6);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 18px;
        }
        /* Responsive navigation */
        @media (min-width: 768px) {
            .nav-container {
                display: grid;
                grid-template-columns: repeat(7, 1fr);
                gap: 0;
            }
            .tab-button {
                margin: 0;
                border-radius: 8px 8px 0 0;
                min-height: 60px;
                display: flex;
                align-items: center;
                justify-content: center;
                flex-direction: column;
                padding: 12px 8px;
            }
            .tab-text {
                font-size: 14px;
                margin-top: 4px;
            }
            .tab-icon {
                font-size: 20px;
            }
        }
        @media (max-width: 767px) {
            .tab-button {
                min-width: 120px;
                flex-shrink: 0;
            }
        }
        /* Sync status indicator */
        .sync-status {
            position: fixed;
            top: 80px;
            right: 20px;
            z-index: 1000;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 12px;
            transition: all 0.3s ease;
        }
        .sync-online {
            background: #10b981;
            color: white;
        }
        .sync-offline {
            background: #ef4444;
            color: white;
        }
        .sync-syncing {
            background: #f59e0b;
            color: white;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- Header -->
    <header class="bg-blue-600 text-white p-4 shadow-lg">
        <div class="max-w-4xl mx-auto flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <!-- Logo CSS (nu mai cautÄƒ fiÈ™ier PNG) -->
                <div class="logo-placeholder">AG</div>
                <div>
                    <h1 class="text-xl font-bold">Ad Instal Gaz SRL</h1>
                    <p class="text-sm opacity-75">Gavrila - ğŸ“ 0762614402</p>
                </div>
            </div>
            <button id="notifications-btn" class="relative p-2 bg-blue-700 rounded-lg hover:bg-blue-800 transition duration-300">
                ğŸ””
                <span id="notification-count" class="notification-badge hidden">0</span>
            </button>
        </div>
    </header>

    <!-- Navigation Tabs -->
    <nav class="bg-white shadow-md sticky top-0 z-50">
        <div class="max-w-6xl mx-auto">
            <div class="nav-container flex overflow-x-auto md:overflow-hidden">
                <button class="tab-button flex-1 p-4 text-center font-medium transition duration-300 hover:bg-gray-100 active" data-tab="dashboard">
                    <span class="tab-icon">ğŸ“Š</span>
                    <span class="tab-text block">Dashboard</span>
                </button>
                <button class="tab-button flex-1 p-4 text-center font-medium transition duration-300 hover:bg-gray-100" data-tab="clients">
                    <span class="tab-icon">ğŸ‘¥</span>
                    <span class="tab-text block">ClienÈ›i</span>
                </button>
                <button class="tab-button flex-1 p-4 text-center font-medium transition duration-300 hover:bg-gray-100" data-tab="appointments">
                    <span class="tab-icon">ğŸ“…</span>
                    <span class="tab-text block">ProgramÄƒri</span>
                </button>
                <button class="tab-button flex-1 p-4 text-center font-medium transition duration-300 hover:bg-gray-100" data-tab="reminders">
                    <span class="tab-icon">â°</span>
                    <span class="tab-text block">Reminder-uri</span>
                </button>
                <button class="tab-button flex-1 p-4 text-center font-medium transition duration-300 hover:bg-gray-100" data-tab="reports">
                    <span class="tab-icon">ğŸ“Š</span>
                    <span class="tab-text block">Rapoarte</span>
                </button>
                <button class="tab-button flex-1 p-4 text-center font-medium transition duration-300 hover:bg-gray-100" data-tab="documents">
                    <span class="tab-icon">ğŸ“„</span>
                    <span class="tab-text block">Documente</span>
                </button>
                <button class="tab-button flex-1 p-4 text-center font-medium transition duration-300 hover:bg-gray-100" data-tab="settings">
                    <span class="tab-icon">âš™ï¸</span>
                    <span class="tab-text block">SetÄƒri</span>
                </button>
            </div>
        </div>
    </nav>

    <!-- Sync Status Indicator -->
    <div id="sync-status" class="sync-status sync-offline hidden">
        <span id="sync-text">ğŸ”„ Sincronizare...</span>
    </div>

    <!-- Main Content -->
    <main class="max-w-4xl mx-auto p-4">
        <!-- Dashboard Section -->
        <section id="dashboard-section" class="tab-content">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
                <!-- Quick Stats -->
                <div class="bg-white p-6 rounded-lg shadow-md border-l-4 border-blue-500">
                    <h3 class="text-lg font-semibold text-gray-800 mb-2">ğŸ‘¥ Total ClienÈ›i</h3>
                    <p id="total-clients" class="text-3xl font-bold text-blue-600">0</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md border-l-4 border-green-500">
                    <h3 class="text-lg font-semibold text-gray-800 mb-2">ğŸ“… ProgramÄƒri AstÄƒzi</h3>
                    <p id="today-appointments" class="text-3xl font-bold text-green-600">0</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-md border-l-4 border-orange-500">
                    <h3 class="text-lg font-semibold text-gray-800 mb-2">â° Reminder-uri Active</h3>
                    <p id="active-reminders" class="text-3xl font-bold text-orange-600">0</p>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="bg-white p-6 rounded-lg shadow-md mb-8">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">ğŸš€ AcÈ›iuni Rapide</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                    <button class="quick-action bg-blue-500 hover:bg-blue-600 text-white p-4 rounded-lg transition duration-300" data-action="add-client">
                        ğŸ‘¤ AdaugÄƒ Client Nou
                    </button>
                    <button class="quick-action bg-green-500 hover:bg-green-600 text-white p-4 rounded-lg transition duration-300" data-action="add-appointment">
                        ğŸ“… ProgrameazÄƒ ÃntÃ¢lnire
                    </button>
                    <button class="quick-action bg-orange-500 hover:bg-orange-600 text-white p-4 rounded-lg transition duration-300" data-action="add-reminder">
                        â° SeteazÄƒ Reminder
                    </button>
                    <button class="quick-action bg-purple-500 hover:bg-purple-600 text-white p-4 rounded-lg transition duration-300" data-action="generate-report">
                        ğŸ“Š GenereazÄƒ Raport
                    </button>
                </div>
            </div>

            <!-- Today's Schedule -->
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">ğŸ“‹ Programul de AstÄƒzi</h3>
                <div id="today-schedule" class="space-y-3">
                    <p class="text-gray-500 text-center py-8">Nu ai programÄƒri pentru astÄƒzi</p>
                </div>
            </div>
        </section>

        <!-- Clients Section -->
        <section id="clients-section" class="tab-content hidden">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-blue-600">ğŸ‘¥ ClienÈ›i</h2>
                <div class="flex space-x-2">
                    <button id="export-clients-btn" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300">
                        ğŸ“¤ Export Excel
                    </button>
                    <button id="add-client-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300">
                        â• AdaugÄƒ Client
                    </button>
                </div>
            </div>
            
            <!-- Search -->
            <div class="mb-6">
                <input type="text" id="client-search" placeholder="ğŸ” CautÄƒ clienÈ›i..." class="w-full p-3 border border-gray-300 rounded-lg">
            </div>
            
            <!-- Clients List -->
            <div id="clients-list" class="space-y-4">
                <!-- Clients will be dynamically loaded here -->
            </div>
        </section>

        <!-- Appointments Section -->
        <section id="appointments-section" class="tab-content hidden">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-blue-600">ğŸ“… ProgramÄƒri</h2>
                <div class="flex space-x-2">
                    <button id="export-appointments-btn" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300">
                        ğŸ“¤ Export Excel
                    </button>
                    <button id="add-appointment-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300">
                        â• AdaugÄƒ Programare
                    </button>
                </div>
            </div>
            
            <!-- Calendar Filter -->
            <div class="bg-white p-4 rounded-lg shadow-md mb-6">
                <div class="flex flex-wrap gap-4">
                    <input type="date" id="appointment-date-filter" class="p-2 border border-gray-300 rounded-lg">
                    <select id="appointment-status-filter" class="p-2 border border-gray-300 rounded-lg">
                        <option value="">Toate statusurile</option>
                        <option value="programat">Programat</option>
                        <option value="confirmat">Confirmat</option>
                        <option value="finalizat">Finalizat</option>
                        <option value="anulat">Anulat</option>
                    </select>
                </div>
            </div>
            
            <!-- Appointments List -->
            <div id="appointments-list" class="space-y-4">
                <!-- Appointments will be dynamically loaded here -->
            </div>
        </section>

        <!-- Reminders Section -->
        <section id="reminders-section" class="tab-content hidden">
            <!-- Will be populated by JavaScript -->
        </section>

        <!-- Reports Section -->
        <section id="reports-section" class="tab-content hidden">
            <h2 class="text-2xl font-bold text-blue-600 mb-6">ğŸ“Š Rapoarte</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                <!-- Rapoarte ClienÈ›i -->
                <div class="bg-white p-6 rounded-lg shadow-md border-l-4 border-blue-400">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">ğŸ‘¥ Rapoarte ClienÈ›i</h3>
                    <div class="space-y-3">
                        <button onclick="exportClientsExcel()" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                            ğŸ“Š Export ClienÈ›i Excel
                        </button>
                        <button onclick="exportClientsPDF()" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                            ğŸ“„ Export ClienÈ›i PDF
                        </button>
                    </div>
                </div>
                
                <!-- Rapoarte ProgramÄƒri -->
                <div class="bg-white p-6 rounded-lg shadow-md border-l-4 border-green-400">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">ğŸ“… Rapoarte ProgramÄƒri</h3>
                    <div class="space-y-3">
                        <button onclick="exportAppointmentsExcel()" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                            ğŸ“Š Export ProgramÄƒri Excel
                        </button>
                        <button onclick="exportAppointmentsPDF()" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                            ğŸ“„ Export ProgramÄƒri PDF
                        </button>
                    </div>
                </div>
                
                <!-- Raport Complet -->
                <div class="bg-white p-6 rounded-lg shadow-md border-l-4 border-purple-400 md:col-span-2">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">ğŸ“‹ Raport Complet</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                        <button onclick="exportFullReportExcel()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                            ğŸ“Š Raport Complet Excel
                        </button>
                        <button onclick="exportFullReportPDF()" class="bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                            ğŸ“„ Raport Complet PDF
                        </button>
                        <button onclick="exportMonthlyReport()" class="bg-orange-600 hover:bg-orange-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                            ğŸ“… Raport Lunar
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Statistici -->
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">ğŸ“ˆ Statistici</h3>
                <div id="statistics-content" class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <!-- Statisticile vor fi generate dinamic -->
                </div>
            </div>
        </section>

        <!-- Documents Section -->
        <section id="documents-section" class="tab-content hidden">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-blue-600">ğŸ“„ Documente</h2>
                <button id="scan-document-btn" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300">
                    ğŸ“· ScaneazÄƒ Document
                </button>
            </div>
            
            <!-- Upload Area -->
            <div class="bg-white p-6 rounded-lg shadow-md mb-6 border-2 border-dashed border-gray-300">
                <div class="text-center">
                    <input type="file" id="document-upload" multiple accept="image/*,.pdf,.doc,.docx" class="hidden">
                    <label for="document-upload" class="cursor-pointer">
                        <div class="p-8">
                            <div class="text-4xl mb-4">ğŸ“</div>
                            <p class="text-lg font-semibold text-gray-700 mb-2">ÃncarcÄƒ Documente</p>
                            <p class="text-gray-500">Click pentru a selecta fiÈ™iere sau fotografii</p>
                        </div>
                    </label>
                </div>
            </div>
            
            <!-- Camera Section -->
            <div id="camera-section" class="bg-white p-6 rounded-lg shadow-md mb-6 hidden">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">ğŸ“· CamerÄƒ Document</h3>
                <video id="camera-video" class="w-full max-w-md mx-auto rounded-lg mb-4" autoplay playsinline></video>
                <div class="text-center space-x-4">
                    <button id="capture-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300">
                        ğŸ“¸ CaptureazÄƒ
                    </button>
                    <button id="close-camera-btn" class="bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300">
                        âŒ Ãnchide
                    </button>
                </div>
            </div>
            
            <!-- Documents List -->
            <div id="documents-list" class="space-y-4">
                <!-- Documents will be dynamically loaded here -->
            </div>
        </section>

        <!-- Settings Section -->
        <section id="settings-section" class="tab-content hidden">
            <h2 class="text-2xl font-bold text-blue-600 mb-6">âš™ï¸ SetÄƒri</h2>
            
            <div class="space-y-6">
                <!-- Business Info -->
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">ğŸ¢ InformaÈ›ii FirmÄƒ</h3>
                    <form id="business-form">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <input type="text" id="business-name" placeholder="Nume FirmÄƒ" class="p-3 border border-gray-300 rounded-lg" value="Ad Instal Gaz SRL">
                            <input type="tel" id="business-phone" placeholder="Telefon FirmÄƒ" class="p-3 border border-gray-300 rounded-lg" value="0762614402">
                            <input type="email" id="business-email" placeholder="Email FirmÄƒ" class="p-3 border border-gray-300 rounded-lg" value="gavrila_1971@yahoo.com">
                            <input type="text" id="business-address" placeholder="AdresÄƒ FirmÄƒ" class="p-3 border border-gray-300 rounded-lg" value="Str. MÄƒrÄƒÈ™eÈ™ti, Nr.97">
                            <input type="text" id="business-owner" placeholder="Proprietar" class="p-3 border border-gray-300 rounded-lg" value="Gavrila">
                            <input type="text" id="business-cui" placeholder="CUI (opÈ›ional)" class="p-3 border border-gray-300 rounded-lg">
                        </div>
                        <button type="submit" class="mt-4 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition duration-300">
                            ğŸ’¾ SalveazÄƒ
                        </button>
                    </form>
                </div>
                
                <!-- Data Management -->
                <div class="bg-white p-6 rounded-lg shadow-md">
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">ğŸ’¾ Management Date</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <button id="export-data-btn" class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                            ğŸ“¤ ExportÄƒ Toate Datele
                        </button>
                        <button id="import-data-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                            ğŸ“¥ ImportÄƒ Date
                        </button>
                        <input type="file" id="import-file" accept=".json" class="hidden">
                        <button id="clear-data-btn" class="bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                            ğŸ—‘ï¸ È˜terge Toate Datele
                        </button>
                        <button onclick="exportBackupExcel()" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                            ğŸ’¾ Backup Excel Complet
                        </button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Floating Add Button -->
    <button id="floating-add" class="floating-add bg-blue-600 hover:bg-blue-700 text-white rounded-full w-14 h-14 flex items-center justify-center shadow-lg transition duration-300 text-2xl">
        â•
    </button>

    <!-- Modal Overlay -->
    <div id="modal-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div id="modal-content" class="fixed inset-4 bg-white rounded-lg p-6 overflow-y-auto">
            <!-- Modal content will be inserted here -->
        </div>
    </div>

    <script>
        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js')
                .then(registration => {
                    console.log('âœ… Service Worker registered successfully:', registration);
                })
                .catch(error => {
                    console.log('âŒ Service Worker registration failed:', error);
                });
        }

        // Global variables
        let clients = JSON.parse(localStorage.getItem('clients') || '[]');
        let appointments = JSON.parse(localStorage.getItem('appointments') || '[]');
        let reminders = JSON.parse(localStorage.getItem('reminders') || '[]');
        let documents = JSON.parse(localStorage.getItem('documents') || '[]');
        let businessInfo = JSON.parse(localStorage.getItem('businessInfo') || '{}');
        let isOnline = navigator.onLine;
        let syncQueue = JSON.parse(localStorage.getItem('syncQueue') || '[]');

        // Firebase sync functions
        async function syncToFirebase() {
            if (!isOnline || !window.db) return;
            
            updateSyncStatus('syncing', 'ğŸ”„ Sincronizare...');
            
            try {
                // Sync clients
                const clientsRef = window.firestore.collection(window.db, 'clients');
                for (const client of clients) {
                    if (!client.synced) {
                        await window.firestore.addDoc(clientsRef, {
                            ...client,
                            synced: true,
                            updatedAt: new Date()
                        });
                        client.synced = true;
                    }
                }
                
                // Sync appointments  
                const appointmentsRef = window.firestore.collection(window.db, 'appointments');
                for (const appointment of appointments) {
                    if (!appointment.synced) {
                        await window.firestore.addDoc(appointmentsRef, {
                            ...appointment,
                            synced: true,
                            updatedAt: new Date()
                        });
                        appointment.synced = true;
                    }
                }
                
                // Sync reminders
                const remindersRef = window.firestore.collection(window.db, 'reminders');
                for (const reminder of reminders) {
                    if (!reminder.synced) {
                        await window.firestore.addDoc(remindersRef, {
                            ...reminder,
                            synced: true,
                            updatedAt: new Date()
                        });
                        reminder.synced = true;
                    }
                }
                
                // Update local storage
                localStorage.setItem('clients', JSON.stringify(clients));
                localStorage.setItem('appointments', JSON.stringify(appointments));
                localStorage.setItem('reminders', JSON.stringify(reminders));
                
                updateSyncStatus('online', 'âœ… Sincronizat');
                setTimeout(() => {
                    document.getElementById('sync-status').classList.add('hidden');
                }, 2000);
                
            } catch (error) {
                console.error('Sync error:', error);
                updateSyncStatus('offline', 'âŒ Eroare sync');
            }
        }

        async function syncFromFirebase() {
            if (!isOnline || !window.db) return;
            
            try {
                // Get clients from Firebase
                const clientsSnapshot = await window.firestore.getDocs(window.firestore.collection(window.db, 'clients'));
                const firebaseClients = [];
                clientsSnapshot.forEach((doc) => {
                    firebaseClients.push({ firebaseId: doc.id, ...doc.data() });
                });
                
                // Get appointments from Firebase
                const appointmentsSnapshot = await window.firestore.getDocs(window.firestore.collection(window.db, 'appointments'));
                const firebaseAppointments = [];
                appointmentsSnapshot.forEach((doc) => {
                    firebaseAppointments.push({ firebaseId: doc.id, ...doc.data() });
                });
                
                // Get reminders from Firebase
                const remindersSnapshot = await window.firestore.getDocs(window.firestore.collection(window.db, 'reminders'));
                const firebaseReminders = [];
                remindersSnapshot.forEach((doc) => {
                    firebaseReminders.push({ firebaseId: doc.id, ...doc.data() });
                });
                
                // Merge with local data (avoid duplicates)
                const mergedClients = mergeData(clients, firebaseClients);
                const mergedAppointments = mergeData(appointments, firebaseAppointments);
                const mergedReminders = mergeData(reminders, firebaseReminders);
                
                // Update local storage
                clients = mergedClients;
                appointments = mergedAppointments;
                reminders = mergedReminders;
                
                localStorage.setItem('clients', JSON.stringify(clients));
                localStorage.setItem('appointments', JSON.stringify(appointments));
                localStorage.setItem('reminders', JSON.stringify(reminders));
                
                // Reload current view
                loadDashboard();
                
            } catch (error) {
                console.error('Sync from Firebase error:', error);
            }
        }

        function mergeData(localData, firebaseData) {
            const merged = [...localData];
            
            firebaseData.forEach(firebaseItem => {
                const existsInLocal = merged.find(localItem => 
                    localItem.id === firebaseItem.id || 
                    localItem.firebaseId === firebaseItem.firebaseId
                );
                
                if (!existsInLocal) {
                    merged.push(firebaseItem);
                }
            });
            
            return merged;
        }

        function updateSyncStatus(status, text) {
            const syncStatus = document.getElementById('sync-status');
            const syncText = document.getElementById('sync-text');
            
            syncStatus.className = `sync-status sync-${status}`;
            syncText.textContent = text;
            syncStatus.classList.remove('hidden');
        }

        // Network status monitoring
        window.addEventListener('online', () => {
            isOnline = true;
            updateSyncStatus('online', 'ğŸŒ Online');
            syncToFirebase();
            syncFromFirebase();
        });

        window.addEventListener('offline', () => {
            isOnline = false;
            updateSyncStatus('offline', 'ğŸ“¡ Offline');
        });

        // Initialize business info with default values
        if (!businessInfo.name) {
            businessInfo = {
                name: 'Ad Instal Gaz SRL',
                phone: '0762614402',
                email: 'gavrila_1971@yahoo.com',
                address: 'Str. MÄƒrÄƒÈ™eÈ™ti, Nr.97',
                owner: 'Gavrila',
                cui: ''
            };
            localStorage.setItem('businessInfo', JSON.stringify(businessInfo));
        }

        // Tab switching
        document.querySelectorAll('.tab-button').forEach(button => {
            button.addEventListener('click', () => {
                const tabName = button.getAttribute('data-tab');
                switchTab(tabName);
            });
        });

        function switchTab(tabName) {
            // Update active tab button
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

            // Hide all sections
            document.querySelectorAll('.tab-content').forEach(section => section.classList.add('hidden'));
            
            // Show selected section
            document.getElementById(`${tabName}-section`).classList.remove('hidden');

            // Load section-specific content
            if (tabName === 'clients') loadClients();
            if (tabName === 'appointments') loadAppointments();
            if (tabName === 'reminders') loadReminders();
            if (tabName === 'documents') loadDocuments();
            if (tabName === 'dashboard') loadDashboard();
            if (tabName === 'reports') loadReports();
        }

        // Initialize app
        function initApp() {
            loadDashboard();
            setupEventListeners();
            checkNotifications();
            loadBusinessInfo();
            
            // Initialize sync status
            updateSyncStatus(isOnline ? 'online' : 'offline', isOnline ? 'ğŸŒ Online' : 'ğŸ“¡ Offline');
            
            // Sync data if online
            if (isOnline && window.db) {
                setTimeout(() => {
                    syncFromFirebase().then(() => {
                        syncToFirebase();
                    });
                }, 1000);
            }
        }

        function loadBusinessInfo() {
            if (businessInfo.name) {
                document.getElementById('business-name').value = businessInfo.name || 'Ad Instal Gaz SRL';
                document.getElementById('business-phone').value = businessInfo.phone || '0762614402';
                document.getElementById('business-email').value = businessInfo.email || 'gavrila_1971@yahoo.com';
                document.getElementById('business-address').value = businessInfo.address || 'Str. MÄƒrÄƒÈ™eÈ™ti, Nr.97';
                document.getElementById('business-owner').value = businessInfo.owner || 'Gavrila';
                document.getElementById('business-cui').value = businessInfo.cui || '';
            }
        }

        function loadDashboard() {
            document.getElementById('total-clients').textContent = clients.length;
            
            const today = new Date().toISOString().split('T')[0];
            const todayAppointments = appointments.filter(apt => apt.date === today);
            document.getElementById('today-appointments').textContent = todayAppointments.length;
            
            const activeReminders = reminders.filter(rem => new Date(rem.date) >= new Date());
            document.getElementById('active-reminders').textContent = activeReminders.length;
            
            // Load today's schedule
            const scheduleContainer = document.getElementById('today-schedule');
            if (todayAppointments.length === 0) {
                scheduleContainer.innerHTML = '<p class="text-gray-500 text-center py-8">Nu ai programÄƒri pentru astÄƒzi</p>';
            } else {
                scheduleContainer.innerHTML = todayAppointments.map(apt => `
                    <div class="bg-blue-50 p-4 rounded-lg border-l-4 border-blue-400">
                        <div class="flex justify-between items-center">
                            <div>
                                <h4 class="font-semibold">${apt.clientName}</h4>
                                <p class="text-sm text-gray-600">${apt.time} - ${apt.service}</p>
                                <p class="text-sm text-gray-500">${apt.address}</p>
                            </div>
                            <span class="text-xs px-2 py-1 rounded-full bg-blue-100 text-blue-800">${apt.status}</span>
                        </div>
                    </div>
                `).join('');
            }
        }

        function setupEventListeners() {
            // Quick actions
            document.querySelectorAll('.quick-action').forEach(button => {
                button.addEventListener('click', () => {
                    const action = button.getAttribute('data-action');
                    switch(action) {
                        case 'add-client':
                            showAddClientModal();
                            break;
                        case 'add-appointment':
                            showAddAppointmentModal();
                            break;
                        case 'add-reminder':
                            showAddReminderModal();
                            break;
                        case 'generate-report':
                            switchTab('reports');
                            break;
                    }
                });
            });

            // Main action buttons
            document.getElementById('add-client-btn').addEventListener('click', showAddClientModal);
            document.getElementById('add-appointment-btn').addEventListener('click', showAddAppointmentModal);
            document.getElementById('scan-document-btn').addEventListener('click', startCamera);
            document.getElementById('floating-add').addEventListener('click', showQuickActionsMenu);

            // Export buttons
            document.getElementById('export-clients-btn').addEventListener('click', exportClientsExcel);
            document.getElementById('export-appointments-btn').addEventListener('click', exportAppointmentsExcel);

            // Modal close
            document.getElementById('modal-overlay').addEventListener('click', (e) => {
                if (e.target === document.getElementById('modal-overlay')) {
                    closeModal();
                }
            });

            // Search functionality
            document.getElementById('client-search').addEventListener('input', filterClients);

            // Camera controls
            document.getElementById('capture-btn').addEventListener('click', captureDocument);
            document.getElementById('close-camera-btn').addEventListener('click', stopCamera);

            // Settings
            document.getElementById('business-form').addEventListener('submit', saveBusinessInfo);
            document.getElementById('export-data-btn').addEventListener('click', exportData);
            document.getElementById('import-data-btn').addEventListener('click', () => {
                document.getElementById('import-file').click();
            });
            document.getElementById('import-file').addEventListener('change', importData);
            document.getElementById('clear-data-btn').addEventListener('click', clearAllData);
        }

        // Export Functions
        function exportClientsExcel() {
            if (clients.length === 0) {
                showNotification('Nu ai clienÈ›i de exportat!', 'error');
                return;
            }

            const ws = XLSX.utils.json_to_sheet(clients.map(client => ({
                'Nume': client.name,
                'Telefon': client.phone,
                'Email': client.email || '',
                'AdresÄƒ': client.address,
                'NotiÈ›e': client.notes || '',
                'Data AdÄƒugÄƒrii': new Date(client.createdAt).toLocaleDateString('ro-RO')
            })));

            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'ClienÈ›i');
            
            const fileName = `Clienti_AdInstalGaz_${new Date().toISOString().slice(0, 10)}.xlsx`;
            XLSX.writeFile(wb, fileName);
            
            showNotification('Lista clienÈ›ilor a fost exportatÄƒ!', 'success');
        }

        function exportAppointmentsExcel() {
            if (appointments.length === 0) {
                showNotification('Nu ai programÄƒri de exportat!', 'error');
                return;
            }

            const ws = XLSX.utils.json_to_sheet(appointments.map(apt => ({
                'Client': apt.clientName,
                'Telefon': apt.clientPhone,
                'Data': apt.date,
                'Ora': apt.time,
                'Serviciu': apt.service,
                'AdresÄƒ': apt.address,
                'Status': apt.status,
                'NotiÈ›e': apt.notes || '',
                'Data ProgramÄƒrii': new Date(apt.createdAt).toLocaleDateString('ro-RO')
            })));

            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'ProgramÄƒri');
            
            const fileName = `Programari_AdInstalGaz_${new Date().toISOString().slice(0, 10)}.xlsx`;
            XLSX.writeFile(wb, fileName);
            
            showNotification('Lista programÄƒrilor a fost exportatÄƒ!', 'success');
        }

        function exportClientsPDF() {
            if (clients.length === 0) {
                showNotification('Nu ai clienÈ›i de exportat!', 'error');
                return;
            }

            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Header
            doc.setFontSize(16);
            doc.text('Lista ClienÈ›ilor - Ad Instal Gaz SRL', 20, 20);
            doc.setFontSize(12);
            doc.text(`Generat pe: ${new Date().toLocaleDateString('ro-RO')}`, 20, 30);
            doc.text(`Contact: ${businessInfo.phone} | ${businessInfo.email}`, 20, 40);
            
            // Table
            const tableData = clients.map(client => [
                client.name,
                client.phone,
                client.email || '',
                client.address,
                new Date(client.createdAt).toLocaleDateString('ro-RO')
            ]);
            
            doc.autoTable({
                head: [['Nume', 'Telefon', 'Email', 'AdresÄƒ', 'Data AdÄƒugÄƒrii']],
                body: tableData,
                startY: 50,
                styles: { fontSize: 8 },
                headStyles: { fillColor: [30, 64, 175] }
            });
            
            doc.save(`Clienti_AdInstalGaz_${new Date().toISOString().slice(0, 10)}.pdf`);
            showNotification('Raportul PDF a fost generat!', 'success');
        }

        function exportAppointmentsPDF() {
            if (appointments.length === 0) {
                showNotification('Nu ai programÄƒri de exportat!', 'error');
                return;
            }

            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // Header
            doc.setFontSize(16);
            doc.text('Lista ProgramÄƒrilor - Ad Instal Gaz SRL', 20, 20);
            doc.setFontSize(12);
            doc.text(`Generat pe: ${new Date().toLocaleDateString('ro-RO')}`, 20, 30);
            doc.text(`Contact: ${businessInfo.phone} | ${businessInfo.email}`, 20, 40);
            
            // Table
            const tableData = appointments.map(apt => [
                apt.clientName,
                apt.clientPhone,
                apt.date,
                apt.time,
                apt.service,
                apt.status
            ]);
            
            doc.autoTable({
                head: [['Client', 'Telefon', 'Data', 'Ora', 'Serviciu', 'Status']],
                body: tableData,
                startY: 50,
                styles: { fontSize: 8 },
                headStyles: { fillColor: [30, 64, 175] }
            });
            
            doc.save(`Programari_AdInstalGaz_${new Date().toISOString().slice(0, 10)}.pdf`);
            showNotification('Raportul PDF a fost generat!', 'success');
        }

        function exportFullReportExcel() {
            const wb = XLSX.utils.book_new();
            
            // ClienÈ›i
            if (clients.length > 0) {
                const clientsWS = XLSX.utils.json_to_sheet(clients.map(client => ({
                    'Nume': client.name,
                    'Telefon': client.phone,
                    'Email': client.email || '',
                    'AdresÄƒ': client.address,
                    'NotiÈ›e': client.notes || '',
                    'Data AdÄƒugÄƒrii': new Date(client.createdAt).toLocaleDateString('ro-RO')
                })));
                XLSX.utils.book_append_sheet(wb, clientsWS, 'ClienÈ›i');
            }
            
            // ProgramÄƒri
            if (appointments.length > 0) {
                const appointmentsWS = XLSX.utils.json_to_sheet(appointments.map(apt => ({
                    'Client': apt.clientName,
                    'Telefon': apt.clientPhone,
                    'Data': apt.date,
                    'Ora': apt.time,
                    'Serviciu': apt.service,
                    'AdresÄƒ': apt.address,
                    'Status': apt.status,
                    'NotiÈ›e': apt.notes || '',
                    'Data ProgramÄƒrii': new Date(apt.createdAt).toLocaleDateString('ro-RO')
                })));
                XLSX.utils.book_append_sheet(wb, appointmentsWS, 'ProgramÄƒri');
            }
            
            // Reminder-uri
            if (reminders.length > 0) {
                const remindersWS = XLSX.utils.json_to_sheet(reminders.map(rem => ({
                    'Client': rem.clientName,
                    'Telefon': rem.phone,
                    'Data Reminder': rem.date,
                    'Mesaj': rem.message || '',
                    'Status': rem.status,
                    'Data CreÄƒrii': new Date(rem.createdAt).toLocaleDateString('ro-RO')
                })));
                XLSX.utils.book_append_sheet(wb, remindersWS, 'Reminder-uri');
            }
            
            // InformaÈ›ii firmÄƒ
            const businessWS = XLSX.utils.json_to_sheet([{
                'Nume FirmÄƒ': businessInfo.name,
                'Telefon': businessInfo.phone,
                'Email': businessInfo.email,
                'AdresÄƒ': businessInfo.address,
                'Proprietar': businessInfo.owner,
                'CUI': businessInfo.cui || '',
                'Data Export': new Date().toLocaleDateString('ro-RO')
            }]);
            XLSX.utils.book_append_sheet(wb, businessWS, 'Info FirmÄƒ');
            
            const fileName = `RaportComplet_AdInstalGaz_${new Date().toISOString().slice(0, 10)}.xlsx`;
            XLSX.writeFile(wb, fileName);
            
            showNotification('Raportul complet a fost exportat!', 'success');
        }

        function exportBackupExcel() {
            exportFullReportExcel();
        }

        function loadReports() {
            const statisticsContent = document.getElementById('statistics-content');
            
            // Calculate statistics
            const totalClients = clients.length;
            const totalAppointments = appointments.length;
            const totalReminders = reminders.length;
            
            const thisMonth = new Date().getMonth();
            const thisYear = new Date().getFullYear();
            
            const monthlyAppointments = appointments.filter(apt => {
                const aptDate = new Date(apt.date);
                return aptDate.getMonth() === thisMonth && aptDate.getFullYear() === thisYear;
            }).length;
            
            const completedAppointments = appointments.filter(apt => apt.status === 'finalizat').length;
            const pendingReminders = reminders.filter(rem => new Date(rem.date) >= new Date()).length;
            
            statisticsContent.innerHTML = `
                <div class="bg-blue-50 p-4 rounded-lg text-center">
                    <h4 class="font-semibold text-blue-800">Total ClienÈ›i</h4>
                    <p class="text-2xl font-bold text-blue-600">${totalClients}</p>
                </div>
                <div class="bg-green-50 p-4 rounded-lg text-center">
                    <h4 class="font-semibold text-green-800">ProgramÄƒri Luna Aceasta</h4>
                    <p class="text-2xl font-bold text-green-600">${monthlyAppointments}</p>
                </div>
                <div class="bg-orange-50 p-4 rounded-lg text-center">
                    <h4 class="font-semibold text-orange-800">Servicii Finalizate</h4>
                    <p class="text-2xl font-bold text-orange-600">${completedAppointments}</p>
                </div>
            `;
        }

        // Client Management Functions (keeping dropdown functionality)
        function showAddClientModal() {
            const modalContent = `
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-xl font-bold text-gray-800">ğŸ‘¤ AdaugÄƒ Client Nou</h3>
                    <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                </div>
                <form id="client-form">
                    <div class="space-y-4">
                        <input type="text" id="client-name" placeholder="ğŸ‘¤ Nume complet" class="w-full p-3 border border-gray-300 rounded-lg" required>
                        <input type="tel" id="client-phone" placeholder="ğŸ“ Telefon" class="w-full p-3 border border-gray-300 rounded-lg" required>
                        <input type="email" id="client-email" placeholder="ğŸ“§ Email (opÈ›ional)" class="w-full p-3 border border-gray-300 rounded-lg">
                        <textarea id="client-address" placeholder="ğŸ“ AdresÄƒ completÄƒ" class="w-full p-3 border border-gray-300 rounded-lg h-24" required></textarea>
                        <textarea id="client-notes" placeholder="ğŸ“ NotiÈ›e suplimentare" class="w-full p-3 border border-gray-300 rounded-lg h-24"></textarea>
                        <div class="flex space-x-4">
                            <button type="submit" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                                ğŸ’¾ SalveazÄƒ Client
                            </button>
                            <button type="button" onclick="closeModal()" class="flex-1 bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                                âŒ AnuleazÄƒ
                            </button>
                        </div>
                    </div>
                </form>
            `;
            
            showModal(modalContent);
            
            document.getElementById('client-form').addEventListener('submit', (e) => {
                e.preventDefault();
                addClient();
            });
        }

        function addClient() {
            const client = {
                id: Date.now(),
                name: document.getElementById('client-name').value,
                phone: document.getElementById('client-phone').value,
                email: document.getElementById('client-email').value,
                address: document.getElementById('client-address').value,
                notes: document.getElementById('client-notes').value,
                createdAt: new Date().toISOString(),
                synced: false // Mark as unsynced
            };
            
            clients.push(client);
            localStorage.setItem('clients', JSON.stringify(clients));
            closeModal();
            loadClients();
            loadDashboard();
            showNotification('Client adÄƒugat cu succes!', 'success');
            
            // Sync to Firebase if online
            if (isOnline) {
                syncToFirebase();
            }
        }

        function loadClients() {
            const clientsList = document.getElementById('clients-list');
            if (clients.length === 0) {
                clientsList.innerHTML = '<p class="text-gray-500 text-center py-8">Nu ai Ã®ncÄƒ clienÈ›i adÄƒugaÈ›i</p>';
                return;
            }
            
            clientsList.innerHTML = clients.map(client => `
                <div class="bg-white p-6 rounded-lg shadow-md border-l-4 border-blue-400">
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h3 class="text-lg font-semibold text-gray-800">${client.name}</h3>
                            <p class="text-gray-600">ğŸ“ ${client.phone}</p>
                            ${client.email ? `<p class="text-gray-600">ğŸ“§ ${client.email}</p>` : ''}
                            <p class="text-gray-600">ğŸ“ ${client.address}</p>
                            ${client.notes ? `<p class="text-gray-500 mt-2">ğŸ“ ${client.notes}</p>` : ''}
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="callClient('${client.phone}')" class="bg-green-500 hover:bg-green-600 text-white p-2 rounded-lg transition duration-300">
                                ğŸ“
                            </button>
                            <button onclick="messageClient('${client.phone}')" class="bg-blue-500 hover:bg-blue-600 text-white p-2 rounded-lg transition duration-300">
                                ğŸ’¬
                            </button>
                            <button onclick="deleteClient(${client.id})" class="bg-red-500 hover:bg-red-600 text-white p-2 rounded-lg transition duration-300">
                                ğŸ—‘ï¸
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function filterClients() {
            const searchTerm = document.getElementById('client-search').value.toLowerCase();
            const filteredClients = clients.filter(client => 
                client.name.toLowerCase().includes(searchTerm) ||
                client.phone.includes(searchTerm) ||
                client.address.toLowerCase().includes(searchTerm)
            );
            
            const clientsList = document.getElementById('clients-list');
            if (filteredClients.length === 0) {
                clientsList.innerHTML = '<p class="text-gray-500 text-center py-8">Nu s-au gÄƒsit clienÈ›i</p>';
                return;
            }
            
            clientsList.innerHTML = filteredClients.map(client => `
                <div class="bg-white p-6 rounded-lg shadow-md border-l-4 border-blue-400">
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h3 class="text-lg font-semibold text-gray-800">${client.name}</h3>
                            <p class="text-gray-600">ğŸ“ ${client.phone}</p>
                            ${client.email ? `<p class="text-gray-600">ğŸ“§ ${client.email}</p>` : ''}
                            <p class="text-gray-600">ğŸ“ ${client.address}</p>
                            ${client.notes ? `<p class="text-gray-500 mt-2">ğŸ“ ${client.notes}</p>` : ''}
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="callClient('${client.phone}')" class="bg-green-500 hover:bg-green-600 text-white p-2 rounded-lg transition duration-300">
                                ğŸ“
                            </button>
                            <button onclick="messageClient('${client.phone}')" class="bg-blue-500 hover:bg-blue-600 text-white p-2 rounded-lg transition duration-300">
                                ğŸ’¬
                            </button>
                            <button onclick="deleteClient(${client.id})" class="bg-red-500 hover:bg-red-600 text-white p-2 rounded-lg transition duration-300">
                                ğŸ—‘ï¸
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function callClient(phone) {
            window.open(`tel:${phone}`);
        }

        function messageClient(phone) {
            const message = encodeURIComponent('BunÄƒ ziua! VÄƒ contactez de la Ad Instal Gaz SRL.');
            window.open(`https://wa.me/40${phone.replace(/^0/, '')}?text=${message}`);
        }

        function deleteClient(clientId) {
            if (confirm('Sigur vrei sÄƒ È™tergi acest client?')) {
                clients = clients.filter(client => client.id !== clientId);
                localStorage.setItem('clients', JSON.stringify(clients));
                loadClients();
                loadDashboard();
                showNotification('Client È™ters cu succes!', 'success');
            }
        }

        // Appointment Management with dropdown
        function showAddAppointmentModal() {
            const modalContent = `
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-xl font-bold text-gray-800">ğŸ“… AdaugÄƒ Programare</h3>
                    <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                </div>
                <form id="appointment-form">
                    <div class="space-y-4">
                        <!-- Client selection dropdown -->
                        <select id="existing-client-select" class="w-full p-3 border border-gray-300 rounded-lg mb-4 bg-blue-50">
                            <option value="">ğŸ‘¤ SelecteazÄƒ client existent sau adaugÄƒ nou...</option>
                        </select>
                        
                        <input type="text" id="client-name" placeholder="ğŸ‘¤ Nume client" class="w-full p-3 border border-gray-300 rounded-lg" required>
                        <input type="tel" id="client-phone" placeholder="ğŸ“ Telefon" class="w-full p-3 border border-gray-300 rounded-lg" required>
                        <textarea id="client-address" placeholder="ğŸ“ AdresÄƒ" class="w-full p-3 border border-gray-300 rounded-lg h-20" required></textarea>
                        <input type="date" id="appointment-date" class="w-full p-3 border border-gray-300 rounded-lg" required>
                        <input type="time" id="appointment-time" class="w-full p-3 border border-gray-300 rounded-lg" required>
                        <select id="appointment-service" class="w-full p-3 border border-gray-300 rounded-lg" required>
                            <option value="">ğŸ”§ SelecteazÄƒ serviciul</option>
                            <option value="Instalare centralÄƒ">Instalare centralÄƒ de Ã®ncÄƒlzire</option>
                            <option value="Instalare sobÄƒ">Instalare sobÄƒ pe gaz</option>
                            <option value="Revizie anualÄƒ">Revizie anualÄƒ</option>
                            <option value="ReparaÈ›ii">ReparaÈ›ii</option>
                            <option value="ConsultanÈ›Äƒ">ConsultanÈ›Äƒ</option>
                            <option value="Altul">Altul</option>
                        </select>
                        <textarea id="appointment-notes" placeholder="ğŸ“ NotiÈ›e suplimentare" class="w-full p-3 border border-gray-300 rounded-lg h-24"></textarea>
                        <div class="flex space-x-4">
                            <button type="submit" class="flex-1 bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                                ğŸ’¾ SalveazÄƒ Programarea
                            </button>
                            <button type="button" onclick="closeModal()" class="flex-1 bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                                âŒ AnuleazÄƒ
                            </button>
                        </div>
                    </div>
                </form>
            `;
            
            showModal(modalContent);
            
            // Populate client dropdown
            const clientDropdown = document.getElementById('existing-client-select');
            clients.forEach(client => {
                const option = document.createElement('option');
                option.value = client.id;
                option.textContent = `ğŸ‘¤ ${client.name} - ğŸ“ ${client.phone} - ğŸ“ ${client.address}`;
                clientDropdown.appendChild(option);
            });
            
            // Auto-fill form when client is selected
            clientDropdown.addEventListener('change', function() {
                const selectedClientId = this.value;
                if (selectedClientId) {
                    const selectedClient = clients.find(c => c.id == selectedClientId);
                    if (selectedClient) {
                        document.getElementById('client-name').value = selectedClient.name;
                        document.getElementById('client-phone').value = selectedClient.phone;
                        document.getElementById('client-address').value = selectedClient.address;
                        
                        // Style fields as auto-filled
                        const formFields = document.querySelectorAll('#client-name, #client-phone, #client-address');
                        formFields.forEach(field => {
                            field.style.backgroundColor = '#e5f3ff';
                            field.readOnly = true;
                        });
                    }
                } else {
                    // Clear and enable fields for new client
                    document.getElementById('client-name').value = '';
                    document.getElementById('client-phone').value = '';
                    document.getElementById('client-address').value = '';
                    
                    const formFields = document.querySelectorAll('#client-name, #client-phone, #client-address');
                    formFields.forEach(field => {
                        field.style.backgroundColor = '';
                        field.readOnly = false;
                    });
                }
            });
            
            document.getElementById('appointment-form').addEventListener('submit', (e) => {
                e.preventDefault();
                addAppointment();
            });
        }

        function addAppointment() {
            const appointment = {
                id: Date.now(),
                clientName: document.getElementById('client-name').value,
                clientPhone: document.getElementById('client-phone').value,
                address: document.getElementById('client-address').value,
                date: document.getElementById('appointment-date').value,
                time: document.getElementById('appointment-time').value,
                service: document.getElementById('appointment-service').value,
                notes: document.getElementById('appointment-notes').value,
                status: 'programat',
                createdAt: new Date().toISOString(),
                synced: false // Mark as unsynced
            };
            
            appointments.push(appointment);
            localStorage.setItem('appointments', JSON.stringify(appointments));
            closeModal();
            loadAppointments();
            loadDashboard();
            showNotification('Programare adÄƒugatÄƒ cu succes!', 'success');
            
            // Sync to Firebase if online
            if (isOnline) {
                syncToFirebase();
            }
        }

        function loadAppointments() {
            const appointmentsList = document.getElementById('appointments-list');
            if (appointments.length === 0) {
                appointmentsList.innerHTML = '<p class="text-gray-500 text-center py-8">Nu ai Ã®ncÄƒ programÄƒri</p>';
                return;
            }
            
            const sortedAppointments = appointments.sort((a, b) => {
                const dateA = new Date(a.date + ' ' + a.time);
                const dateB = new Date(b.date + ' ' + b.time);
                return dateB - dateA;
            });
            
            appointmentsList.innerHTML = sortedAppointments.map(apt => {
                const statusColors = {
                    'programat': 'bg-yellow-100 text-yellow-800',
                    'confirmat': 'bg-green-100 text-green-800',
                    'finalizat': 'bg-blue-100 text-blue-800',
                    'anulat': 'bg-red-100 text-red-800'
                };
                
                return `
                    <div class="bg-white p-6 rounded-lg shadow-md border-l-4 border-green-400">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <div class="flex items-center space-x-2 mb-2">
                                    <h3 class="text-lg font-semibold text-gray-800">${apt.clientName}</h3>
                                    <span class="text-xs px-2 py-1 rounded-full ${statusColors[apt.status] || 'bg-gray-100 text-gray-800'}">${apt.status}</span>
                                </div>
                                <p class="text-gray-600">ğŸ“ ${apt.clientPhone}</p>
                                <p class="text-gray-600">ğŸ“… ${apt.date} la ${apt.time}</p>
                                <p class="text-gray-600">ğŸ”§ ${apt.service}</p>
                                <p class="text-gray-600">ğŸ“ ${apt.address}</p>
                                ${apt.notes ? `<p class="text-gray-500 mt-2">ğŸ“ ${apt.notes}</p>` : ''}
                            </div>
                            <div class="flex flex-col space-y-2">
                                <button onclick="callClient('${apt.clientPhone}')" class="bg-green-500 hover:bg-green-600 text-white p-2 rounded-lg transition duration-300">
                                    ğŸ“
                                </button>
                                <button onclick="messageClient('${apt.clientPhone}')" class="bg-blue-500 hover:bg-blue-600 text-white p-2 rounded-lg transition duration-300">
                                    ğŸ’¬
                                </button>
                                <button onclick="sendWhatsAppReminder('${apt.clientPhone}', '${apt.clientName}', '${apt.date}', '${apt.time}', '${apt.service}')" class="bg-green-600 hover:bg-green-700 text-white p-2 rounded-lg transition duration-300">
                                    ğŸ“±
                                </button>
                                <button onclick="deleteAppointment(${apt.id})" class="bg-red-500 hover:bg-red-600 text-white p-2 rounded-lg transition duration-300">
                                    ğŸ—‘ï¸
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function sendWhatsAppReminder(phone, name, date, time, service) {
            const message = encodeURIComponent(`BunÄƒ ziua ${name}! VÄƒ reamintim de programarea dumneavoastrÄƒ pentru ${service} pe data de ${date} la ora ${time}. MulÈ›umim! - Ad Instal Gaz SRL`);
            window.open(`https://wa.me/40${phone.replace(/^0/, '')}?text=${message}`);
        }

        function deleteAppointment(aptId) {
            if (confirm('Sigur vrei sÄƒ È™tergi aceastÄƒ programare?')) {
                appointments = appointments.filter(apt => apt.id !== aptId);
                localStorage.setItem('appointments', JSON.stringify(appointments));
                loadAppointments();
                loadDashboard();
                showNotification('Programare È™tersÄƒ cu succes!', 'success');
            }
        }

        // Reminders Management
        function loadReminders() {
            const remindersSection = document.getElementById('reminders-section');
            
            remindersSection.innerHTML = `
                <div class="max-w-4xl mx-auto">
                    <h2 class="text-2xl font-bold text-blue-600 mb-6 text-center">ğŸ“… Reminder-uri ClienÈ›i</h2>
                    
                    <!-- Quick Client Dropdown -->
                    <div class="bg-yellow-50 p-4 rounded-lg mb-6 border-l-4 border-yellow-400">
                        <h3 class="font-semibold text-gray-800 mb-3">ğŸ” Selectare RapidÄƒ Client</h3>
                        <select id="quick-client-select" class="w-full p-3 border border-yellow-300 rounded-lg bg-yellow-100">
                            <option value="">ğŸ‘¤ SelecteazÄƒ client pentru reminder rapid...</option>
                        </select>
                    </div>
                    
                    <!-- Manual Reminder Form -->
                    <div class="bg-white p-6 rounded-lg shadow-md border-l-4 border-blue-400 mb-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">ğŸ“ AdaugÄƒ Reminder Manual</h3>
                        <form id="reminder-form">
                            <input type="text" id="reminder-client" placeholder="ğŸ‘¤ Nume Client" class="w-full p-3 border border-gray-300 rounded-lg mb-3" required>
                            <input type="tel" id="reminder-phone" placeholder="ğŸ“ Telefon" class="w-full p-3 border border-gray-300 rounded-lg mb-3" required>
                            <textarea id="reminder-message" placeholder="ğŸ’¬ Mesaj reminder (opÈ›ional)" class="w-full p-3 border border-gray-300 rounded-lg mb-3 h-24"></textarea>
                            <input type="date" id="reminder-date" class="w-full p-3 border border-gray-300 rounded-lg mb-3" required>
                            <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition duration-300">
                                â° AdaugÄƒ Reminder
                            </button>
                        </form>
                    </div>
                    
                    <!-- Reminders List -->
                    <div id="reminders-list" class="space-y-4"></div>
                </div>
            `;
            
            // Populate quick client dropdown
            const quickClientSelect = document.getElementById('quick-client-select');
            clients.forEach(client => {
                const option = document.createElement('option');
                option.value = client.id;
                option.textContent = `ğŸ‘¤ ${client.name} - ğŸ“ ${client.phone}`;
                quickClientSelect.appendChild(option);
            });
            
            // Quick client selection handler
            quickClientSelect.addEventListener('change', function() {
                const selectedClientId = this.value;
                if (selectedClientId) {
                    const selectedClient = clients.find(c => c.id == selectedClientId);
                    if (selectedClient) {
                        document.getElementById('reminder-client').value = selectedClient.name;
                        document.getElementById('reminder-phone').value = selectedClient.phone;
                        document.getElementById('reminder-message').value = `BunÄƒ ziua ${selectedClient.name}! VÄƒ contactez de la Ad Instal Gaz SRL pentru a vÄƒ aminti de revizia anualÄƒ.`;
                    }
                }
            });
            
            // Form submission
            document.getElementById('reminder-form').addEventListener('submit', function(e) {
                e.preventDefault();
                addReminder();
            });
            
            // Load existing reminders
            loadRemindersList();
        }

        function addReminder() {
            const reminder = {
                id: Date.now(),
                clientName: document.getElementById('reminder-client').value,
                phone: document.getElementById('reminder-phone').value,
                message: document.getElementById('reminder-message').value,
                date: document.getElementById('reminder-date').value,
                status: 'activ',
                createdAt: new Date().toISOString(),
                synced: false // Mark as unsynced
            };
            
            reminders.push(reminder);
            localStorage.setItem('reminders', JSON.stringify(reminders));
            
            // Clear form
            document.getElementById('reminder-form').reset();
            document.getElementById('quick-client-select').value = '';
            
            loadRemindersList();
            loadDashboard();
            showNotification('Reminder adÄƒugat cu succes!', 'success');
            
            // Sync to Firebase if online
            if (isOnline) {
                syncToFirebase();
            }
        }

        function loadRemindersList() {
            const remindersList = document.getElementById('reminders-list');
            if (reminders.length === 0) {
                remindersList.innerHTML = '<p class="text-gray-500 text-center py-8">Nu ai reminder-uri setate</p>';
                return;
            }
            
            const sortedReminders = reminders.sort((a, b) => new Date(a.date) - new Date(b.date));
            
            remindersList.innerHTML = sortedReminders.map(reminder => {
                const isOverdue = new Date(reminder.date) < new Date();
                const borderColor = isOverdue ? 'border-red-400' : 'border-orange-400';
                const bgColor = isOverdue ? 'bg-red-50' : 'bg-orange-50';
                
                return `
                    <div class="${bgColor} p-6 rounded-lg shadow-md border-l-4 ${borderColor}">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <h3 class="text-lg font-semibold text-gray-800">${reminder.clientName}</h3>
                                <p class="text-gray-600">ğŸ“ ${reminder.phone}</p>
                                <p class="text-gray-600">ğŸ“… ${reminder.date} ${isOverdue ? '(ÃNTÃ‚RZIAT)' : ''}</p>
                                ${reminder.message ? `<p class="text-gray-600 mt-2">ğŸ’¬ ${reminder.message}</p>` : ''}
                            </div>
                            <div class="flex space-x-2">
                                <button onclick="sendReminderWhatsApp('${reminder.phone}', '${reminder.clientName}', '${reminder.message}')" class="bg-green-600 hover:bg-green-700 text-white p-2 rounded-lg transition duration-300">
                                    ğŸ“± Trimite
                                </button>
                                <button onclick="markReminderComplete(${reminder.id})" class="bg-blue-600 hover:bg-blue-700 text-white p-2 rounded-lg transition duration-300">
                                    âœ… Completat
                                </button>
                                <button onclick="deleteReminder(${reminder.id})" class="bg-red-500 hover:bg-red-600 text-white p-2 rounded-lg transition duration-300">
                                    ğŸ—‘ï¸
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function sendReminderWhatsApp(phone, name, message) {
            const whatsappMessage = message || `BunÄƒ ziua ${name}! VÄƒ contactez de la Ad Instal Gaz SRL.`;
            const encodedMessage = encodeURIComponent(whatsappMessage);
            window.open(`https://wa.me/40${phone.replace(/^0/, '')}?text=${encodedMessage}`);
        }

        function markReminderComplete(reminderId) {
            reminders = reminders.filter(reminder => reminder.id !== reminderId);
            localStorage.setItem('reminders', JSON.stringify(reminders));
            loadRemindersList();
            loadDashboard();
            showNotification('Reminder marcat ca completat!', 'success');
        }

        function deleteReminder(reminderId) {
            if (confirm('Sigur vrei sÄƒ È™tergi acest reminder?')) {
                reminders = reminders.filter(reminder => reminder.id !== reminderId);
                localStorage.setItem('reminders', JSON.stringify(reminders));
                loadRemindersList();
                loadDashboard();
                showNotification('Reminder È™ters cu succes!', 'success');
            }
        }

        function showAddReminderModal() {
            switchTab('reminders');
        }

        // Documents Management
        function loadDocuments() {
            const documentsList = document.getElementById('documents-list');
            if (documents.length === 0) {
                documentsList.innerHTML = '<p class="text-gray-500 text-center py-8">Nu ai documente Ã®ncÄƒrcate</p>';
                return;
            }
            
            documentsList.innerHTML = documents.map(doc => `
                <div class="bg-white p-6 rounded-lg shadow-md border-l-4 border-purple-400">
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h3 class="text-lg font-semibold text-gray-800">${doc.name}</h3>
                            <p class="text-gray-600">ğŸ“… ${new Date(doc.createdAt).toLocaleDateString()}</p>
                            <p class="text-gray-600">ğŸ“ ${(doc.size / 1024).toFixed(1)} KB</p>
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="viewDocument('${doc.id}')" class="bg-blue-500 hover:bg-blue-600 text-white p-2 rounded-lg transition duration-300">
                                ğŸ‘ï¸
                            </button>
                            <button onclick="downloadDocument('${doc.id}')" class="bg-green-500 hover:bg-green-600 text-white p-2 rounded-lg transition duration-300">
                                ğŸ“¥
                            </button>
                            <button onclick="deleteDocument('${doc.id}')" class="bg-red-500 hover:bg-red-600 text-white p-2 rounded-lg transition duration-300">
                                ğŸ—‘ï¸
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Camera functionality
        let currentStream = null;

        function startCamera() {
            const cameraSection = document.getElementById('camera-section');
            const video = document.getElementById('camera-video');
            
            navigator.mediaDevices.getUserMedia({ 
                video: { 
                    facingMode: 'environment',
                    width: { ideal: 1920 },
                    height: { ideal: 1080 }
                } 
            })
            .then(stream => {
                currentStream = stream;
                video.srcObject = stream;
                cameraSection.classList.remove('hidden');
            })
            .catch(err => {
                showNotification('Nu se poate accesa camera: ' + err.message, 'error');
            });
        }

        function stopCamera() {
            if (currentStream) {
                currentStream.getTracks().forEach(track => track.stop());
                currentStream = null;
            }
            document.getElementById('camera-section').classList.add('hidden');
        }

        function captureDocument() {
            const video = document.getElementById('camera-video');
            const canvas = document.createElement('canvas');
            const context = canvas.getContext('2d');
            
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            context.drawImage(video, 0, 0);
            
            canvas.toBlob(blob => {
                const document = {
                    id: Date.now(),
                    name: `Document_${new Date().toISOString().slice(0, 19).replace(/:/g, '-')}.jpg`,
                    type: 'image/jpeg',
                    size: blob.size,
                    data: canvas.toDataURL('image/jpeg', 0.8),
                    createdAt: new Date().toISOString()
                };
                
                documents.push(document);
                localStorage.setItem('documents', JSON.stringify(documents));
                stopCamera();
                loadDocuments();
                showNotification('Document capturat cu succes!', 'success');
            }, 'image/jpeg', 0.8);
        }

        function viewDocument(docId) {
            const doc = documents.find(d => d.id == docId);
            if (doc) {
                const modalContent = `
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold text-gray-800">ğŸ“„ ${doc.name}</h3>
                        <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                    </div>
                    <div class="text-center">
                        <img src="${doc.data}" alt="${doc.name}" class="max-w-full max-h-96 mx-auto rounded-lg">
                    </div>
                `;
                showModal(modalContent);
            }
        }

        function downloadDocument(docId) {
            const doc = documents.find(d => d.id == docId);
            if (doc) {
                const link = document.createElement('a');
                link.href = doc.data;
                link.download = doc.name;
                link.click();
            }
        }

        function deleteDocument(docId) {
            if (confirm('Sigur vrei sÄƒ È™tergi acest document?')) {
                documents = documents.filter(doc => doc.id != docId);
                localStorage.setItem('documents', JSON.stringify(documents));
                loadDocuments();
                showNotification('Document È™ters cu succes!', 'success');
            }
        }

        // Utility functions
        function showModal(content) {
            document.getElementById('modal-content').innerHTML = content;
            document.getElementById('modal-overlay').classList.remove('hidden');
        }

        function closeModal() {
            document.getElementById('modal-overlay').classList.add('hidden');
            if (currentStream) {
                stopCamera();
            }
        }

        function showQuickActionsMenu() {
            const modalContent = `
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-xl font-bold text-gray-800">ğŸš€ AcÈ›iuni Rapide</h3>
                    <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700 text-2xl">&times;</button>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <button onclick="closeModal(); showAddClientModal();" class="bg-blue-500 hover:bg-blue-600 text-white p-6 rounded-lg transition duration-300 text-left">
                        <div class="text-2xl mb-2">ğŸ‘¤</div>
                        <div class="font-semibold">AdaugÄƒ Client</div>
                        <div class="text-sm opacity-75">Client nou Ã®n sistem</div>
                    </button>
                    <button onclick="closeModal(); showAddAppointmentModal();" class="bg-green-500 hover:bg-green-600 text-white p-6 rounded-lg transition duration-300 text-left">
                        <div class="text-2xl mb-2">ğŸ“…</div>
                        <div class="font-semibold">Programare</div>
                        <div class="text-sm opacity-75">ProgrameazÄƒ Ã®ntÃ¢lnire</div>
                    </button>
                    <button onclick="closeModal(); switchTab('reminders');" class="bg-orange-500 hover:bg-orange-600 text-white p-6 rounded-lg transition duration-300 text-left">
                        <div class="text-2xl mb-2">â°</div>
                        <div class="font-semibold">Reminder</div>
                        <div class="text-sm opacity-75">SeteazÄƒ reminder</div>
                    </button>
                    <button onclick="closeModal(); switchTab('reports');" class="bg-purple-500 hover:bg-purple-600 text-white p-6 rounded-lg transition duration-300 text-left">
                        <div class="text-2xl mb-2">ğŸ“Š</div>
                        <div class="font-semibold">Rapoarte</div>
                        <div class="text-sm opacity-75">GenereazÄƒ raport</div>
                    </button>
                </div>
            `;
            showModal(modalContent);
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            const bgColor = type === 'success' ? 'bg-green-500' : type === 'error' ? 'bg-red-500' : 'bg-blue-500';
            
            notification.className = `fixed top-4 right-4 ${bgColor} text-white px-6 py-3 rounded-lg shadow-lg z-50 transform transition-transform duration-300`;
            notification.textContent = message;
            notification.style.transform = 'translateX(100%)';
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 100);
            
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        function checkNotifications() {
            const today = new Date().toISOString().split('T')[0];
            const todayReminders = reminders.filter(rem => rem.date === today);
            const overdueReminders = reminders.filter(rem => new Date(rem.date) < new Date());
            
            const totalNotifications = todayReminders.length + overdueReminders.length;
            
            if (totalNotifications > 0) {
                document.getElementById('notification-count').textContent = totalNotifications;
                document.getElementById('notification-count').classList.remove('hidden');
            }
        }

        function saveBusinessInfo(e) {
            e.preventDefault();
            
            businessInfo = {
                name: document.getElementById('business-name').value,
                phone: document.getElementById('business-phone').value,
                email: document.getElementById('business-email').value,
                address: document.getElementById('business-address').value,
                owner: document.getElementById('business-owner').value,
                cui: document.getElementById('business-cui').value
            };
            
            localStorage.setItem('businessInfo', JSON.stringify(businessInfo));
            showNotification('InformaÈ›iile firmei au fost salvate!', 'success');
        }

        function exportData() {
            const data = {
                clients,
                appointments,
                reminders,
                documents: documents.map(doc => ({...doc, data: 'data_removed_for_export'})),
                businessInfo,
                exportDate: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ad_instal_gaz_backup_${new Date().toISOString().slice(0, 10)}.json`;
            a.click();
            URL.revokeObjectURL(url);
            
            showNotification('Datele au fost exportate!', 'success');
        }

        function importData(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const data = JSON.parse(e.target.result);
                        
                        if (confirm('AceastÄƒ acÈ›iune va Ã®nlocui toate datele existente. ContinuaÈ›i?')) {
                            if (data.clients) clients = data.clients;
                            if (data.appointments) appointments = data.appointments;
                            if (data.reminders) reminders = data.reminders;
                            if (data.businessInfo) businessInfo = data.businessInfo;
                            
                            localStorage.setItem('clients', JSON.stringify(clients));
                            localStorage.setItem('appointments', JSON.stringify(appointments));
                            localStorage.setItem('reminders', JSON.stringify(reminders));
                            localStorage.setItem('businessInfo', JSON.stringify(businessInfo));
                            
                            loadDashboard();
                            loadBusinessInfo();
                            showNotification('Datele au fost importate cu succes!', 'success');
                        }
                    } catch (error) {
                        showNotification('FiÈ™ierul nu este valid!', 'error');
                    }
                };
                reader.readAsText(file);
            }
        }

        function clearAllData() {
            if (confirm('ATENÈšIE: AceastÄƒ acÈ›iune va È™terge TOATE datele din aplicaÈ›ie. AceastÄƒ acÈ›iune nu poate fi anulatÄƒ. ContinuaÈ›i?')) {
                localStorage.clear();
                clients = [];
                appointments = [];
                reminders = [];
                documents = [];
                businessInfo = {
                    name: 'Ad Instal Gaz SRL',
                    phone: '0762614402',
                    email: 'gavrila_1971@yahoo.com',
                    address: 'Str. MÄƒrÄƒÈ™eÈ™ti, Nr.97',
                    owner: 'Gavrila',
                    cui: ''
                };
                localStorage.setItem('businessInfo', JSON.stringify(businessInfo));
                
                loadDashboard();
                loadBusinessInfo();
                showNotification('Toate datele au fost È™terse!', 'success');
            }
        }

        // Initialize the application
        initApp();
    </script>
</body>
</html>
