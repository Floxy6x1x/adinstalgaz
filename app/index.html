<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AdInstalGaz SRL - Management System</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIkFkSW5zdGFsR2F6IFNSTCIsCiAgInNob3J0X25hbWUiOiAiQWRJbnN0YWxHYXoiLAogICJkZXNjcmlwdGlvbiI6ICJTaXN0ZW0gbWFuYWdlbWVudCBBZEluc3RhbEdheiIsCiAgInN0YXJ0X3VybCI6ICIvIiwKICAiZGlzcGxheSI6ICJzdGFuZGFsb25lIiwKICAiYmFja2dyb3VuZF9jb2xvciI6ICIjZmZmZmZmIiwKICAidGhlbWVfY29sb3IiOiAiIzI1NjNlYiIsCiAgImljb25zIjogWwogICAgewogICAgICAic3JjIjogImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjNhV1IwYUQwaU5USTBJaUJvWldsbmFIUTlJalV5TkNJZ2RtbGxkMEp2ZUQwaU1DQXdJRFV5TkNBMU1qUWlJR1pwYkd3OUlpTXlOVFl6WldJaVBqeGphWEpqYkdVZ1kzZzlJakkyTWlJZ1kzazlJakkyTWlJZ2NqMGlNVEF3SWlCbWFXeHNQU0lqTWpVMk0yVmlJaTgrUEhSbGVIUWdlRDBpTWpZeUlpQjVQU0l5T0RZaUlIUmxlSFF0WVc1amFHOXlQU0p0YVdSa2JHVWlJR1pwYkd3OUluZG9hWFJsSWlCbWIyNTBMWE5wZW1VOUlqTXdJaUIyYVd4clBTSWlQakJJUFQvMGVYQmxQUzlqYVhKamJHVXJlR05zZFhScGRtVWdhV1FrZVNFaVBDOTBlSFIrUEM5emRtYysifSwKICAgIHsKICAgICAgInNyYyI6ICJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUIzYVdSMGFEMGlOVEV5SWlCb1pXbG5hSFE5SWpVeE1pSWdkbWxsZDBKdmVEMGlNQ0F3SURVMU1qUWlJR1pwYkd3OUlpTXlOVFl6WldJaVBqeGphWEpqYkdVZ1kzZzlJakkxTmlJZ1kzazlJakkxTmlJZ2NqMGlNakF3SWlCbWFXeHNQU0lqTWpVMk0yVmlJaTgrUEhSbGVIUWdlRDBpTWpVMklpQjVQU0l6TURBaUlIUmxlSFF0WVc1amFHOXlQU0p0YVdSa2JHVWlJR1pwYkd3OUluZG9hWFJsSWlCbWIyNTBMWE5wZW1VOUlqWXdJaUIyYVd4clBTSWlQa2hKUEM5MFpYaDBQand2YzNabktUd3ZaMitkRUJ5UXVDOVhBOHFhZHM5TnZQa1F0em9TQjE2YlNGbVBnYUlWL3h1TC9tNWlLN3BBQXFLQU5ZSytKRW1LZCIsInNpemVzIjogIjUxMng1MTIiLCJ0eXBlIjogImltYWdlL3N2Zyt4bWwifQogIF0sCiAgImNhdGVnb3JpZXMiOiBbImJ1c2luZXNzIiwgInV0aWxpdGllcyJdCn0=">
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#2563eb">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="AdInstalGaz">
    
    <!-- External Libraries -->
    <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #2563eb;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .slide-in {
            animation: slideIn 0.3s ease-out;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        // SERVICIILE COMPANIEI
        const SERVICES = {
            verificare_instalatie: { name: 'Verificare Instalație Gaz', price: 150, validity: 2 },
            revizie_instalatie: { name: 'Revizie Instalație Gaz', price: 250, validity: 2 },
            verificare_centrala: { name: 'Verificare Centrală', price: 150, validity: 2 },
            oferta_completa: { name: 'OFERTĂ: Instalații + Centrală', price: 250, validity: 2 },
            serviciu_urgenta: { name: 'Servicii Urgență', price: 0, validity: 0 }
        };

        // DATELE MINIME PENTRU APLICAȚIE
        function getInitialData() {
            return {
                clients: [
                    { 
                        id: 1, 
                        name: 'Popescu Ion', 
                        phone: '0721234567', 
                        email: 'ion.popescu@email.com',
                        address: 'Str. Libertatii nr. 15, Bucuresti',
                        lastService: '2024-01-15',
                        serviceType: 'verificare_instalatie',
                        expiresAt: '2026-01-15'
                    },
                    { 
                        id: 2, 
                        name: 'Ionescu Maria', 
                        phone: '0732456789', 
                        email: 'maria.ionescu@email.com',
                        address: 'Bd. Revolutiei nr. 42, Cluj-Napoca',
                        lastService: '2024-02-20',
                        serviceType: 'oferta_completa',
                        expiresAt: '2026-02-20'
                    },
                    { 
                        id: 3, 
                        name: 'Marinescu George', 
                        phone: '0743567890', 
                        email: 'george.marinescu@email.com',
                        address: 'Str. Mihai Eminescu nr. 8, Iasi',
                        lastService: '2023-03-10',
                        serviceType: 'verificare_centrala',
                        expiresAt: '2025-03-10'
                    }
                ],
                workers: [
                    { 
                        id: 1, 
                        name: 'Munteanu Adrian', 
                        phone: '0712345678',
                        email: 'adrian.munteanu@adinstalgazsrl.ro',
                        zone: 'Bucuresti'
                    },
                    { 
                        id: 2, 
                        name: 'Stanescu Bogdan', 
                        phone: '0723456789',
                        email: 'bogdan.stanescu@adinstalgazsrl.ro',
                        zone: 'Cluj-Napoca'
                    }
                ],
                assignments: [
                    {
                        id: 1,
                        clientId: 1,
                        workerId: 1,
                        serviceType: 'verificare_instalatie',
                        scheduledDate: '2024-07-15',
                        status: 'assigned', // assigned, in_progress, completed
                        notes: 'Verificare anuala programata',
                        documents: []
                    },
                    {
                        id: 2,
                        clientId: 3,
                        workerId: 2,
                        serviceType: 'verificare_centrala',
                        scheduledDate: '2024-07-16',
                        status: 'in_progress',
                        notes: 'Verificare urgenta - probleme la centrala',
                        documents: []
                    }
                ]
            };
        }

        function AdInstalGazApp() {
            // Authentication state
            const [isAuthenticated, setIsAuthenticated] = useState(false);
            const [currentUser, setCurrentUser] = useState(null);
            const [userRole, setUserRole] = useState(null); // 'admin' or 'worker'
            
            // Application state
            const [activeTab, setActiveTab] = useState('dashboard');
            
            // PWA state
            const [deferredPrompt, setDeferredPrompt] = useState(null);
            const [showInstallPrompt, setShowInstallPrompt] = useState(false);
            const [syncStatus, setSyncStatus] = useState('synced');
            const [isOnline, setIsOnline] = useState(navigator.onLine);
            
            // Data state with localStorage sync
            const [data, setData] = useState(() => {
                const savedData = localStorage.getItem('adinstalgazData');
                return savedData ? JSON.parse(savedData) : getInitialData();
            });

            // SMS functionality
            const [smsModal, setSmsModal] = useState(false);
            const [smsRecipient, setSmsRecipient] = useState('');
            const [smsMessage, setSmsMessage] = useState('');

            // Assignment modal
            const [assignmentModal, setAssignmentModal] = useState(false);
            const [selectedClient, setSelectedClient] = useState(null);

            // Document upload
            const [documentModal, setDocumentModal] = useState(false);
            const [selectedAssignment, setSelectedAssignment] = useState(null);

            // PWA Installation handling
            useEffect(() => {
                const handleBeforeInstallPrompt = (e) => {
                    e.preventDefault();
                    setDeferredPrompt(e);
                    setShowInstallPrompt(true);
                };

                window.addEventListener('beforeinstallprompt', handleBeforeInstallPrompt);
                return () => window.removeEventListener('beforeinstallprompt', handleBeforeInstallPrompt);
            }, []);

            // Online/Offline detection
            useEffect(() => {
                const handleOnline = () => {
                    setIsOnline(true);
                    setSyncStatus('syncing');
                    setTimeout(() => setSyncStatus('synced'), 1000);
                };

                const handleOffline = () => {
                    setIsOnline(false);
                    setSyncStatus('offline');
                };

                window.addEventListener('online', handleOnline);
                window.addEventListener('offline', handleOffline);

                return () => {
                    window.removeEventListener('online', handleOnline);
                    window.removeEventListener('offline', handleOffline);
                };
            }, []);

            // Data synchronization
            useEffect(() => {
                if (isOnline) {
                    setSyncStatus('syncing');
                    localStorage.setItem('adinstalgazData', JSON.stringify(data));
                    localStorage.setItem('lastSync', new Date().toISOString());
                    setTimeout(() => setSyncStatus('synced'), 500);
                }
            }, [data, isOnline]);

            const handleInstallApp = async () => {
                if (deferredPrompt) {
                    deferredPrompt.prompt();
                    const { outcome } = await deferredPrompt.userChoice;
                    if (outcome === 'accepted') {
                        setDeferredPrompt(null);
                        setShowInstallPrompt(false);
                    }
                }
            };

            // Authentication functions
            const handleLogin = (username, password) => {
                if (username === 'admin' && password === 'admin123') {
                    setCurrentUser({ name: 'Administrator', email: 'admin@adinstalgazsrl.ro' });
                    setUserRole('admin');
                    setIsAuthenticated(true);
                    return true;
                } else if (username === 'adrian' && password === 'worker123') {
                    setCurrentUser({ name: 'Munteanu Adrian', email: 'adrian.munteanu@adinstalgazsrl.ro', workerId: 1 });
                    setUserRole('worker');
                    setIsAuthenticated(true);
                    return true;
                } else if (username === 'bogdan' && password === 'worker123') {
                    setCurrentUser({ name: 'Stanescu Bogdan', email: 'bogdan.stanescu@adinstalgazsrl.ro', workerId: 2 });
                    setUserRole('worker');
                    setIsAuthenticated(true);
                    return true;
                }
                return false;
            };

            const handleLogout = () => {
                setIsAuthenticated(false);
                setCurrentUser(null);
                setUserRole(null);
                setActiveTab('dashboard');
            };

            // SMS Functions
            const sendSMS = async () => {
                if (!smsRecipient || !smsMessage.trim()) {
                    alert('Completați toate câmpurile!');
                    return;
                }

                setSyncStatus('syncing');
                
                try {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                    
                    const smsLog = {
                        id: Date.now(),
                        recipient: smsRecipient,
                        message: smsMessage,
                        sentAt: new Date().toISOString(),
                        status: 'sent'
                    };

                    const smsHistory = JSON.parse(localStorage.getItem('smsHistory') || '[]');
                    smsHistory.unshift(smsLog);
                    localStorage.setItem('smsHistory', JSON.stringify(smsHistory));

                    alert(`✅ SMS trimis cu succes către ${smsRecipient}!`);
                    setSmsRecipient('');
                    setSmsMessage('');
                    setSmsModal(false);
                    
                } catch (error) {
                    alert('❌ Eroare la trimiterea SMS-ului.');
                } finally {
                    setSyncStatus('synced');
                }
            };

            const sendQuickSMS = (client, messageType) => {
                const messages = {
                    reminder: `Buna ziua ${client.name}! Va reamintim ca certificatul pentru instalatia de gaz expira la ${client.expiresAt}. Va rugam sa ne contactati pentru reprogramare. AdInstalGaz SRL - 0721.123.456`,
                    appointment: `Buna ziua ${client.name}! Va confirmam programarea pentru verificarea instalatiei la adresa ${client.address} maine la ora 10:00. AdInstalGaz SRL`,
                    completion: `Buna ziua ${client.name}! Verificarea instalatiei a fost finalizata cu succes. Certificatul este valabil pana la ${new Date(Date.now() + 2*365*24*60*60*1000).toLocaleDateString('ro-RO')}. AdInstalGaz SRL`
                };

                setSmsRecipient(client.phone);
                setSmsMessage(messages[messageType] || '');
                setSmsModal(true);
            };

            // Assignment Functions
            const assignWork = (client, serviceType, scheduledDate, notes) => {
                const newAssignment = {
                    id: Date.now(),
                    clientId: client.id,
                    workerId: userRole === 'admin' ? 1 : currentUser.workerId, // Default to first worker for admin
                    serviceType,
                    scheduledDate,
                    status: 'assigned',
                    notes,
                    documents: []
                };

                setData(prev => ({
                    ...prev,
                    assignments: [...prev.assignments, newAssignment]
                }));

                setAssignmentModal(false);
                alert('✅ Lucrare asignată cu succes!');
            };

            const updateAssignmentStatus = (assignmentId, newStatus) => {
                setData(prev => ({
                    ...prev,
                    assignments: prev.assignments.map(assignment => 
                        assignment.id === assignmentId 
                            ? { ...assignment, status: newStatus }
                            : assignment
                    )
                }));
                
                alert(`✅ Status actualizat la: ${newStatus}`);
            };

            const uploadDocument = (assignmentId, documentType) => {
                // Simulate document upload
                const newDocument = {
                    id: Date.now(),
                    type: documentType,
                    name: `${documentType}_${Date.now()}.pdf`,
                    uploadedAt: new Date().toISOString()
                };

                setData(prev => ({
                    ...prev,
                    assignments: prev.assignments.map(assignment => 
                        assignment.id === assignmentId 
                            ? { ...assignment, documents: [...assignment.documents, newDocument] }
                            : assignment
                    )
                }));

                setDocumentModal(false);
                alert('✅ Document încărcat cu succes!');
            };

            // Utility Functions
            const getClientById = (clientId) => data.clients.find(c => c.id === clientId);
            const getWorkerById = (workerId) => data.workers.find(w => w.id === workerId);
            
            const getExpiringClients = () => {
                const in30Days = new Date(Date.now() + 30*24*60*60*1000);
                return data.clients.filter(client => new Date(client.expiresAt) <= in30Days);
            };

            const getWorkerAssignments = (workerId) => {
                return data.assignments.filter(a => a.workerId === workerId);
            };

            // Components
            function LoginForm({ onLogin }) {
                const [username, setUsername] = useState('');
                const [password, setPassword] = useState('');
                const [isLoading, setIsLoading] = useState(false);
                const [error, setError] = useState('');

                const handleSubmit = async (e) => {
                    e.preventDefault();
                    setIsLoading(true);
                    setError('');
                    
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                    const success = onLogin(username, password);
                    if (!success) {
                        setError('Credențiale incorecte!');
                    }
                    setIsLoading(false);
                };

                return (
                    <div className="min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-500 to-purple-600">
                        <div className="max-w-md w-full mx-4">
                            <div className="bg-white rounded-xl shadow-2xl p-8">
                                <div className="text-center mb-8">
                                    <h1 className="text-3xl font-bold text-gray-800">AdInstalGaz SRL</h1>
                                    <p className="text-gray-600 mt-2">Sistem Management</p>
                                </div>
                                
                                <form onSubmit={handleSubmit} className="space-y-6">
                                    <div>
                                        <input
                                            type="text"
                                            placeholder="Nume utilizator"
                                            value={username}
                                            onChange={(e) => setUsername(e.target.value)}
                                            className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                            required
                                        />
                                    </div>
                                    <div>
                                        <input
                                            type="password"
                                            placeholder="Parolă"
                                            value={password}
                                            onChange={(e) => setPassword(e.target.value)}
                                            className="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                            required
                                        />
                                    </div>
                                    
                                    {error && (
                                        <div className="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded">
                                            {error}
                                        </div>
                                    )}
                                    
                                    <button
                                        type="submit"
                                        disabled={isLoading}
                                        className="w-full py-3 px-4 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center"
                                    >
                                        {isLoading ? (
                                            <>
                                                <div className="loading-spinner mr-3"></div>
                                                Se conectează...
                                            </>
                                        ) : (
                                            'Conectare'
                                        )}
                                    </button>
                                </form>
                                
                                <div className="mt-6 text-center text-sm text-gray-600">
                                    <p className="mb-2">👤 Conturi demo:</p>
                                    <p>Admin: admin / admin123</p>
                                    <p>Lucrător: adrian / worker123</p>
                                    <p>Lucrător: bogdan / worker123</p>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            function Header() {
                return (
                    <header className="bg-white shadow-sm border-b border-gray-200 mb-6">
                        <div className="flex items-center justify-between py-4 px-6">
                            <div>
                                <h1 className="text-2xl font-bold text-gray-900">AdInstalGaz SRL</h1>
                                <p className="text-gray-600">
                                    {userRole === 'admin' ? 'Panou Administrator' : 'Panou Lucrător'}
                                </p>
                            </div>
                            <div className="flex items-center space-x-4">
                                <button 
                                    onClick={() => setSmsModal(true)}
                                    className="flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
                                >
                                    <span>📱</span>
                                    <span className="hidden sm:inline">SMS</span>
                                </button>
                                
                                <div className="text-right">
                                    <p className="text-sm font-medium text-gray-700">{currentUser?.name}</p>
                                    <p className="text-xs text-gray-500">{userRole === 'admin' ? 'Administrator' : 'Lucrător'}</p>
                                </div>
                                <button
                                    onClick={handleLogout}
                                    className="text-gray-600 hover:text-gray-800 p-2"
                                    title="Deconectare"
                                >
                                    🚪
                                </button>
                            </div>
                        </div>
                    </header>
                );
            }

            function Navigation() {
                const adminTabs = [
                    { id: 'dashboard', name: 'Dashboard', icon: '🏠' },
                    { id: 'clients', name: 'Clienți', icon: '👥' },
                    { id: 'assignments', name: 'Asignări', icon: '📋' },
                    { id: 'workers', name: 'Lucrători', icon: '👨‍🔧' },
                    { id: 'reports', name: 'Rapoarte', icon: '📊' }
                ];

                const workerTabs = [
                    { id: 'dashboard', name: 'Dashboard', icon: '🏠' },
                    { id: 'my-work', name: 'Lucrările Mele', icon: '🔧' },
                    { id: 'completed', name: 'Finalizate', icon: '✅' }
                ];

                const tabs = userRole === 'admin' ? adminTabs : workerTabs;

                return (
                    <nav className="bg-white rounded-lg shadow mb-6 sticky top-0 z-40">
                        <div className="px-4">
                            <div className="flex space-x-8 overflow-x-auto">
                                {tabs.map(tab => (
                                    <button
                                        key={tab.id}
                                        onClick={() => setActiveTab(tab.id)}
                                        className={`whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm transition-colors ${
                                            activeTab === tab.id
                                                ? 'border-blue-500 text-blue-600'
                                                : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'
                                        }`}
                                    >
                                        <span className="mr-2">{tab.icon}</span>
                                        {tab.name}
                                    </button>
                                ))}
                            </div>
                        </div>
                    </nav>
                );
            }

            function Dashboard() {
                const expiringClients = getExpiringClients();
                const totalAssignments = userRole === 'admin' 
                    ? data.assignments.length 
                    : getWorkerAssignments(currentUser.workerId).length;
                
                const completedAssignments = userRole === 'admin'
                    ? data.assignments.filter(a => a.status === 'completed').length
                    : getWorkerAssignments(currentUser.workerId).filter(a => a.status === 'completed').length;

                return (
                    <div className="space-y-6">
                        {/* Stats Overview */}
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                            <div className="bg-gradient-to-r from-blue-500 to-blue-600 text-white p-6 rounded-lg shadow">
                                <div className="flex items-center">
                                    <span className="text-3xl mr-4">👥</span>
                                    <div>
                                        <p className="text-sm opacity-90">Total Clienți</p>
                                        <p className="text-2xl font-bold">{data.clients.length}</p>
                                    </div>
                                </div>
                            </div>

                            <div className="bg-gradient-to-r from-red-500 to-red-600 text-white p-6 rounded-lg shadow">
                                <div className="flex items-center">
                                    <span className="text-3xl mr-4">⚠️</span>
                                    <div>
                                        <p className="text-sm opacity-90">Expirări în 30 zile</p>
                                        <p className="text-2xl font-bold">{expiringClients.length}</p>
                                    </div>
                                </div>
                            </div>

                            <div className="bg-gradient-to-r from-yellow-500 to-yellow-600 text-white p-6 rounded-lg shadow">
                                <div className="flex items-center">
                                    <span className="text-3xl mr-4">📋</span>
                                    <div>
                                        <p className="text-sm opacity-90">Lucrări Totale</p>
                                        <p className="text-2xl font-bold">{totalAssignments}</p>
                                    </div>
                                </div>
                            </div>

                            <div className="bg-gradient-to-r from-green-500 to-green-600 text-white p-6 rounded-lg shadow">
                                <div className="flex items-center">
                                    <span className="text-3xl mr-4">✅</span>
                                    <div>
                                        <p className="text-sm opacity-90">Finalizate</p>
                                        <p className="text-2xl font-bold">{completedAssignments}</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {/* Expiring Certificates Alert */}
                        {expiringClients.length > 0 && (
                            <div className="bg-red-50 border border-red-200 rounded-lg p-6">
                                <h3 className="text-lg font-semibold text-red-800 mb-4">⚠️ Clienți cu Certificări ce Expiră Curând</h3>
                                <div className="space-y-3">
                                    {expiringClients.map(client => (
                                        <div key={client.id} className="flex items-center justify-between bg-white p-3 rounded border border-red-200">
                                            <div>
                                                <p className="font-medium text-gray-900">{client.name}</p>
                                                <p className="text-sm text-gray-600">{SERVICES[client.serviceType]?.name}</p>
                                                <p className="text-sm text-red-600">Expiră: {client.expiresAt}</p>
                                            </div>
                                            <button 
                                                onClick={() => sendQuickSMS(client, 'reminder')}
                                                className="px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors"
                                            >
                                                📱 Trimite Reminder
                                            </button>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* Quick Actions */}
                        <div className="bg-white rounded-lg shadow p-6">
                            <h3 className="text-lg font-semibold text-gray-800 mb-4">🚀 Acțiuni Rapide</h3>
                            <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                                {userRole === 'admin' ? (
                                    <>
                                        <button 
                                            onClick={() => setActiveTab('clients')}
                                            className="p-4 text-left border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 transition-colors"
                                        >
                                            <div className="text-2xl mb-2">👥</div>
                                            <div className="font-semibold">Gestionează Clienți</div>
                                        </button>
                                        <button 
                                            onClick={() => setActiveTab('assignments')}
                                            className="p-4 text-left border border-gray-200 rounded-lg hover:bg-green-50 hover:border-green-300 transition-colors"
                                        >
                                            <div className="text-2xl mb-2">📋</div>
                                            <div className="font-semibold">Asignează Lucrări</div>
                                        </button>
                                        <button 
                                            onClick={() => setSmsModal(true)}
                                            className="p-4 text-left border border-gray-200 rounded-lg hover:bg-purple-50 hover:border-purple-300 transition-colors"
                                        >
                                            <div className="text-2xl mb-2">📱</div>
                                            <div className="font-semibold">Trimite SMS</div>
                                        </button>
                                        <button 
                                            onClick={() => setActiveTab('reports')}
                                            className="p-4 text-left border border-gray-200 rounded-lg hover:bg-yellow-50 hover:border-yellow-300 transition-colors"
                                        >
                                            <div className="text-2xl mb-2">📊</div>
                                            <div className="font-semibold">Vezi Rapoarte</div>
                                        </button>
                                    </>
                                ) : (
                                    <>
                                        <button 
                                            onClick={() => setActiveTab('my-work')}
                                            className="p-4 text-left border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 transition-colors"
                                        >
                                            <div className="text-2xl mb-2">🔧</div>
                                            <div className="font-semibold">Lucrările Mele</div>
                                        </button>
                                        <button 
                                            onClick={() => setActiveTab('completed')}
                                            className="p-4 text-left border border-gray-200 rounded-lg hover:bg-green-50 hover:border-green-300 transition-colors"
                                        >
                                            <div className="text-2xl mb-2">✅</div>
                                            <div className="font-semibold">Finalizate</div>
                                        </button>
                                        <button 
                                            onClick={() => setSmsModal(true)}
                                            className="p-4 text-left border border-gray-200 rounded-lg hover:bg-purple-50 hover:border-purple-300 transition-colors"
                                        >
                                            <div className="text-2xl mb-2">📱</div>
                                            <div className="font-semibold">Contactează Client</div>
                                        </button>
                                        <button className="p-4 text-left border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors opacity-50">
                                            <div className="text-2xl mb-2">📄</div>
                                            <div className="font-semibold">Documente</div>
                                        </button>
                                    </>
                                )}
                            </div>
                        </div>
                    </div>
                );
            }

            function ClientsTab() {
                return (
                    <div className="space-y-6">
                        <div className="bg-white rounded-lg shadow">
                            <div className="px-6 py-4 border-b border-gray-200 flex justify-between items-center">
                                <h3 className="text-lg font-semibold text-gray-800">👥 Gestionare Clienți</h3>
                                <button className="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                                    + Adaugă Client
                                </button>
                            </div>
                            <div className="overflow-x-auto">
                                <table className="min-w-full divide-y divide-gray-200">
                                    <thead className="bg-gray-50">
                                        <tr>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Client</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Contact</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ultimul Serviciu</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Expiră</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Acțiuni</th>
                                        </tr>
                                    </thead>
                                    <tbody className="bg-white divide-y divide-gray-200">
                                        {data.clients.map(client => {
                                            const isExpiringSoon = new Date(client.expiresAt) <= new Date(Date.now() + 30*24*60*60*1000);
                                            return (
                                                <tr key={client.id} className="hover:bg-gray-50">
                                                    <td className="px-6 py-4 whitespace-nowrap">
                                                        <div>
                                                            <div className="text-sm font-medium text-gray-900">{client.name}</div>
                                                            <div className="text-sm text-gray-500">{client.address}</div>
                                                        </div>
                                                    </td>
                                                    <td className="px-6 py-4 whitespace-nowrap">
                                                        <div className="text-sm text-gray-900">{client.phone}</div>
                                                        <div className="text-sm text-gray-500">{client.email}</div>
                                                    </td>
                                                    <td className="px-6 py-4 whitespace-nowrap">
                                                        <div className="text-sm text-gray-900">{SERVICES[client.serviceType]?.name}</div>
                                                        <div className="text-sm text-gray-500">{client.lastService}</div>
                                                    </td>
                                                    <td className="px-6 py-4 whitespace-nowrap">
                                                        <span className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${
                                                            isExpiringSoon 
                                                                ? 'bg-red-100 text-red-800' 
                                                                : 'bg-green-100 text-green-800'
                                                        }`}>
                                                            {client.expiresAt}
                                                        </span>
                                                    </td>
                                                    <td className="px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2">
                                                        <button 
                                                            onClick={() => {
                                                                setSelectedClient(client);
                                                                setAssignmentModal(true);
                                                            }}
                                                            className="text-blue-600 hover:text-blue-900"
                                                        >
                                                            📋 Asignează
                                                        </button>
                                                        <button 
                                                            onClick={() => sendQuickSMS(client, 'reminder')}
                                                            className="text-green-600 hover:text-green-900"
                                                        >
                                                            📱 SMS
                                                        </button>
                                                    </td>
                                                </tr>
                                            );
                                        })}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                );
            }

            function AssignmentsTab() {
                return (
                    <div className="space-y-6">
                        <div className="bg-white rounded-lg shadow">
                            <div className="px-6 py-4 border-b border-gray-200">
                                <h3 className="text-lg font-semibold text-gray-800">📋 Toate Asignările</h3>
                            </div>
                            <div className="overflow-x-auto">
                                <table className="min-w-full divide-y divide-gray-200">
                                    <thead className="bg-gray-50">
                                        <tr>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Client</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Serviciu</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Lucrător</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Data Programată</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Acțiuni</th>
                                        </tr>
                                    </thead>
                                    <tbody className="bg-white divide-y divide-gray-200">
                                        {data.assignments.map(assignment => {
                                            const client = getClientById(assignment.clientId);
                                            const worker = getWorkerById(assignment.workerId);
                                            return (
                                                <tr key={assignment.id} className="hover:bg-gray-50">
                                                    <td className="px-6 py-4 whitespace-nowrap">
                                                        <div className="text-sm font-medium text-gray-900">{client?.name}</div>
                                                        <div className="text-sm text-gray-500">{client?.address}</div>
                                                    </td>
                                                    <td className="px-6 py-4 whitespace-nowrap">
                                                        <div className="text-sm text-gray-900">{SERVICES[assignment.serviceType]?.name}</div>
                                                        <div className="text-sm text-gray-500">{SERVICES[assignment.serviceType]?.price} RON</div>
                                                    </td>
                                                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{worker?.name}</td>
                                                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{assignment.scheduledDate}</td>
                                                    <td className="px-6 py-4 whitespace-nowrap">
                                                        <span className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${
                                                            assignment.status === 'completed' ? 'bg-green-100 text-green-800' :
                                                            assignment.status === 'in_progress' ? 'bg-yellow-100 text-yellow-800' :
                                                            'bg-blue-100 text-blue-800'
                                                        }`}>
                                                            {assignment.status === 'assigned' ? 'Asignat' :
                                                             assignment.status === 'in_progress' ? 'În progres' : 'Finalizat'}
                                                        </span>
                                                    </td>
                                                    <td className="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                                        <button 
                                                            onClick={() => sendQuickSMS(client, 'appointment')}
                                                            className="text-blue-600 hover:text-blue-900 mr-3"
                                                        >
                                                            📱 SMS Client
                                                        </button>
                                                    </td>
                                                </tr>
                                            );
                                        })}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                );
            }

            function MyWorkTab() {
                const myAssignments = getWorkerAssignments(currentUser.workerId);
                const pendingWork = myAssignments.filter(a => a.status !== 'completed');

                return (
                    <div className="space-y-6">
                        <div className="bg-white rounded-lg shadow">
                            <div className="px-6 py-4 border-b border-gray-200">
                                <h3 className="text-lg font-semibold text-gray-800">🔧 Lucrările Mele ({pendingWork.length} active)</h3>
                            </div>
                            <div className="p-6 space-y-4">
                                {pendingWork.length === 0 ? (
                                    <div className="text-center py-8 text-gray-500">
                                        <div className="text-4xl mb-4">✅</div>
                                        <p>Nu aveți lucrări active momentan</p>
                                    </div>
                                ) : (
                                    pendingWork.map(assignment => {
                                        const client = getClientById(assignment.clientId);
                                        return (
                                            <div key={assignment.id} className="border border-gray-200 rounded-lg p-4">
                                                <div className="flex justify-between items-start mb-4">
                                                    <div>
                                                        <h4 className="font-semibold text-lg text-gray-900">{client?.name}</h4>
                                                        <p className="text-gray-600">{client?.address}</p>
                                                        <p className="text-sm text-gray-500">📞 {client?.phone}</p>
                                                    </div>
                                                    <span className={`px-3 py-1 text-sm font-semibold rounded-full ${
                                                        assignment.status === 'in_progress' ? 'bg-yellow-100 text-yellow-800' : 'bg-blue-100 text-blue-800'
                                                    }`}>
                                                        {assignment.status === 'assigned' ? 'Asignat' : 'În progres'}
                                                    </span>
                                                </div>
                                                
                                                <div className="bg-gray-50 rounded p-3 mb-4">
                                                    <p className="font-medium text-gray-700">📋 {SERVICES[assignment.serviceType]?.name}</p>
                                                    <p className="text-sm text-gray-600">📅 Programat: {assignment.scheduledDate}</p>
                                                    <p className="text-sm text-gray-600">💰 Tarif: {SERVICES[assignment.serviceType]?.price} RON</p>
                                                    {assignment.notes && (
                                                        <p className="text-sm text-gray-600 mt-2">📝 {assignment.notes}</p>
                                                    )}
                                                </div>

                                                <div className="flex flex-wrap gap-2">
                                                    {assignment.status === 'assigned' && (
                                                        <button 
                                                            onClick={() => updateAssignmentStatus(assignment.id, 'in_progress')}
                                                            className="px-4 py-2 bg-yellow-600 text-white rounded hover:bg-yellow-700 transition-colors"
                                                        >
                                                            🚀 Începe Lucrarea
                                                        </button>
                                                    )}
                                                    
                                                    {assignment.status === 'in_progress' && (
                                                        <>
                                                            <button 
                                                                onClick={() => {
                                                                    setSelectedAssignment(assignment);
                                                                    setDocumentModal(true);
                                                                }}
                                                                className="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors"
                                                            >
                                                                📄 Încarcă Document
                                                            </button>
                                                            <button 
                                                                onClick={() => updateAssignmentStatus(assignment.id, 'completed')}
                                                                className="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors"
                                                            >
                                                                ✅ Finalizează
                                                            </button>
                                                        </>
                                                    )}
                                                    
                                                    <button 
                                                        onClick={() => sendQuickSMS(client, 'appointment')}
                                                        className="px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 transition-colors"
                                                    >
                                                        📱 SMS Client
                                                    </button>
                                                </div>

                                                {assignment.documents.length > 0 && (
                                                    <div className="mt-4 pt-4 border-t border-gray-200">
                                                        <p className="text-sm font-medium text-gray-700 mb-2">📎 Documente încărcate:</p>
                                                        <div className="space-y-1">
                                                            {assignment.documents.map(doc => (
                                                                <div key={doc.id} className="text-sm text-gray-600 bg-gray-100 p-2 rounded">
                                                                    {doc.type}: {doc.name}
                                                                </div>
                                                            ))}
                                                        </div>
                                                    </div>
                                                )}
                                            </div>
                                        );
                                    })
                                )}
                            </div>
                        </div>
                    </div>
                );
            }

            function CompletedTab() {
                const myAssignments = getWorkerAssignments(currentUser.workerId);
                const completedWork = myAssignments.filter(a => a.status === 'completed');

                return (
                    <div className="space-y-6">
                        <div className="bg-white rounded-lg shadow">
                            <div className="px-6 py-4 border-b border-gray-200">
                                <h3 className="text-lg font-semibold text-gray-800">✅ Lucrări Finalizate ({completedWork.length})</h3>
                            </div>
                            <div className="overflow-x-auto">
                                <table className="min-w-full divide-y divide-gray-200">
                                    <thead className="bg-gray-50">
                                        <tr>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Client</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Serviciu</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Data</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Documente</th>
                                        </tr>
                                    </thead>
                                    <tbody className="bg-white divide-y divide-gray-200">
                                        {completedWork.map(assignment => {
                                            const client = getClientById(assignment.clientId);
                                            return (
                                                <tr key={assignment.id} className="hover:bg-gray-50">
                                                    <td className="px-6 py-4 whitespace-nowrap">
                                                        <div className="text-sm font-medium text-gray-900">{client?.name}</div>
                                                        <div className="text-sm text-gray-500">{client?.phone}</div>
                                                    </td>
                                                    <td className="px-6 py-4 whitespace-nowrap">
                                                        <div className="text-sm text-gray-900">{SERVICES[assignment.serviceType]?.name}</div>
                                                        <div className="text-sm text-gray-500">{SERVICES[assignment.serviceType]?.price} RON</div>
                                                    </td>
                                                    <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{assignment.scheduledDate}</td>
                                                    <td className="px-6 py-4 whitespace-nowrap">
                                                        <span className="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">
                                                            {assignment.documents.length} documente
                                                        </span>
                                                    </td>
                                                </tr>
                                            );
                                        })}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                );
            }

            function WorkersTab() {
                return (
                    <div className="space-y-6">
                        <div className="bg-white rounded-lg shadow">
                            <div className="px-6 py-4 border-b border-gray-200">
                                <h3 className="text-lg font-semibold text-gray-800">👨‍🔧 Gestionare Lucrători</h3>
                            </div>
                            <div className="p-6">
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    {data.workers.map(worker => {
                                        const workerAssignments = getWorkerAssignments(worker.id);
                                        const activeAssignments = workerAssignments.filter(a => a.status !== 'completed');
                                        const completedAssignments = workerAssignments.filter(a => a.status === 'completed');
                                        
                                        return (
                                            <div key={worker.id} className="border border-gray-200 rounded-lg p-4">
                                                <div className="flex items-center mb-4">
                                                    <div className="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mr-4">
                                                        <span className="text-xl">👨‍🔧</span>
                                                    </div>
                                                    <div>
                                                        <h4 className="font-semibold text-lg text-gray-900">{worker.name}</h4>
                                                        <p className="text-gray-600">Zona: {worker.zone}</p>
                                                        <p className="text-sm text-gray-500">{worker.phone}</p>
                                                    </div>
                                                </div>
                                                
                                                <div className="grid grid-cols-2 gap-4 mb-4">
                                                    <div className="bg-yellow-50 p-3 rounded">
                                                        <p className="text-sm font-medium text-yellow-800">Lucrări Active</p>
                                                        <p className="text-2xl font-bold text-yellow-600">{activeAssignments.length}</p>
                                                    </div>
                                                    <div className="bg-green-50 p-3 rounded">
                                                        <p className="text-sm font-medium text-green-800">Finalizate</p>
                                                        <p className="text-2xl font-bold text-green-600">{completedAssignments.length}</p>
                                                    </div>
                                                </div>

                                                {activeAssignments.length > 0 && (
                                                    <div>
                                                        <p className="text-sm font-medium text-gray-700 mb-2">Lucrări curente:</p>
                                                        <div className="space-y-2">
                                                            {activeAssignments.slice(0, 2).map(assignment => {
                                                                const client = getClientById(assignment.clientId);
                                                                return (
                                                                    <div key={assignment.id} className="text-sm bg-gray-50 p-2 rounded">
                                                                        <span className="font-medium">{client?.name}</span>
                                                                        <span className="text-gray-500 ml-2">- {assignment.scheduledDate}</span>
                                                                    </div>
                                                                );
                                                            })}
                                                            {activeAssignments.length > 2 && (
                                                                <p className="text-sm text-gray-500">+{activeAssignments.length - 2} mai multe...</p>
                                                            )}
                                                        </div>
                                                    </div>
                                                )}
                                            </div>
                                        );
                                    })}
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            function ReportsTab() {
                const totalRevenue = data.assignments
                    .filter(a => a.status === 'completed')
                    .reduce((sum, a) => sum + (SERVICES[a.serviceType]?.price || 0), 0);

                const serviceStats = Object.keys(SERVICES).map(serviceType => {
                    const assignments = data.assignments.filter(a => a.serviceType === serviceType);
                    const completed = assignments.filter(a => a.status === 'completed');
                    const revenue = completed.reduce((sum, a) => sum + (SERVICES[serviceType]?.price || 0), 0);
                    
                    return {
                        service: SERVICES[serviceType].name,
                        total: assignments.length,
                        completed: completed.length,
                        revenue
                    };
                }).filter(stat => stat.total > 0);

                return (
                    <div className="space-y-6">
                        {/* Revenue Overview */}
                        <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div className="bg-gradient-to-r from-green-500 to-green-600 text-white p-6 rounded-lg shadow">
                                <h3 className="text-lg font-semibold mb-2">💰 Venituri Totale</h3>
                                <p className="text-3xl font-bold">{totalRevenue.toLocaleString()} RON</p>
                                <p className="text-green-100 text-sm">Din lucrări finalizate</p>
                            </div>
                            
                            <div className="bg-gradient-to-r from-blue-500 to-blue-600 text-white p-6 rounded-lg shadow">
                                <h3 className="text-lg font-semibold mb-2">📋 Lucrări Totale</h3>
                                <p className="text-3xl font-bold">{data.assignments.length}</p>
                                <p className="text-blue-100 text-sm">Toate asignările</p>
                            </div>
                            
                            <div className="bg-gradient-to-r from-purple-500 to-purple-600 text-white p-6 rounded-lg shadow">
                                <h3 className="text-lg font-semibold mb-2">⭐ Rata Finalizare</h3>
                                <p className="text-3xl font-bold">
                                    {data.assignments.length > 0 
                                        ? Math.round((data.assignments.filter(a => a.status === 'completed').length / data.assignments.length) * 100)
                                        : 0}%
                                </p>
                                <p className="text-purple-100 text-sm">Lucrări finalizate</p>
                            </div>
                        </div>

                        {/* Services Report */}
                        <div className="bg-white rounded-lg shadow">
                            <div className="px-6 py-4 border-b border-gray-200">
                                <h3 className="text-lg font-semibold text-gray-800">📊 Raport pe Servicii</h3>
                            </div>
                            <div className="overflow-x-auto">
                                <table className="min-w-full divide-y divide-gray-200">
                                    <thead className="bg-gray-50">
                                        <tr>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Serviciu</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Total Asignări</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Finalizate</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Venituri (RON)</th>
                                            <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Rata Finalizare</th>
                                        </tr>
                                    </thead>
                                    <tbody className="bg-white divide-y divide-gray-200">
                                        {serviceStats.map((stat, index) => (
                                            <tr key={index} className="hover:bg-gray-50">
                                                <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{stat.service}</td>
                                                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{stat.total}</td>
                                                <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{stat.completed}</td>
                                                <td className="px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900">{stat.revenue.toLocaleString()}</td>
                                                <td className="px-6 py-4 whitespace-nowrap">
                                                    <div className="flex items-center">
                                                        <div className="w-16 bg-gray-200 rounded-full h-2 mr-2">
                                                            <div 
                                                                className="bg-blue-500 h-2 rounded-full" 
                                                                style={{width: `${stat.total > 0 ? (stat.completed / stat.total) * 100 : 0}%`}}
                                                            ></div>
                                                        </div>
                                                        <span className="text-sm text-gray-600">
                                                            {stat.total > 0 ? Math.round((stat.completed / stat.total) * 100) : 0}%
                                                        </span>
                                                    </div>
                                                </td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                );
            }

            const renderActiveTab = () => {
                if (userRole === 'admin') {
                    switch(activeTab) {
                        case 'dashboard': return <Dashboard />;
                        case 'clients': return <ClientsTab />;
                        case 'assignments': return <AssignmentsTab />;
                        case 'workers': return <WorkersTab />;
                        case 'reports': return <ReportsTab />;
                        default: return <Dashboard />;
                    }
                } else {
                    switch(activeTab) {
                        case 'dashboard': return <Dashboard />;
                        case 'my-work': return <MyWorkTab />;
                        case 'completed': return <CompletedTab />;
                        default: return <Dashboard />;
                    }
                }
            };

            return (
                <div className="min-h-screen bg-gray-100">
                    {!isAuthenticated ? (
                        <LoginForm onLogin={handleLogin} />
                    ) : (
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                            <Header />
                            <Navigation />
                            {renderActiveTab()}
                            
                            {/* PWA Install Prompt */}
                            {showInstallPrompt && (
                                <div className="fixed bottom-4 right-4 bg-blue-600 text-white p-4 rounded-lg shadow-lg max-w-sm slide-in z-50">
                                    <div className="flex items-center justify-between">
                                        <div>
                                            <p className="font-semibold">Instalează aplicația</p>
                                            <p className="text-sm opacity-90">Pentru acces rapid și offline</p>
                                        </div>
                                        <div className="flex gap-2 ml-4">
                                            <button 
                                                onClick={handleInstallApp}
                                                className="bg-white text-blue-600 px-3 py-1 rounded text-sm font-semibold"
                                            >
                                                Instalează
                                            </button>
                                            <button 
                                                onClick={() => setShowInstallPrompt(false)}
                                                className="text-white opacity-70 hover:opacity-100"
                                            >
                                                ✕
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            )}
                            
                            {/* Sync Status Indicator */}
                            <div className="fixed bottom-4 left-4 flex items-center gap-2 bg-white px-3 py-2 rounded-lg shadow-lg z-40">
                                <div className={`w-2 h-2 rounded-full ${
                                    syncStatus === 'synced' ? 'bg-green-500' : 
                                    syncStatus === 'syncing' ? 'bg-yellow-500 pulse' : 'bg-red-500'
                                }`}></div>
                                <span className="text-sm text-gray-600">
                                    {syncStatus === 'synced' ? 'Sincronizat' : 
                                     syncStatus === 'syncing' ? 'Se sincronizează...' : 'Offline'}
                                </span>
                            </div>

                            {/* SMS Modal */}
                            {smsModal && (
                                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                                    <div className="bg-white rounded-lg p-6 w-full max-w-md mx-4">
                                        <div className="flex justify-between items-center mb-4">
                                            <h3 className="text-lg font-semibold text-gray-800">📱 Trimite SMS</h3>
                                            <button 
                                                onClick={() => setSmsModal(false)}
                                                className="text-gray-500 hover:text-gray-700 text-xl"
                                            >
                                                ×
                                            </button>
                                        </div>
                                        
                                        <div className="space-y-4">
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">Număr telefon</label>
                                                <input
                                                    type="tel"
                                                    value={smsRecipient}
                                                    onChange={(e) => setSmsRecipient(e.target.value)}
                                                    placeholder="07xxxxxxxx"
                                                    className="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                                />
                                            </div>

                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">Mesaj</label>
                                                <textarea
                                                    value={smsMessage}
                                                    onChange={(e) => setSmsMessage(e.target.value)}
                                                    placeholder="Mesajul SMS..."
                                                    rows={5}
                                                    maxLength={160}
                                                    className="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                                />
                                                <div className="text-right mt-1">
                                                    <span className="text-xs text-gray-500">{smsMessage.length}/160 caractere</span>
                                                </div>
                                            </div>

                                            <div className="flex gap-3">
                                                <button
                                                    onClick={() => setSmsModal(false)}
                                                    className="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"
                                                >
                                                    Anulează
                                                </button>
                                                <button
                                                    onClick={sendSMS}
                                                    disabled={!smsRecipient || !smsMessage.trim()}
                                                    className="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors"
                                                >
                                                    📤 Trimite SMS
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* Assignment Modal */}
                            {assignmentModal && selectedClient && (
                                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                                    <div className="bg-white rounded-lg p-6 w-full max-w-md mx-4">
                                        <div className="flex justify-between items-center mb-4">
                                            <h3 className="text-lg font-semibold text-gray-800">📋 Asignează Lucrare</h3>
                                            <button 
                                                onClick={() => setAssignmentModal(false)}
                                                className="text-gray-500 hover:text-gray-700 text-xl"
                                            >
                                                ×
                                            </button>
                                        </div>
                                        
                                        <form onSubmit={(e) => {
                                            e.preventDefault();
                                            const formData = new FormData(e.target);
                                            assignWork(
                                                selectedClient,
                                                formData.get('serviceType'),
                                                formData.get('scheduledDate'),
                                                formData.get('notes')
                                            );
                                        }} className="space-y-4">
                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">Client</label>
                                                <input
                                                    type="text"
                                                    value={selectedClient.name}
                                                    disabled
                                                    className="w-full border border-gray-300 rounded-lg px-3 py-2 bg-gray-100"
                                                />
                                            </div>

                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">Serviciu</label>
                                                <select
                                                    name="serviceType"
                                                    required
                                                    className="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"
                                                >
                                                    {Object.entries(SERVICES).map(([key, service]) => (
                                                        <option key={key} value={key}>
                                                            {service.name} - {service.price > 0 ? `${service.price} RON` : 'Tarif personalizat'}
                                                        </option>
                                                    ))}
                                                </select>
                                            </div>

                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">Data programată</label>
                                                <input
                                                    type="date"
                                                    name="scheduledDate"
                                                    required
                                                    className="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"
                                                />
                                            </div>

                                            <div>
                                                <label className="block text-sm font-medium text-gray-700 mb-2">Observații</label>
                                                <textarea
                                                    name="notes"
                                                    placeholder="Observații pentru lucrător..."
                                                    rows={3}
                                                    className="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500"
                                                />
                                            </div>

                                            <div className="flex gap-3">
                                                <button
                                                    type="button"
                                                    onClick={() => setAssignmentModal(false)}
                                                    className="flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"
                                                >
                                                    Anulează
                                                </button>
                                                <button
                                                    type="submit"
                                                    className="flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
                                                >
                                                    📋 Asignează
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            )}

                            {/* Document Upload Modal */}
                            {documentModal && selectedAssignment && (
                                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                                    <div className="bg-white rounded-lg p-6 w-full max-w-md mx-4">
                                        <div className="flex justify-between items-center mb-4">
                                            <h3 className="text-lg font-semibold text-gray-800">📄 Încarcă Document</h3>
                                            <button 
                                                onClick={() => setDocumentModal(false)}
                                                className="text-gray-500 hover:text-gray-700 text-xl"
                                            >
                                                ×
                                            </button>
                                        </div>
                                        
                                        <div className="space-y-4">
                                            <p className="text-sm text-gray-600">
                                                Client: <span className="font-medium">{getClientById(selectedAssignment.clientId)?.name}</span>
                                            </p>
                                            
                                            <div className="grid grid-cols-1 gap-3">
                                                <button
                                                    onClick={() => uploadDocument(selectedAssignment.id, 'Certificat Conformitate')}
                                                    className="p-4 text-left border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 transition-colors"
                                                >
                                                    <div className="font-medium">📜 Certificat Conformitate</div>
                                                    <div className="text-sm text-gray-500">Document principal de conformitate</div>
                                                </button>
                                                
                                                <button
                                                    onClick={() => uploadDocument(selectedAssignment.id, 'Poze Instalatie')}
                                                    className="p-4 text-left border border-gray-200 rounded-lg hover:bg-green-50 hover:border-green-300 transition-colors"
                                                >
                                                    <div className="font-medium">📸 Poze Instalație</div>
                                                    <div className="text-sm text-gray-500">Fotografii înainte/după</div>
                                                </button>
                                                
                                                <button
                                                    onClick={() => uploadDocument(selectedAssignment.id, 'Raport Tehnic')}
                                                    className="p-4 text-left border border-gray-200 rounded-lg hover:bg-yellow-50 hover:border-yellow-300 transition-colors"
                                                >
                                                    <div className="font-medium">📋 Raport Tehnic</div>
                                                    <div className="text-sm text-gray-500">Detalii tehnice verificări</div>
                                                </button>
                                            </div>

                                            <button
                                                onClick={() => setDocumentModal(false)}
                                                className="w-full px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"
                                            >
                                                Închide
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </div>
                    )}
                </div>
            );
        }

        // Render the application
        ReactDOM.render(<AdInstalGazApp />, document.getElementById('root'));
    </script>

    <!-- Service Worker Registration -->
    <script>
        // Create service worker as a blob URL
        const swCode = `
            const CACHE_NAME = 'adinstalgazsrl-v1';
            const urlsToCache = [
                '/',
                '/offline.html'
            ];

            self.addEventListener('install', event => {
                event.waitUntil(
                    caches.open(CACHE_NAME)
                        .then(cache => {
                            return cache.addAll(urlsToCache.filter(url => !url.startsWith('http')));
                        })
                );
            });

            self.addEventListener('fetch', event => {
                event.respondWith(
                    caches.match(event.request)
                        .then(response => {
                            if (response) {
                                return response;
                            }
                            
                            const fetchRequest = event.request.clone();
                            
                            return fetch(fetchRequest).then(response => {
                                if (!response || response.status !== 200 || response.type !== 'basic') {
                                    return response;
                                }
                                
                                const responseToCache = response.clone();
                                
                                caches.open(CACHE_NAME)
                                    .then(cache => {
                                        cache.put(event.request, responseToCache);
                                    });
                                
                                return response;
                            }).catch(() => {
                                if (event.request.destination === 'document') {
                                    return new Response('<h1>Offline</h1><p>Aplicația funcționează offline!</p>', {
                                        headers: { 'Content-Type': 'text/html' }
                                    });
                                }
                            });
                        })
                );
            });

            self.addEventListener('activate', event => {
                event.waitUntil(
                    caches.keys().then(cacheNames => {
                        return Promise.all(
                            cacheNames.map(cacheName => {
                                if (cacheName !== CACHE_NAME) {
                                    return caches.delete(cacheName);
                                }
                            })
                        );
                    })
                );
            });

            self.addEventListener('sync', event => {
                if (event.tag === 'background-sync') {
                    event.waitUntil(
                        self.clients.matchAll().then(clients => {
                            clients.forEach(client => {
                                client.postMessage({
                                    type: 'SYNC_DATA'
                                });
                            });
                        })
                    );
                }
            });
        `;
        
        // Register service worker with blob URL
        if ('serviceWorker' in navigator) {
            const swBlob = new Blob([swCode], { type: 'application/javascript' });
            const swUrl = URL.createObjectURL(swBlob);
            
            navigator.serviceWorker.register(swUrl)
                .then(registration => {
                    console.log('Service Worker registered successfully:', registration);
                })
                .catch(error => {
                    console.log('Service Worker registration failed:', error);
                });
        }
    </script>
</body>
</html>
