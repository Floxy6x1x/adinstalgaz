<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AdInstalGaz - Portal Angaja»õi</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Login Screen */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .login-card {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            text-align: center;
            max-width: 400px;
            width: 100%;
        }

        .login-card h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .login-card p {
            color: #7f8c8d;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #2c3e50;
        }

        .form-group input {
            width: 100%;
            padding: 15px;
            border: 2px solid #ecf0f1;
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.1);
        }

        .login-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(52,152,219,0.3);
        }

        .login-btn:active {
            transform: translateY(0);
        }

        /* Main App Layout */
        .app-container {
            display: none;
            min-height: 100vh;
            background: #f8f9fa;
        }

        .header {
            background: white;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #2c3e50;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-badge {
            background: #27ae60;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .user-badge.worker {
            background: #f39c12;
        }

        .logout-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .logout-btn:hover {
            background: #c0392b;
        }

        .nav-tabs {
            background: white;
            padding: 0 20px;
            border-bottom: 2px solid #ecf0f1;
        }

        .nav-tabs button {
            background: none;
            border: none;
            padding: 15px 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            color: #7f8c8d;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }

        .nav-tabs button.active {
            color: #3498db;
            border-bottom-color: #3498db;
        }

        .nav-tabs button:hover {
            color: #2980b9;
        }

        .content {
            padding: 30px 20px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Cards */
        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
        }

        .card h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        /* Dashboard Stats */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
        }

        .stat-card .icon {
            font-size: 3em;
            margin-bottom: 15px;
        }

        .stat-card .number {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .stat-card .label {
            color: #7f8c8d;
            font-size: 1.1em;
        }

        .stat-card.blue { color: #3498db; }
        .stat-card.green { color: #27ae60; }
        .stat-card.orange { color: #f39c12; }
        .stat-card.red { color: #e74c3c; }

        /* Buttons */
        .btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }

        .btn.btn-success {
            background: #27ae60;
        }

        .btn.btn-success:hover {
            background: #219a52;
        }

        .btn.btn-danger {
            background: #e74c3c;
        }

        .btn.btn-danger:hover {
            background: #c0392b;
        }

        .btn.btn-warning {
            background: #f39c12;
        }

        .btn.btn-warning:hover {
            background: #d68910;
        }

        /* Tables */
        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .table th,
        .table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #ecf0f1;
        }

        .table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #2c3e50;
        }

        .table tr:hover {
            background: #f8f9fa;
        }

        /* Status badges */
        .status-badge {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-badge.programat {
            background: #e3f2fd;
            color: #1976d2;
        }

        .status-badge.in-lucru {
            background: #fff3e0;
            color: #f57c00;
        }

        .status-badge.finalizat {
            background: #e8f5e8;
            color: #2e7d32;
        }

        .status-badge.anulat {
            background: #ffebee;
            color: #c62828;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
        }

        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-header h2 {
            color: #2c3e50;
        }

        .close {
            background: none;
            border: none;
            font-size: 30px;
            cursor: pointer;
            color: #7f8c8d;
        }

        .close:hover {
            color: #2c3e50;
        }

        /* Form styles */
        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .form-row .form-group {
            flex: 1;
        }

        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ecf0f1;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52,152,219,0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #27ae60;
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 1001;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.error {
            background: #e74c3c;
        }

        /* Reset button */
        .reset-demo-btn {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: #e74c3c;
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .reset-demo-btn:hover {
            background: #c0392b;
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 15px;
            }

            .nav-tabs {
                overflow-x: auto;
                white-space: nowrap;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .form-row {
                flex-direction: column;
            }

            .modal-content {
                width: 95%;
                margin: 10px auto;
                padding: 20px;
            }
        }

        /* File upload styles */
        .file-upload {
            border: 2px dashed #ecf0f1;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .file-upload:hover {
            border-color: #3498db;
            background: #f8f9fa;
        }

        .file-upload.dragover {
            border-color: #27ae60;
            background: #e8f5e8;
        }

        .file-list {
            margin-top: 15px;
        }

        .file-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
            margin-bottom: 10px;
        }

        .file-item button {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
        }

        .file-item button:hover {
            background: #c0392b;
        }

        /* Search and filter */
        .search-filters {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .search-filters input,
        .search-filters select {
            padding: 10px;
            border: 2px solid #ecf0f1;
            border-radius: 8px;
            font-size: 14px;
        }

        .search-filters input:focus,
        .search-filters select:focus {
            outline: none;
            border-color: #3498db;
        }

        /* Action buttons */
        .action-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .action-buttons button {
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .action-buttons .btn-edit {
            background: #3498db;
            color: white;
        }

        .action-buttons .btn-edit:hover {
            background: #2980b9;
        }

        .action-buttons .btn-delete {
            background: #e74c3c;
            color: white;
        }

        .action-buttons .btn-delete:hover {
            background: #c0392b;
        }

        .action-buttons .btn-status {
            background: #27ae60;
            color: white;
        }

        .action-buttons .btn-status:hover {
            background: #219a52;
        }

        /* Program zilnic styles */
        .program-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .program-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .program-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.15);
        }

        .program-card h4 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .program-time {
            color: #7f8c8d;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .program-client {
            color: #3498db;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .program-description {
            color: #555;
            line-height: 1.5;
        }

        /* Expiry warning styles */
        .expiry-warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .expiry-critical {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }

        /* PDF export styles */
        .export-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .export-buttons button {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .export-pdf {
            background: #e74c3c;
            color: white;
        }

        .export-pdf:hover {
            background: #c0392b;
        }

        .export-excel {
            background: #27ae60;
            color: white;
        }

        .export-excel:hover {
            background: #219a52;
        }

        /* Loading animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Tabs for services */
        .service-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid #ecf0f1;
        }

        .service-tabs button {
            background: none;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            color: #7f8c8d;
            border-bottom: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .service-tabs button.active {
            color: #3498db;
            border-bottom-color: #3498db;
        }

        .service-tabs button:hover {
            color: #2980b9;
        }

        /* Quick actions */
        .quick-actions {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .quick-actions button {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .quick-actions button i {
            font-size: 16px;
        }

        .quick-actions .btn-primary {
            background: #3498db;
            color: white;
        }

        .quick-actions .btn-primary:hover {
            background: #2980b9;
        }

        .quick-actions .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .quick-actions .btn-secondary:hover {
            background: #7f8c8d;
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-container">
        <div class="login-card">
            <h1><i class="fas fa-lock"></i></h1>
            <h2>üîê Portal Angaja»õi</h2>
            <p>Acces restric»õionat</p>
            <form id="loginForm">
                <div class="form-group">
                    <label for="email">Email:</label>
                    <input type="email" id="email" name="email" required>
                </div>
                <div class="form-group">
                    <label for="password">ParolƒÉ:</label>
                    <input type="password" id="password" name="password" required>
                </div>
                <button type="submit" class="login-btn">
                    <i class="fas fa-sign-in-alt"></i> Login
                </button>
            </form>
        </div>
    </div>

    <!-- Main Application -->
    <div id="appContainer" class="app-container">
        <header class="header">
            <div class="logo">
                <i class="fas fa-fire"></i> AdInstalGaz
            </div>
            <div class="user-info">
                <span id="userName"></span>
                <span id="userRole" class="user-badge"></span>
                <button class="logout-btn" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
        </header>

        <nav class="nav-tabs">
            <button class="tab-btn active" onclick="showTab('dashboard')">
                <i class="fas fa-tachometer-alt"></i> Dashboard
            </button>
            <button class="tab-btn" onclick="showTab('lucrari')">
                <i class="fas fa-wrench"></i> LucrƒÉri
            </button>
            <button class="tab-btn" onclick="showTab('clienti')">
                <i class="fas fa-users"></i> Clien»õi
            </button>
            <button class="tab-btn" onclick="showTab('servicii')">
                <i class="fas fa-database"></i> Baza de Date Servicii
            </button>
            <button class="tab-btn" onclick="showTab('program')">
                <i class="fas fa-calendar-alt"></i> Program Zilnic
            </button>
            <button class="tab-btn" onclick="showTab('documente')">
                <i class="fas fa-file-alt"></i> Documente
            </button>
            <button class="tab-btn admin-only" onclick="showTab('utilizatori')">
                <i class="fas fa-user-cog"></i> Utilizatori
            </button>
        </nav>

        <main class="content">
            <!-- Dashboard Tab -->
            <div id="dashboard" class="tab-content active">
                <div class="stats-grid">
                    <div class="stat-card blue">
                        <div class="icon"><i class="fas fa-wrench"></i></div>
                        <div class="number" id="totalLucrari">0</div>
                        <div class="label">Total LucrƒÉri</div>
                    </div>
                    <div class="stat-card green">
                        <div class="icon"><i class="fas fa-check-circle"></i></div>
                        <div class="number" id="lucrariFinalizate">0</div>
                        <div class="label">Finalizate</div>
                    </div>
                    <div class="stat-card orange">
                        <div class="icon"><i class="fas fa-clock"></i></div>
                        <div class="number" id="lucrariInLucru">0</div>
                        <div class="label">√én Lucru</div>
                    </div>
                    <div class="stat-card red">
                        <div class="icon"><i class="fas fa-users"></i></div>
                        <div class="number" id="totalClienti">0</div>
                        <div class="label">Clien»õi</div>
                    </div>
                </div>

                <div class="card">
                    <h3><i class="fas fa-chart-line"></i> Statistici Rapide</h3>
                    <div class="export-buttons">
                        <button class="export-pdf" onclick="exportToPDF()">
                            <i class="fas fa-file-pdf"></i> Export PDF
                        </button>
                        <button class="export-excel" onclick="exportToExcel()">
                            <i class="fas fa-file-excel"></i> Export Excel
                        </button>
                    </div>
                    <div id="dashboardStats"></div>
                </div>
            </div>

            <!-- LucrƒÉri Tab -->
            <div id="lucrari" class="tab-content">
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3><i class="fas fa-wrench"></i> Gestionare LucrƒÉri</h3>
                        <button class="btn admin-only" onclick="showAddLucrareModal()">
                            <i class="fas fa-plus"></i> AdaugƒÉ Lucrare
                        </button>
                    </div>
                    
                    <div class="search-filters">
                        <input type="text" id="searchLucrari" placeholder="CautƒÉ lucrƒÉri..." onkeyup="searchLucrari()">
                        <select id="filterStatus" onchange="filterLucrari()">
                            <option value="">Toate statusurile</option>
                            <option value="programat">Programat</option>
                            <option value="in-lucru">√én Lucru</option>
                            <option value="finalizat">Finalizat</option>
                            <option value="anulat">Anulat</option>
                        </select>
                        <select id="filterWorker" onchange="filterLucrari()">
                            <option value="">To»õi lucrƒÉtorii</option>
                        </select>
                    </div>
                    
                    <div id="lucrariList"></div>
                </div>
            </div>

            <!-- Clien»õi Tab -->
            <div id="clienti" class="tab-content">
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3><i class="fas fa-users"></i> Gestionare Clien»õi</h3>
                        <button class="btn admin-only" onclick="showAddClientModal()">
                            <i class="fas fa-plus"></i> AdaugƒÉ Client
                        </button>
                    </div>
                    
                    <div class="search-filters">
                        <input type="text" id="searchClienti" placeholder="CautƒÉ clien»õi..." onkeyup="searchClienti()">
                    </div>
                    
                    <div id="clientiList"></div>
                </div>
            </div>

            <!-- Servicii Tab -->
            <div id="servicii" class="tab-content">
                <div class="card">
                    <h3><i class="fas fa-database"></i> Baza de Date Servicii</h3>
                    <p>UrmƒÉre»ôte serviciile efectuate »ôi datele de expirare ale certificatelor.</p>
                    
                    <div class="service-tabs">
                        <button class="service-tab active" onclick="showServiceTab('active')">
                            <i class="fas fa-check-circle"></i> Active
                        </button>
                        <button class="service-tab" onclick="showServiceTab('expiring')">
                            <i class="fas fa-exclamation-triangle"></i> ExpirƒÉ √Æn 30 zile
                        </button>
                        <button class="service-tab" onclick="showServiceTab('expired')">
                            <i class="fas fa-times-circle"></i> Expirate
                        </button>
                    </div>
                    
                    <div class="search-filters">
                        <input type="text" id="searchServicii" placeholder="CautƒÉ servicii..." onkeyup="searchServicii()">
                        <select id="filterTipServiciu" onchange="filterServicii()">
                            <option value="">Toate tipurile</option>
                            <option value="Bran»ôament gaz">Bran»ôament gaz</option>
                            <option value="Instala»õie gaz">Instala»õie gaz</option>
                            <option value="Verificare tehnicƒÉ">Verificare tehnicƒÉ</option>
                            <option value="Repara»õie">Repara»õie</option>
                            <option value="Mentenan»õƒÉ">Mentenan»õƒÉ</option>
                        </select>
                    </div>
                    
                    <div id="serviciiList"></div>
                </div>
            </div>

            <!-- Program Zilnic Tab -->
            <div id="program" class="tab-content">
                <div class="card">
                    <h3><i class="fas fa-calendar-alt"></i> Program Zilnic</h3>
                    <p>VizualizeazƒÉ programul de lucru pentru astƒÉzi.</p>
                    
                    <div class="search-filters">
                        <input type="date" id="programDate" onchange="loadProgram()" value="">
                        <select id="filterProgramWorker" onchange="filterProgram()">
                            <option value="">To»õi lucrƒÉtorii</option>
                        </select>
                    </div>
                    
                    <div id="programList"></div>
                </div>
            </div>

            <!-- Documente Tab -->
            <div id="documente" class="tab-content">
                <div class="card">
                    <h3><i class="fas fa-file-alt"></i> Gestionare Documente</h3>
                    <p>Upload »ôi gestionare documente pentru lucrƒÉri.</p>
                    
                    <div class="file-upload" id="fileUpload">
                        <i class="fas fa-cloud-upload-alt" style="font-size: 3em; color: #3498db;"></i>
                        <p>Drag & drop files here or click to select</p>
                        <input type="file" id="fileInput" multiple style="display: none;">
                        <div class="form-group" style="margin-top: 15px;">
                            <select id="documentLucrareId">
                                <option value="">SelecteazƒÉ lucrarea</option>
                            </select>
                        </div>
                    </div>
                    
                    <div id="documentsList"></div>
                </div>
            </div>

            <!-- Utilizatori Tab -->
            <div id="utilizatori" class="tab-content admin-only">
                <div class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3><i class="fas fa-user-cog"></i> Gestionare Utilizatori</h3>
                        <button class="btn" onclick="showAddUserModal()">
                            <i class="fas fa-plus"></i> AdaugƒÉ Utilizator
                        </button>
                    </div>
                    
                    <div id="utilizatoriList"></div>
                </div>
            </div>
        </main>
    </div>

    <!-- Modals -->
    <!-- Lucrare Modal -->
    <div id="lucrareModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="lucrareModalTitle">AdaugƒÉ Lucrare</h2>
                <button class="close" onclick="closeLucrareModal()">&times;</button>
            </div>
            <form id="lucrareForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="lucrareClient">Client *</label>
                        <select id="lucrareClient" name="clientId" required>
                            <option value="">SelecteazƒÉ client</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="lucrareTipServiciu">Tip Serviciu *</label>
                        <select id="lucrareTipServiciu" name="tipServiciu" required>
                            <option value="">SelecteazƒÉ serviciu</option>
                            <option value="Bran»ôament gaz">Bran»ôament gaz</option>
                            <option value="Instala»õie gaz">Instala»õie gaz</option>
                            <option value="Verificare tehnicƒÉ">Verificare tehnicƒÉ</option>
                            <option value="Repara»õie">Repara»õie</option>
                            <option value="Mentenan»õƒÉ">Mentenan»õƒÉ</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="lucrareStatus">Status</label>
                        <select id="lucrareStatus" name="status">
                            <option value="programat">Programat</option>
                            <option value="in-lucru">√én Lucru</option>
                            <option value="finalizat">Finalizat</option>
                            <option value="anulat">Anulat</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="lucrareWorker">LucrƒÉtor Atribuit</label>
                        <select id="lucrareWorker" name="workerId">
                            <option value="">SelecteazƒÉ lucrƒÉtor</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="lucrareDataProgramata">Data ProgramatƒÉ</label>
                        <input type="date" id="lucrareDataProgramata" name="dataProgramata">
                    </div>
                    <div class="form-group">
                        <label for="lucrareDataFinalizare">Data Finalizare</label>
                        <input type="date" id="lucrareDataFinalizare" name="dataFinalizare">
                    </div>
                </div>
                <div class="form-group">
                    <label for="lucrareDescriere">Descriere *</label>
                    <textarea id="lucrareDescriere" name="descriere" rows="4" required></textarea>
                </div>
                <div class="form-group">
                    <label for="lucrareObservatii">Observa»õii</label>
                    <textarea id="lucrareObservatii" name="observatii" rows="3"></textarea>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <button type="submit" class="btn">SalveazƒÉ</button>
                    <button type="button" class="btn btn-danger" onclick="closeLucrareModal()">AnuleazƒÉ</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Client Modal -->
    <div id="clientModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="clientModalTitle">AdaugƒÉ Client</h2>
                <button class="close" onclick="closeClientModal()">&times;</button>
            </div>
            <form id="clientForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="clientNume">Nume *</label>
                        <input type="text" id="clientNume" name="nume" required>
                    </div>
                    <div class="form-group">
                        <label for="clientTelefon">Telefon *</label>
                        <input type="tel" id="clientTelefon" name="telefon" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="clientEmail">Email</label>
                    <input type="email" id="clientEmail" name="email">
                </div>
                <div class="form-group">
                    <label for="clientAdresa">Adresa *</label>
                    <textarea id="clientAdresa" name="adresa" rows="3" required></textarea>
                </div>
                <div class="form-group">
                    <label for="clientObservatii">Observa»õii</label>
                    <textarea id="clientObservatii" name="observatii" rows="3"></textarea>
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <button type="submit" class="btn">SalveazƒÉ</button>
                    <button type="button" class="btn btn-danger" onclick="closeClientModal()">AnuleazƒÉ</button>
                </div>
            </form>
        </div>
    </div>

    <!-- User Modal -->
    <div id="userModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="userModalTitle">AdaugƒÉ Utilizator</h2>
                <button class="close" onclick="closeUserModal()">&times;</button>
            </div>
            <form id="userForm">
                <div class="form-row">
                    <div class="form-group">
                        <label for="userNume">Nume *</label>
                        <input type="text" id="userNume" name="nume" required>
                    </div>
                    <div class="form-group">
                        <label for="userEmail">Email *</label>
                        <input type="email" id="userEmail" name="email" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="userPassword">ParolƒÉ *</label>
                        <input type="password" id="userPassword" name="password" required>
                    </div>
                    <div class="form-group">
                        <label for="userRol">Rol *</label>
                        <select id="userRol" name="rol" required>
                            <option value="lucrƒÉtor">LucrƒÉtor</option>
                            <option value="administrator">Administrator</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="userTelefon">Telefon</label>
                    <input type="tel" id="userTelefon" name="telefon">
                </div>
                <div style="text-align: center; margin-top: 20px;">
                    <button type="submit" class="btn">SalveazƒÉ</button>
                    <button type="button" class="btn btn-danger" onclick="closeUserModal()">AnuleazƒÉ</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Reset Demo Button -->
    <button class="reset-demo-btn" onclick="resetDemoData()">
        <i class="fas fa-redo-alt"></i> Reset Date Demo
    </button>

    <!-- Notification -->
    <div id="notification" class="notification"></div>

    <script>
        // Global variables
        let currentUser = null;
        let currentTab = 'dashboard';
        let editingId = null;
        let editingType = null;

        // Database arrays
        let utilizatoriDB = [];
        let clientiDB = [];
        let lucrariDB = [];
        let serviciiDB = [];
        let documenteDB = [];

        // Initialize demo data
        function initializeDemoData() {
            // Users
            utilizatoriDB = [
                {
                    id: 1,
                    nume: "Florin GavrilƒÉ",
                    email: "florin.gavrila@adinstalgaz.ro",
                    password: "123456",
                    rol: "administrator",
                    telefon: "0722123456",
                    dataCreare: "2024-01-15"
                },
                {
                    id: 2,
                    nume: "Ion Popescu",
                    email: "ion@adinstalgaz.ro",
                    password: "123456",
                    rol: "lucrƒÉtor",
                    telefon: "0733234567",
                    dataCreare: "2024-01-20"
                }
            ];

            // Clients
            clientiDB = [
                {
                    id: 1,
                    nume: "Maria Ionescu",
                    telefon: "0755123456",
                    email: "maria.ionescu@email.com",
                    adresa: "Str. LibertƒÉ»õii nr. 25, Alexandria, Teleorman",
                    observatii: "Client fidel",
                    dataCreare: "2024-01-10"
                },
                {
                    id: 2,
                    nume: "Gheorghe Popescu",
                    telefon: "0766234567",
                    email: "gheorghe.popescu@email.com",
                    adresa: "Str. Mihai Viteazu nr. 10, Turnu MƒÉgurele, Teleorman",
                    observatii: "Apartament bloc",
                    dataCreare: "2024-01-12"
                },
                {
                    id: 3,
                    nume: "Ana Dumitrescu",
                    telefon: "0777345678",
                    email: "ana.dumitrescu@email.com",
                    adresa: "Str. Victoriei nr. 5, Ro»ôiori de Vede, Teleorman",
                    observatii: "CasƒÉ individualƒÉ",
                    dataCreare: "2024-01-15"
                }
            ];

            // LucrƒÉri
            lucrariDB = [
                {
                    id: 1,
                    clientId: 1,
                    tipServiciu: "Bran»ôament gaz",
                    descriere: "Instalare bran»ôament gaz pentru casƒÉ nouƒÉ",
                    status: "finalizat",
                    workerId: 2,
                    dataProgramata: "2024-01-20",
                    dataFinalizare: "2024-01-22",
                    dataCreare: "2024-01-18",
                    observatii: "Lucrare finalizatƒÉ cu succes"
                },
                {
                    id: 2,
                    clientId: 2,
                    tipServiciu: "Verificare tehnicƒÉ",
                    descriere: "Verificare tehnicƒÉ anualƒÉ instala»õie gaz",
                    status: "programat",
                    workerId: 2,
                    dataProgramata: "2024-07-15",
                    dataFinalizare: "",
                    dataCreare: "2024-07-05",
                    observatii: "Programat pentru urmƒÉtoarea sƒÉptƒÉm√¢nƒÉ"
                },
                {
                    id: 3,
                    clientId: 3,
                    tipServiciu: "Instala»õie gaz",
                    descriere: "Instala»õie gaz pentru bucƒÉtƒÉrie nouƒÉ",
                    status: "in-lucru",
                    workerId: 2,
                    dataProgramata: "2024-07-08",
                    dataFinalizare: "",
                    dataCreare: "2024-07-01",
                    observatii: "√én curs de execu»õie"
                }
            ];

            // Servicii - generat automat din lucrƒÉri finalizate
            serviciiDB = [];
            lucrariDB.forEach(lucrare => {
                if (lucrare.status === 'finalizat' && lucrare.dataFinalizare) {
                    const client = clientiDB.find(c => c.id === lucrare.clientId);
                    if (client) {
                        // CalculeazƒÉ data de expirare (2 ani de la finalizare)
                        const dataFinalizare = new Date(lucrare.dataFinalizare);
                        const dataExpirare = new Date(dataFinalizare);
                        dataExpirare.setFullYear(dataExpirare.getFullYear() + 2);
                        
                        // VerificƒÉ dacƒÉ serviciul nu existƒÉ deja
                        const serviciiExistente = serviciiDB.filter(s => 
                            s.clientId === lucrare.clientId && 
                            s.tipServiciu === lucrare.tipServiciu &&
                            s.dataFinalizare === lucrare.dataFinalizare
                        );
                        
                        if (serviciiExistente.length === 0) {
                            serviciiDB.push({
                                id: Date.now() + Math.random(),
                                clientId: lucrare.clientId,
                                numeClient: client.nume,
                                telefon: client.telefon,
                                adresa: client.adresa,
                                tipServiciu: lucrare.tipServiciu,
                                dataFinalizare: lucrare.dataFinalizare,
                                dataExpirare: dataExpirare.toISOString().split('T')[0],
                                status: 'activ'
                            });
                        }
                    }
                }
            });

            // Documents
            documenteDB = [];

            // Save to localStorage
            localStorage.setItem('utilizatoriDB', JSON.stringify(utilizatoriDB));
            localStorage.setItem('clientiDB', JSON.stringify(clientiDB));
            localStorage.setItem('lucrariDB', JSON.stringify(lucrariDB));
            localStorage.setItem('serviciiDB', JSON.stringify(serviciiDB));
            localStorage.setItem('documenteDB', JSON.stringify(documenteDB));
        }

        // Load data from localStorage
        function loadData() {
            const storedUtilizatori = localStorage.getItem('utilizatoriDB');
            const storedClienti = localStorage.getItem('clientiDB');
            const storedLucrari = localStorage.getItem('lucrariDB');
            const storedServicii = localStorage.getItem('serviciiDB');
            const storedDocumente = localStorage.getItem('documenteDB');

            if (storedUtilizatori) utilizatoriDB = JSON.parse(storedUtilizatori);
            if (storedClienti) clientiDB = JSON.parse(storedClienti);
            if (storedLucrari) lucrariDB = JSON.parse(storedLucrari);
            if (storedServicii) serviciiDB = JSON.parse(storedServicii);
            if (storedDocumente) documenteDB = JSON.parse(storedDocumente);

            // If no data exists, initialize demo data
            if (!storedUtilizatori || !storedClienti || !storedLucrari) {
                initializeDemoData();
            }
        }

        // Reset demo data
        function resetDemoData() {
            if (confirm('Sigur dori»õi sƒÉ reseta»õi toate datele demo? AceastƒÉ ac»õiune nu poate fi anulatƒÉ.')) {
                // Clear localStorage
                localStorage.removeItem('utilizatoriDB');
                localStorage.removeItem('clientiDB');
                localStorage.removeItem('lucrariDB');
                localStorage.removeItem('serviciiDB');
                localStorage.removeItem('documenteDB');
                localStorage.removeItem('currentUser');

                // Reinitialize
                initializeDemoData();
                
                showNotification('Datele demo au fost resetate cu succes!');
                
                // Reload page after 2 seconds
                setTimeout(() => {
                    location.reload();
                }, 2000);
            }
        }

        // Authentication
        function login(email, password) {
            loadData();
            
            // Auto-correct roles if needed
            const user = utilizatoriDB.find(u => u.email === email);
            if (user && user.password === password) {
                // Auto-correct specific user roles
                if (user.email === 'florin.gavrila@adinstalgaz.ro') {
                    user.rol = 'administrator';
                } else if (user.email === 'ion@adinstalgaz.ro') {
                    user.rol = 'lucrƒÉtor';
                }
                
                // Save corrected data
                localStorage.setItem('utilizatoriDB', JSON.stringify(utilizatoriDB));
                
                currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                showNotification(`Bun venit, ${user.nume}! [${user.rol === 'administrator' ? 'Administrator (acces complet)' : 'LucrƒÉtor (acces limitat)'}]`);
                
                showApp();
                return true;
            }
            return false;
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('currentUser');
            showLogin();
        }

        function showLogin() {
            document.getElementById('loginScreen').style.display = 'flex';
            document.getElementById('appContainer').style.display = 'none';
        }

        function showApp() {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('appContainer').style.display = 'block';
            
            // Update user info
            document.getElementById('userName').textContent = currentUser.nume;
            const userRoleElement = document.getElementById('userRole');
            userRoleElement.textContent = currentUser.rol === 'administrator' ? 'ADMIN' : 'LucrƒÉtor';
            userRoleElement.className = currentUser.rol === 'administrator' ? 'user-badge' : 'user-badge worker';
            
            // Show/hide admin elements
            const adminElements = document.querySelectorAll('.admin-only');
            adminElements.forEach(el => {
                el.style.display = currentUser.rol === 'administrator' ? 'block' : 'none';
            });
            
            // Load initial data
            renderDashboard();
            loadSelectOptions();
        }

        // Check if user is logged in
        function checkAuth() {
            const storedUser = localStorage.getItem('currentUser');
            if (storedUser) {
                currentUser = JSON.parse(storedUser);
                showApp();
            } else {
                showLogin();
            }
        }

        // Tab management
        function showTab(tabName) {
            // Update active tab button
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Update active tab content
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            
            currentTab = tabName;
            
            // Load content based on tab
            switch(tabName) {
                case 'dashboard':
                    renderDashboard();
                    break;
                case 'lucrari':
                    renderLucrari();
                    break;
                case 'clienti':
                    renderClienti();
                    break;
                case 'servicii':
                    renderServicii();
                    break;
                case 'program':
                    renderProgram();
                    break;
                case 'documente':
                    renderDocumente();
                    break;
                case 'utilizatori':
                    renderUtilizatori();
                    break;
            }
        }

        // Dashboard functions
        function renderDashboard() {
            const totalLucrari = lucrariDB.length;
            const lucrariFinalizate = lucrariDB.filter(l => l.status === 'finalizat').length;
            const lucrariInLucru = lucrariDB.filter(l => l.status === 'in-lucru').length;
            const totalClienti = clientiDB.length;
            
            document.getElementById('totalLucrari').textContent = totalLucrari;
            document.getElementById('lucrariFinalizate').textContent = lucrariFinalizate;
            document.getElementById('lucrariInLucru').textContent = lucrariInLucru;
            document.getElementById('totalClienti').textContent = totalClienti;
            
            // Dashboard stats
            const statsContainer = document.getElementById('dashboardStats');
            statsContainer.innerHTML = `
                <div class="stats-details">
                    <h4>Statistici detaliate:</h4>
                    <p><strong>LucrƒÉri programate:</strong> ${lucrariDB.filter(l => l.status === 'programat').length}</p>
                    <p><strong>LucrƒÉri anulate:</strong> ${lucrariDB.filter(l => l.status === 'anulat').length}</p>
                    <p><strong>Servicii active:</strong> ${serviciiDB.filter(s => s.status === 'activ').length}</p>
                    <p><strong>Servicii care expirƒÉ √Æn 30 zile:</strong> ${getExpiringServices().length}</p>
                </div>
            `;
        }

        // LucrƒÉri functions
        function renderLucrari() {
            const lucrariContainer = document.getElementById('lucrariList');
            let filteredLucrari = lucrariDB;
            
            // Apply filters for workers
            if (currentUser.rol === 'lucrƒÉtor') {
                filteredLucrari = filteredLucrari.filter(l => l.workerId === currentUser.id);
            }
            
            if (filteredLucrari.length === 0) {
                lucrariContainer.innerHTML = '<p>Nu existƒÉ lucrƒÉri disponibile.</p>';
                return;
            }
            
            let html = '<table class="table"><thead><tr>';
            html += '<th>Client</th><th>Tip Serviciu</th><th>Status</th><th>Data ProgramatƒÉ</th><th>LucrƒÉtor</th><th>Ac»õiuni</th>';
            html += '</tr></thead><tbody>';
            
            filteredLucrari.forEach(lucrare => {
                const client = clientiDB.find(c => c.id === lucrare.clientId);
                const worker = utilizatoriDB.find(u => u.id === lucrare.workerId);
                
                html += `<tr>
                    <td>${client ? client.nume : 'Client necunoscut'}</td>
                    <td>${lucrare.tipServiciu}</td>
                    <td><span class="status-badge ${lucrare.status}">${lucrare.status}</span></td>
                    <td>${lucrare.dataProgramata || 'Nu este programatƒÉ'}</td>
                    <td>${worker ? worker.nume : 'Neatribuit'}</td>
                    <td>
                        <div class="action-buttons">
                            ${currentUser.rol === 'administrator' ? `
                                <button class="btn-edit" onclick="editLucrare(${lucrare.id})">
                                    <i class="fas fa-edit"></i> EditeazƒÉ
                                </button>
                                <button class="btn-delete" onclick="deleteLucrare(${lucrare.id})">
                                    <i class="fas fa-trash"></i> »òterge
                                </button>
                            ` : ''}
                            ${(currentUser.rol === 'lucrƒÉtor' && lucrare.workerId === currentUser.id) || currentUser.rol === 'administrator' ? `
                                <select onchange="updateStatusLucrare(${lucrare.id}, this.value)">
                                    <option value="${lucrare.status}">${lucrare.status}</option>
                                    ${lucrare.status !== 'programat' ? '<option value="programat">programat</option>' : ''}
                                    ${lucrare.status !== 'in-lucru' ? '<option value="in-lucru">in-lucru</option>' : ''}
                                    ${lucrare.status !== 'finalizat' ? '<option value="finalizat">finalizat</option>' : ''}
                                    ${lucrare.status !== 'anulat' ? '<option value="anulat">anulat</option>' : ''}
                                </select>
                            ` : ''}
                        </div>
                    </td>
                </tr>`;
            });
            
            html += '</tbody></table>';
            lucrariContainer.innerHTML = html;
        }

        function showAddLucrareModal() {
            document.getElementById('lucrareModalTitle').textContent = 'AdaugƒÉ Lucrare';
            document.getElementById('lucrareModal').style.display = 'block';
            resetLucrareForm();
        }

        function editLucrare(id) {
            const lucrare = lucrariDB.find(l => l.id === id);
            if (!lucrare) return;
            
            editingId = id;
            document.getElementById('lucrareModalTitle').textContent = 'EditeazƒÉ Lucrare';
            
            // Populate form
            document.getElementById('lucrareClient').value = lucrare.clientId;
            document.getElementById('lucrareTipServiciu').value = lucrare.tipServiciu;
            document.getElementById('lucrareStatus').value = lucrare.status;
            document.getElementById('lucrareWorker').value = lucrare.workerId || '';
            document.getElementById('lucrareDataProgramata').value = lucrare.dataProgramata || '';
            document.getElementById('lucrareDataFinalizare').value = lucrare.dataFinalizare || '';
            document.getElementById('lucrareDescriere').value = lucrare.descriere;
            document.getElementById('lucrareObservatii').value = lucrare.observatii || '';
            
            document.getElementById('lucrareModal').style.display = 'block';
        }

        function deleteLucrare(id) {
            if (confirm('Sigur dori»õi sƒÉ »ôterge»õi aceastƒÉ lucrare?')) {
                const index = lucrariDB.findIndex(l => l.id === id);
                if (index !== -1) {
                    lucrariDB.splice(index, 1);
                    localStorage.setItem('lucrariDB', JSON.stringify(lucrariDB));
                    renderLucrari();
                    renderDashboard();
                    showNotification('Lucrarea a fost »ôtearsƒÉ cu succes!');
                }
            }
        }

        function updateStatusLucrare(id, newStatus) {
            const lucrare = lucrariDB.find(l => l.id === id);
            if (!lucrare) return;
            
            const oldStatus = lucrare.status;
            lucrare.status = newStatus;
            
            // DacƒÉ se finalizeazƒÉ lucrarea, seteazƒÉ data de finalizare »ôi calculeazƒÉ expirarea
            if (newStatus === 'finalizat' && oldStatus !== 'finalizat') {
                lucrare.dataFinalizare = new Date().toISOString().split('T')[0];
                
                // AdaugƒÉ √Æn baza de date servicii
                const client = clientiDB.find(c => c.id === lucrare.clientId);
                if (client) {
                    const dataFinalizare = new Date(lucrare.dataFinalizare);
                    const dataExpirare = new Date(dataFinalizare);
                    dataExpirare.setFullYear(dataExpirare.getFullYear() + 2);
                    
                    // VerificƒÉ dacƒÉ serviciul nu existƒÉ deja
                    const serviciiExistente = serviciiDB.filter(s => 
                        s.clientId === lucrare.clientId && 
                        s.tipServiciu === lucrare.tipServiciu &&
                        s.dataFinalizare === lucrare.dataFinalizare
                    );
                    
                    if (serviciiExistente.length === 0) {
                        serviciiDB.push({
                            id: Date.now() + Math.random(),
                            clientId: lucrare.clientId,
                            numeClient: client.nume,
                            telefon: client.telefon,
                            adresa: client.adresa,
                            tipServiciu: lucrare.tipServiciu,
                            dataFinalizare: lucrare.dataFinalizare,
                            dataExpirare: dataExpirare.toISOString().split('T')[0],
                            status: 'activ'
                        });
                    }
                }
            }
            
            // SalveazƒÉ modificƒÉrile
            localStorage.setItem('lucrariDB', JSON.stringify(lucrariDB));
            localStorage.setItem('serviciiDB', JSON.stringify(serviciiDB));
            
            showNotification(`Status schimbat √Æn: ${newStatus}`);
            renderLucrari();
            renderDashboard();
        }

        function closeLucrareModal() {
            document.getElementById('lucrareModal').style.display = 'none';
            resetLucrareForm();
        }

        function resetLucrareForm() {
            document.getElementById('lucrareForm').reset();
            editingId = null;
        }

        // Clien»õi functions
        function renderClienti() {
            const clientiContainer = document.getElementById('clientiList');
            
            if (clientiDB.length === 0) {
                clientiContainer.innerHTML = '<p>Nu existƒÉ clien»õi √Ænregistra»õi.</p>';
                return;
            }
            
            let html = '<table class="table"><thead><tr>';
            html += '<th>Nume</th><th>Telefon</th><th>Email</th><th>Adresa</th><th>Ac»õiuni</th>';
            html += '</tr></thead><tbody>';
            
            clientiDB.forEach(client => {
                html += `<tr>
                    <td>${client.nume}</td>
                    <td>${client.telefon}</td>
                    <td>${client.email || 'Nu existƒÉ'}</td>
                    <td>${client.adresa}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn-edit" onclick="editClient(${client.id})">
                                <i class="fas fa-edit"></i> EditeazƒÉ
                            </button>
                            <button class="btn-delete" onclick="deleteClient(${client.id})">
                                <i class="fas fa-trash"></i> »òterge
                            </button>
                        </div>
                    </td>
                </tr>`;
            });
            
            html += '</tbody></table>';
            clientiContainer.innerHTML = html;
        }

        function showAddClientModal() {
            document.getElementById('clientModalTitle').textContent = 'AdaugƒÉ Client';
            document.getElementById('clientModal').style.display = 'block';
            resetClientForm();
        }

        function editClient(id) {
            const client = clientiDB.find(c => c.id === id);
            if (!client) return;
            
            editingId = id;
            document.getElementById('clientModalTitle').textContent = 'EditeazƒÉ Client';
            
            // Populate form
            document.getElementById('clientNume').value = client.nume;
            document.getElementById('clientTelefon').value = client.telefon;
            document.getElementById('clientEmail').value = client.email || '';
            document.getElementById('clientAdresa').value = client.adresa;
            document.getElementById('clientObservatii').value = client.observatii || '';
            
            document.getElementById('clientModal').style.display = 'block';
        }

        function deleteClient(id) {
            if (confirm('Sigur dori»õi sƒÉ »ôterge»õi acest client?')) {
                const index = clientiDB.findIndex(c => c.id === id);
                if (index !== -1) {
                    clientiDB.splice(index, 1);
                    localStorage.setItem('clientiDB', JSON.stringify(clientiDB));
                    renderClienti();
                    renderDashboard();
                    showNotification('Clientul a fost »ôters cu succes!');
                }
            }
        }

        function closeClientModal() {
            document.getElementById('clientModal').style.display = 'none';
            resetClientForm();
        }

        function resetClientForm() {
            document.getElementById('clientForm').reset();
            editingId = null;
        }

        // Servicii functions
        function renderServicii() {
            const serviciiContainer = document.getElementById('serviciiList');
            
            if (serviciiDB.length === 0) {
                serviciiContainer.innerHTML = '<p>Nu existƒÉ servicii √Ænregistrate.</p>';
                return;
            }
            
            let html = '<table class="table"><thead><tr>';
            html += '<th>Client</th><th>Tip Serviciu</th><th>Data Finalizare</th><th>Data Expirare</th><th>Status</th><th>Ac»õiuni</th>';
            html += '</tr></thead><tbody>';
            
            serviciiDB.forEach(serviciu => {
                const today = new Date();
                const expireDate = new Date(serviciu.dataExpirare);
                const daysToExpire = Math.ceil((expireDate - today) / (1000 * 60 * 60 * 24));
                
                let statusClass = 'activ';
                if (daysToExpire < 0) statusClass = 'expirat';
                else if (daysToExpire <= 30) statusClass = 'expira-curand';
                
                html += `<tr>
                    <td>${serviciu.numeClient}</td>
                    <td>${serviciu.tipServiciu}</td>
                    <td>${serviciu.dataFinalizare}</td>
                    <td>${serviciu.dataExpirare}</td>
                    <td><span class="status-badge ${statusClass}">${statusClass}</span></td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn-edit" onclick="contactClient('${serviciu.telefon}')">
                                <i class="fas fa-phone"></i> ContacteazƒÉ
                            </button>
                        </div>
                    </td>
                </tr>`;
            });
            
            html += '</tbody></table>';
            serviciiContainer.innerHTML = html;
        }

        function showServiceTab(tabType) {
            // Update active tab
            document.querySelectorAll('.service-tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');
            
            // Filter services based on tab
            const serviciiContainer = document.getElementById('serviciiList');
            let filteredServices = serviciiDB;
            
            const today = new Date();
            
            switch(tabType) {
                case 'active':
                    filteredServices = serviciiDB.filter(s => {
                        const expireDate = new Date(s.dataExpirare);
                        return expireDate > today;
                    });
                    break;
                case 'expiring':
                    filteredServices = serviciiDB.filter(s => {
                        const expireDate = new Date(s.dataExpirare);
                        const daysToExpire = Math.ceil((expireDate - today) / (1000 * 60 * 60 * 24));
                        return daysToExpire <= 30 && daysToExpire > 0;
                    });
                    break;
                case 'expired':
                    filteredServices = serviciiDB.filter(s => {
                        const expireDate = new Date(s.dataExpirare);
                        return expireDate < today;
                    });
                    break;
            }
            
            if (filteredServices.length === 0) {
                serviciiContainer.innerHTML = '<p>Nu existƒÉ servicii pentru aceastƒÉ categorie.</p>';
                return;
            }
            
            let html = '<table class="table"><thead><tr>';
            html += '<th>Client</th><th>Tip Serviciu</th><th>Data Finalizare</th><th>Data Expirare</th><th>Status</th><th>Ac»õiuni</th>';
            html += '</tr></thead><tbody>';
            
            filteredServices.forEach(serviciu => {
                const today = new Date();
                const expireDate = new Date(serviciu.dataExpirare);
                const daysToExpire = Math.ceil((expireDate - today) / (1000 * 60 * 60 * 24));
                
                let statusClass = 'activ';
                let statusText = 'Activ';
                if (daysToExpire < 0) {
                    statusClass = 'expirat';
                    statusText = 'Expirat';
                } else if (daysToExpire <= 30) {
                    statusClass = 'expira-curand';
                    statusText = `ExpirƒÉ √Æn ${daysToExpire} zile`;
                }
                
                html += `<tr>
                    <td>${serviciu.numeClient}</td>
                    <td>${serviciu.tipServiciu}</td>
                    <td>${serviciu.dataFinalizare}</td>
                    <td>${serviciu.dataExpirare}</td>
                    <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn-edit" onclick="contactClient('${serviciu.telefon}')">
                                <i class="fas fa-phone"></i> ContacteazƒÉ
                            </button>
                        </div>
                    </td>
                </tr>`;
            });
            
            html += '</tbody></table>';
            serviciiContainer.innerHTML = html;
        }

        function contactClient(telefon) {
            window.open(`tel:${telefon}`, '_blank');
        }

        function getExpiringServices() {
            const today = new Date();
            return serviciiDB.filter(s => {
                const expireDate = new Date(s.dataExpirare);
                const daysToExpire = Math.ceil((expireDate - today) / (1000 * 60 * 60 * 24));
                return daysToExpire <= 30 && daysToExpire > 0;
            });
        }

        // Program functions
        function renderProgram() {
            const programContainer = document.getElementById('programList');
            const today = new Date().toISOString().split('T')[0];
            
            // Set default date to today
            document.getElementById('programDate').value = today;
            
            let filteredLucrari = lucrariDB.filter(l => 
                l.dataProgramata === today && 
                (l.status === 'programat' || l.status === 'in-lucru')
            );
            
            // Apply worker filter if not admin
            if (currentUser.rol === 'lucrƒÉtor') {
                filteredLucrari = filteredLucrari.filter(l => l.workerId === currentUser.id);
            }
            
            if (filteredLucrari.length === 0) {
                programContainer.innerHTML = '<p>Nu existƒÉ lucrƒÉri programate pentru astƒÉzi.</p>';
                return;
            }
            
            let html = '<div class="program-grid">';
            
            filteredLucrari.forEach(lucrare => {
                const client = clientiDB.find(c => c.id === lucrare.clientId);
                const worker = utilizatoriDB.find(u => u.id === lucrare.workerId);
                
                html += `<div class="program-card">
                    <h4>${lucrare.tipServiciu}</h4>
                    <div class="program-time">
                        <i class="fas fa-calendar"></i> ${lucrare.dataProgramata}
                    </div>
                    <div class="program-client">
                        <i class="fas fa-user"></i> ${client ? client.nume : 'Client necunoscut'}
                    </div>
                    <div class="program-worker">
                        <i class="fas fa-user-hard-hat"></i> ${worker ? worker.nume : 'Neatribuit'}
                    </div>
                    <div class="program-description">
                        ${lucrare.descriere}
                    </div>
                    <div class="program-status">
                        <span class="status-badge ${lucrare.status}">${lucrare.status}</span>
                    </div>
                </div>`;
            });
            
            html += '</div>';
            programContainer.innerHTML = html;
        }

        function loadProgram() {
            const selectedDate = document.getElementById('programDate').value;
            const programContainer = document.getElementById('programList');
            
            let filteredLucrari = lucrariDB.filter(l => 
                l.dataProgramata === selectedDate && 
                (l.status === 'programat' || l.status === 'in-lucru')
            );
            
            // Apply worker filter if not admin
            if (currentUser.rol === 'lucrƒÉtor') {
                filteredLucrari = filteredLucrari.filter(l => l.workerId === currentUser.id);
            }
            
            if (filteredLucrari.length === 0) {
                programContainer.innerHTML = '<p>Nu existƒÉ lucrƒÉri programate pentru aceastƒÉ datƒÉ.</p>';
                return;
            }
            
            let html = '<div class="program-grid">';
            
            filteredLucrari.forEach(lucrare => {
                const client = clientiDB.find(c => c.id === lucrare.clientId);
                const worker = utilizatoriDB.find(u => u.id === lucrare.workerId);
                
                html += `<div class="program-card">
                    <h4>${lucrare.tipServiciu}</h4>
                    <div class="program-time">
                        <i class="fas fa-calendar"></i> ${lucrare.dataProgramata}
                    </div>
                    <div class="program-client">
                        <i class="fas fa-user"></i> ${client ? client.nume : 'Client necunoscut'}
                    </div>
                    <div class="program-worker">
                        <i class="fas fa-user-hard-hat"></i> ${worker ? worker.nume : 'Neatribuit'}
                    </div>
                    <div class="program-description">
                        ${lucrare.descriere}
                    </div>
                    <div class="program-status">
                        <span class="status-badge ${lucrare.status}">${lucrare.status}</span>
                    </div>
                </div>`;
            });
            
            html += '</div>';
            programContainer.innerHTML = html;
        }

        // Documente functions
        function renderDocumente() {
            const documenteContainer = document.getElementById('documentsList');
            
            if (documenteDB.length === 0) {
                documenteContainer.innerHTML = '<p>Nu existƒÉ documente √ÆncƒÉrcate.</p>';
                return;
            }
            
            let html = '<div class="file-list">';
            
            documenteDB.forEach(doc => {
                const lucrare = lucrariDB.find(l => l.id === doc.lucrareId);
                
                html += `<div class="file-item">
                    <div>
                        <strong>${doc.nume}</strong><br>
                        <small>Lucrare: ${lucrare ? lucrare.tipServiciu : 'NecunoscutƒÉ'}</small><br>
                        <small>√éncƒÉrcat: ${doc.dataIncarcare}</small>
                    </div>
                    <div>
                        <button onclick="downloadDocument(${doc.id})">
                            <i class="fas fa-download"></i> Download
                        </button>
                        <button onclick="deleteDocument(${doc.id})">
                            <i class="fas fa-trash"></i> »òterge
                        </button>
                    </div>
                </div>`;
            });
            
            html += '</div>';
            documenteContainer.innerHTML = html;
        }

        function downloadDocument(id) {
            const doc = documenteDB.find(d => d.id === id);
            if (doc) {
                // Create download link
                const link = document.createElement('a');
                link.href = doc.url;
                link.download = doc.nume;
                link.click();
            }
        }

        function deleteDocument(id) {
            if (confirm('Sigur dori»õi sƒÉ »ôterge»õi acest document?')) {
                const index = documenteDB.findIndex(d => d.id === id);
                if (index !== -1) {
                    documenteDB.splice(index, 1);
                    localStorage.setItem('documenteDB', JSON.stringify(documenteDB));
                    renderDocumente();
                    showNotification('Documentul a fost »ôters cu succes!');
                }
            }
        }

        // Utilizatori functions
        function renderUtilizatori() {
            const utilizatoriContainer = document.getElementById('utilizatoriList');
            
            if (utilizatoriDB.length === 0) {
                utilizatoriContainer.innerHTML = '<p>Nu existƒÉ utilizatori √Ænregistra»õi.</p>';
                return;
            }
            
            let html = '<table class="table"><thead><tr>';
            html += '<th>Nume</th><th>Email</th><th>Rol</th><th>Telefon</th><th>Ac»õiuni</th>';
            html += '</tr></thead><tbody>';
            
            utilizatoriDB.forEach(user => {
                html += `<tr>
                    <td>${user.nume}</td>
                    <td>${user.email}</td>
                    <td><span class="status-badge ${user.rol === 'administrator' ? 'finalizat' : 'programat'}">${user.rol}</span></td>
                    <td>${user.telefon || 'Nu existƒÉ'}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn-edit" onclick="editUser(${user.id})">
                                <i class="fas fa-edit"></i> EditeazƒÉ
                            </button>
                            ${user.id !== currentUser.id ? `
                                <button class="btn-delete" onclick="deleteUser(${user.id})">
                                    <i class="fas fa-trash"></i> »òterge
                                </button>
                            ` : ''}
                        </div>
                    </td>
                </tr>`;
            });
            
            html += '</tbody></table>';
            utilizatoriContainer.innerHTML = html;
        }

        function showAddUserModal() {
            document.getElementById('userModalTitle').textContent = 'AdaugƒÉ Utilizator';
            document.getElementById('userModal').style.display = 'block';
            resetUserForm();
        }

        function editUser(id) {
            const user = utilizatoriDB.find(u => u.id === id);
            if (!user) return;
            
            editingId = id;
            document.getElementById('userModalTitle').textContent = 'EditeazƒÉ Utilizator';
            
            // Populate form
            document.getElementById('userNume').value = user.nume;
            document.getElementById('userEmail').value = user.email;
            document.getElementById('userPassword').value = user.password;
            document.getElementById('userRol').value = user.rol;
            document.getElementById('userTelefon').value = user.telefon || '';
            
            document.getElementById('userModal').style.display = 'block';
        }

        function deleteUser(id) {
            if (confirm('Sigur dori»õi sƒÉ »ôterge»õi acest utilizator?')) {
                const index = utilizatoriDB.findIndex(u => u.id === id);
                if (index !== -1) {
                    utilizatoriDB.splice(index, 1);
                    localStorage.setItem('utilizatoriDB', JSON.stringify(utilizatoriDB));
                    renderUtilizatori();
                    showNotification('Utilizatorul a fost »ôters cu succes!');
                }
            }
        }

        function closeUserModal() {
            document.getElementById('userModal').style.display = 'none';
            resetUserForm();
        }

        function resetUserForm() {
            document.getElementById('userForm').reset();
            editingId = null;
        }

        // Form submissions
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const formData = new FormData(this);
            const email = formData.get('email');
            const password = formData.get('password');
            
            if (login(email, password)) {
                this.reset();
            } else {
                showNotification('Email sau parolƒÉ incorectƒÉ!', 'error');
            }
        });

        document.getElementById('lucrareForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const formData = new FormData(this);
            const lucrareData = Object.fromEntries(formData);
            
            // Converte»ôte ID-urile din string √Æn numƒÉr
            lucrareData.clientId = parseInt(lucrareData.clientId);
            lucrareData.workerId = lucrareData.workerId ? parseInt(lucrareData.workerId) : null;
            
            // Validare c√¢mpuri obligatorii
            if (!lucrareData.clientId || !lucrareData.tipServiciu || !lucrareData.descriere) {
                alert('Completa»õi toate c√¢mpurile obligatorii!');
                return;
            }

            // SalveazƒÉ lucrarea
            const lucrareDataObj = {
                ...lucrareData,
                id: editingId || Date.now(),
                dataCreare: editingId ? lucrariDB.find(l => l.id === editingId).dataCreare : new Date().toISOString().split('T')[0],
                dataFinalizare: lucrareData.status === 'finalizat' && !lucrareData.dataFinalizare ? new Date().toISOString().split('T')[0] : lucrareData.dataFinalizare
            };

            if (editingId) {
                const index = lucrariDB.findIndex(l => l.id === editingId);
                const oldStatus = lucrariDB[index].status;
                lucrariDB[index] = lucrareDataObj;
                
                // DacƒÉ statusul s-a schimbat √Æn "finalizat", calculeazƒÉ data de expirare
                if (oldStatus !== 'finalizat' && lucrareDataObj.status === 'finalizat') {
                    adaugaInServiciiDB(lucrareDataObj);
                }
            } else {
                lucrariDB.push(lucrareDataObj);
                
                // DacƒÉ lucrarea este finalizatƒÉ de la √Ænceput, adaugƒÉ √Æn servicii
                if (lucrareDataObj.status === 'finalizat') {
                    adaugaInServiciiDB(lucrareDataObj);
                }
            }

            // SalveazƒÉ √Æn localStorage
            localStorage.setItem('lucrariDB', JSON.stringify(lucrariDB));
            localStorage.setItem('serviciiDB', JSON.stringify(serviciiDB));

            showNotification('Lucrarea a fost salvatƒÉ cu succes!');
            document.getElementById('lucrareModal').style.display = 'none';
            renderLucrari();
            renderDashboard();
            resetLucrareForm();
            
            // Func»õie pentru adƒÉugarea √Æn baza de date servicii
            function adaugaInServiciiDB(lucrare) {
                const client = clientiDB.find(c => c.id === lucrare.clientId);
                if (!client) return;
                
                const dataFinalizare = new Date(lucrare.dataFinalizare);
                const dataExpirare = new Date(dataFinalizare);
                dataExpirare.setFullYear(dataExpirare.getFullYear() + 2);
                
                // VerificƒÉ dacƒÉ serviciul nu existƒÉ deja
                const serviciiExistente = serviciiDB.filter(s => 
                    s.clientId === lucrare.clientId && 
                    s.tipServiciu === lucrare.tipServiciu &&
                    s.dataFinalizare === lucrare.dataFinalizare
                );
                
                if (serviciiExistente.length === 0) {
                    serviciiDB.push({
                        id: Date.now() + Math.random(),
                        clientId: lucrare.clientId,
                        numeClient: client.nume,
                        telefon: client.telefon,
                        adresa: client.adresa,
                        tipServiciu: lucrare.tipServiciu,
                        dataFinalizare: lucrare.dataFinalizare,
                        dataExpirare: dataExpirare.toISOString().split('T')[0],
                        status: 'activ'
                    });
                }
            }
        });

        document.getElementById('clientForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const formData = new FormData(this);
            const clientData = Object.fromEntries(formData);
            
            if (editingId) {
                const index = clientiDB.findIndex(c => c.id === editingId);
                clientiDB[index] = { ...clientData, id: editingId };
            } else {
                clientiDB.push({
                    ...clientData,
                    id: Date.now(),
                    dataCreare: new Date().toISOString().split('T')[0]
                });
            }
            
            localStorage.setItem('clientiDB', JSON.stringify(clientiDB));
            showNotification('Clientul a fost salvat cu succes!');
            document.getElementById('clientModal').style.display = 'none';
            renderClienti();
            renderDashboard();
            resetClientForm();
        });

        document.getElementById('userForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const formData = new FormData(this);
            const userData = Object.fromEntries(formData);
            
            if (editingId) {
                const index = utilizatoriDB.findIndex(u => u.id === editingId);
                utilizatoriDB[index] = { ...userData, id: editingId };
            } else {
                userData.id = Date.now();
                userData.dataCreare = new Date().toISOString().split('T')[0];
                utilizatoriDB.push(userData);
            }
            
            localStorage.setItem('utilizatoriDB', JSON.stringify(utilizatoriDB));
            showNotification('Utilizatorul a fost salvat cu succes!');
            document.getElementById('userModal').style.display = 'none';
            renderUtilizatori();
            resetUserForm();
        });

        // Load select options
        function loadSelectOptions() {
            // Load clients for lucrare form
            const clientSelect = document.getElementById('lucrareClient');
            clientSelect.innerHTML = '<option value="">SelecteazƒÉ client</option>';
            clientiDB.forEach(client => {
                clientSelect.innerHTML += `<option value="${client.id}">${client.nume}</option>`;
            });
            
            // Load workers for lucrare form
            const workerSelect = document.getElementById('lucrareWorker');
            workerSelect.innerHTML = '<option value="">SelecteazƒÉ lucrƒÉtor</option>';
            utilizatoriDB.filter(u => u.rol === 'lucrƒÉtor').forEach(worker => {
                workerSelect.innerHTML += `<option value="${worker.id}">${worker.nume}</option>`;
            });
            
            // Load workers for filter
            const filterWorkerSelect = document.getElementById('filterWorker');
            filterWorkerSelect.innerHTML = '<option value="">To»õi lucrƒÉtorii</option>';
            utilizatoriDB.filter(u => u.rol === 'lucrƒÉtor').forEach(worker => {
                filterWorkerSelect.innerHTML += `<option value="${worker.id}">${worker.nume}</option>`;
            });
            
            // Load workers for program filter
            const programFilterWorkerSelect = document.getElementById('filterProgramWorker');
            programFilterWorkerSelect.innerHTML = '<option value="">To»õi lucrƒÉtorii</option>';
            utilizatoriDB.filter(u => u.rol === 'lucrƒÉtor').forEach(worker => {
                programFilterWorkerSelect.innerHTML += `<option value="${worker.id}">${worker.nume}</option>`;
            });
            
            // Load lucrari for documents
            const documentLucrareSelect = document.getElementById('documentLucrareId');
            documentLucrareSelect.innerHTML = '<option value="">SelecteazƒÉ lucrarea</option>';
            lucrariDB.forEach(lucrare => {
                const client = clientiDB.find(c => c.id === lucrare.clientId);
                documentLucrareSelect.innerHTML += `<option value="${lucrare.id}">${lucrare.tipServiciu} - ${client ? client.nume : 'Client necunoscut'}</option>`;
            });
        }

        // Search and filter functions
        function searchLucrari() {
            const searchTerm = document.getElementById('searchLucrari').value.toLowerCase();
            const rows = document.querySelectorAll('#lucrariList tbody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }

        function filterLucrari() {
            const statusFilter = document.getElementById('filterStatus').value;
            const workerFilter = document.getElementById('filterWorker').value;
            
            renderLucrari(); // Re-render with filters
        }

        function searchClienti() {
            const searchTerm = document.getElementById('searchClienti').value.toLowerCase();
            const rows = document.querySelectorAll('#clientiList tbody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }

        function searchServicii() {
            const searchTerm = document.getElementById('searchServicii').value.toLowerCase();
            const rows = document.querySelectorAll('#serviciiList tbody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }

        function filterServicii() {
            const tipFilter = document.getElementById('filterTipServiciu').value;
            const rows = document.querySelectorAll('#serviciiList tbody tr');
            
            rows.forEach(row => {
                const tipCell = row.children[1]; // Tip Serviciu column
                const tipText = tipCell.textContent;
                row.style.display = (!tipFilter || tipText === tipFilter) ? '' : 'none';
            });
        }

        function filterProgram() {
            const workerFilter = document.getElementById('filterProgramWorker').value;
            loadProgram(); // Re-render with filters
        }

        // Export functions
        function exportToPDF() {
            showNotification('Func»õia de export PDF va fi implementatƒÉ √Æn cur√¢nd!');
        }

        function exportToExcel() {
            showNotification('Func»õia de export Excel va fi implementatƒÉ √Æn cur√¢nd!');
        }

        // File upload functions
        document.getElementById('fileUpload').addEventListener('click', function() {
            document.getElementById('fileInput').click();
        });

        document.getElementById('fileInput').addEventListener('change', function(e) {
            const files = e.target.files;
            const lucrareId = document.getElementById('documentLucrareId').value;
            
            if (!lucrareId) {
                alert('Selecta»õi o lucrare √Ænainte de a √ÆncƒÉrca documente!');
                return;
            }
            
            Array.from(files).forEach(file => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const document = {
                        id: Date.now() + Math.random(),
                        lucrareId: parseInt(lucrareId),
                        nume: file.name,
                        tip: file.type,
                        dimensiune: file.size,
                        url: e.target.result,
                        dataIncarcare: new Date().toISOString().split('T')[0]
                    };
                    
                    documenteDB.push(document);
                    localStorage.setItem('documenteDB', JSON.stringify(documenteDB));
                    renderDocumente();
                    showNotification(`Document ${file.name} √ÆncƒÉrcat cu succes!`);
                };
                reader.readAsDataURL(file);
            });
        });

        // Drag and drop
        const fileUpload = document.getElementById('fileUpload');
        fileUpload.addEventListener('dragover', function(e) {
            e.preventDefault();
            this.classList.add('dragover');
        });

        fileUpload.addEventListener('dragleave', function(e) {
            e.preventDefault();
            this.classList.remove('dragover');
        });

        fileUpload.addEventListener('drop', function(e) {
            e.preventDefault();
            this.classList.remove('dragover');
            
            const files = e.dataTransfer.files;
            const lucrareId = document.getElementById('documentLucrareId').value;
            
            if (!lucrareId) {
                alert('Selecta»õi o lucrare √Ænainte de a √ÆncƒÉrca documente!');
                return;
            }
            
            Array.from(files).forEach(file => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const document = {
                        id: Date.now() + Math.random(),
                        lucrareId: parseInt(lucrareId),
                        nume: file.name,
                        tip: file.type,
                        dimensiune: file.size,
                        url: e.target.result,
                        dataIncarcare: new Date().toISOString().split('T')[0]
                    };
                    
                    documenteDB.push(document);
                    localStorage.setItem('documenteDB', JSON.stringify(documenteDB));
                    renderDocumente();
                    showNotification(`Document ${file.name} √ÆncƒÉrcat cu succes!`);
                };
                reader.readAsDataURL(file);
            });
        });

        // Notification function
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            checkAuth();
        });
    </script>
</body>
</html>
