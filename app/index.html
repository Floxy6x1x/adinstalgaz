<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GazTech Services - AplicaÈ›ie Gestionare AbonaÈ›i</title>
    <meta name="description" content="AplicaÈ›ie profesionalÄƒ pentru gestionarea abonaÈ›ilor È™i reviziilor GazTech Services">
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="GazTech Services">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIkdhelRlY2ggU2VydmljZXMiLAogICJzaG9ydF9uYW1lIjogIkdhelRlY2giLAogICJkZXNjcmlwdGlvbiI6ICJBcGxpY2F0aWUgcHJvZmVzaW9uYWxhIHBlbnRydSBnZXN0aW9uYXJlYSBhYm9uYXRpbG9yIiwKICAic3RhcnRfdXJsIjogIi8iLAogICJkaXNwbGF5IjogInN0YW5kYWxvbmUiLAogICJiYWNrZ3JvdW5kX2NvbG9yIjogIiNmZmZmZmYiLAogICJ0aGVtZV9jb2xvciI6ICIjNjY3ZWVhIiwKICAiaWNvbnMiOiBbCiAgICB7CiAgICAgICJzcmMiOiAiZGF0YTppbWFnZS9zdmcreG1sO2Jhc2U2NCxQSE4yWnlCNGJXeHVjejBpYUhSMGNEb3ZMM2QzZHk1M00zVnZjbWN2TWpBd01DOXpkbWNpSUhacFpYZENiM2c5SWpBZ01DQXhNREFnTVRBd0lpQm1hV3hzUFNJalEyWkNPU0krUEhKbFkzUWdlRDBpTVRBaUlIazlJakV3SWlCM2FXUjBhRDBpT0RBaUlHaGxhV2RvZEQwaU9EQWlJSEo0UFNJMElpQm1hV3hzUFNJalpEQTVOakl6SW02OGZpQThMM0psWTNRK1BIUmxlSFFnZUQwaU5UQWlJSGs5SWpNMUlpQjBaWGgwTFdGdVkyaHZjajBpYldsa1pHeGxJaUJtYjI1MExXWmhiV2xzZVQwaWMyRnVjeTF6WlhKcFppSWdZMnh2Y2owaUkyWm1abVptWmlJZ1ptOXVkQzF6YVhwbFBTSXhPVGRKVWlJK1F6d3ZkR1Y0ZEQ0OEwzTjJaejQ9IiwKICAgICAgInNpemVzIjogIjEwMHgxMDAiLAogICAgICAidHlwZSI6ICJpbWFnZS9zdmcreG1sIgogICAgfQogIF0KfQ==">
    
    <!-- Icons -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMDAgMTAwIiBmaWxsPSIjNjY3ZWVhIj4KPHJlY3QgeD0iMTAiIHk9IjEwIiB3aWR0aD0iODAiIGhlaWdodD0iODAiIHJ4PSI0IiBmaWxsPSIjZDA5NjIzIi8+Cjx0ZXh0IHg9IjUwIiB5PSIzNSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGNvbG9yPSIjZmZmZmZmIiBmb250LXNpemU9IjE5cHgiPkc8L3RleHQ+CjwvbW9yPgo+">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-functions-compat.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            padding: 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            height: 70px;
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            color: #4a5568;
            text-decoration: none;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 40px;
            align-items: center;
        }

        .nav-item {
            position: relative;
        }

        .nav-link {
            text-decoration: none;
            color: #4a5568;
            font-weight: 500;
            font-size: 15px;
            padding: 10px 0;
            transition: all 0.3s ease;
            position: relative;
            cursor: pointer;
        }

        .nav-link:hover {
            color: #667eea;
        }

        .nav-link::after {
            content: '';
            position: absolute;
            bottom: 5px;
            left: 0;
            width: 0;
            height: 2px;
            background: #667eea;
            transition: width 0.3s ease;
        }

        .nav-link:hover::after {
            width: 100%;
        }

        .nav-link.active {
            color: #667eea;
        }

        .nav-link.active::after {
            width: 100%;
        }

        .mobile-menu-btn {
            display: none;
            background: none;
            border: none;
            font-size: 24px;
            color: #4a5568;
            cursor: pointer;
        }

        .main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .section {
            display: none;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
            animation: fadeInUp 0.5s ease-out;
        }

        .section.active {
            display: block;
        }

        .section-title {
            font-size: 32px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 30px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .section-separator {
            height: 3px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 50px;
            margin: 40px 0;
            position: relative;
        }

        .section-separator::after {
            content: '';
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            border: 3px solid #667eea;
        }

        .alerts-section {
            margin-bottom: 30px;
        }

        .lists-section {
            margin-bottom: 40px;
        }

        .forms-section {
            margin-top: 40px;
        }

        .form-container {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-label {
            font-weight: 600;
            color: #4a5568;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .form-input, .form-select {
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s ease;
            background: white;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-select {
            cursor: pointer;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #e2e8f0;
            color: #4a5568;
        }

        .btn-secondary:hover {
            background: #cbd5e0;
        }

        .btn-danger {
            background: #f56565;
            color: white;
        }

        .btn-danger:hover {
            background: #e53e3e;
            transform: translateY(-2px);
        }

        .btn-success {
            background: #48bb78;
            color: white;
        }

        .btn-success:hover {
            background: #38a169;
            transform: translateY(-2px);
        }

        .btn-warning {
            background: #ed8936;
            color: white;
        }

        .btn-warning:hover {
            background: #dd6b20;
            transform: translateY(-2px);
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            font-size: 13px;
        }

        .data-table th {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 12px 8px;
            text-align: left;
            font-weight: 600;
            font-size: 12px;
        }

        .data-table td {
            padding: 12px 8px;
            border-bottom: 1px solid #e2e8f0;
            color: #4a5568;
        }

        .data-table tr:hover {
            background: #f7fafc;
        }

        .data-table tr:last-child td {
            border-bottom: none;
        }

        .status-badge {
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-active {
            background: #c6f6d5;
            color: #22543d;
        }

        .status-inactive {
            background: #fed7d7;
            color: #742a2a;
        }

        .status-pending {
            background: #fef5e7;
            color: #744210;
        }

        .status-urgent {
            background: #fbb6ce;
            color: #97266d;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #718096;
        }

        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .action-buttons {
            display: flex;
            gap: 8px;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 12px;
        }

        .search-container {
            margin-bottom: 20px;
        }

        .search-input {
            width: 100%;
            max-width: 400px;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
        }

        .search-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .address-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
        }

        .client-type-container {
            background: #f7fafc;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .revizie-container {
            background: #e6fffa;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #38b2ac;
        }

        .servicii-container {
            background: #faf5ff;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #9f7aea;
        }

        .form-section-title {
            font-size: 18px;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .checkbox-item input[type="checkbox"] {
            transform: scale(1.2);
            accent-color: #667eea;
        }

        .oferta-speciala {
            background: linear-gradient(135deg, #fef5e7, #fed7aa);
            padding: 12px;
            border-radius: 8px;
            border: 2px solid #f6ad55;
            animation: pulse-offer 3s infinite;
        }

        .oferta-speciala label {
            color: #c05621 !important;
            font-size: 15px;
        }

        .file-upload-area {
            border: 2px dashed #cbd5e0;
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            background: #f7fafc;
            transition: all 0.3s ease;
            margin-top: 15px;
            cursor: pointer;
        }

        .file-upload-area:hover {
            border-color: #667eea;
            background: #edf2f7;
        }

        .file-upload-area.dragover {
            border-color: #667eea;
            background: #e6fffa;
        }

        .file-list {
            margin-top: 15px;
        }

        .file-item {
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .file-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .file-icon {
            font-size: 20px;
        }

        .file-details {
            display: flex;
            flex-direction: column;
        }

        .file-name {
            font-weight: 600;
            color: #2d3748;
        }

        .file-size {
            font-size: 12px;
            color: #718096;
        }

        .date-range-container {
            background: #fff5f5;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #f56565;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 16px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e2e8f0;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 700;
            color: #2d3748;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            color: #a0aec0;
            transition: color 0.3s ease;
        }

        .close-modal:hover {
            color: #2d3748;
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-weight: 500;
        }

        .alert-warning {
            background: #fef5e7;
            color: #744210;
            border-left: 4px solid #ed8936;
        }

        .alert-danger {
            background: #fed7d7;
            color: #742a2a;
            border-left: 4px solid #f56565;
        }

        .alert-info {
            background: #ebf8ff;
            color: #2a4365;
            border-left: 4px solid #4299e1;
        }

        .alert-success {
            background: #f0fff4;
            color: #22543d;
            border-left: 4px solid #38a169;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .mobile-menu-btn {
                display: block;
            }

            .nav-menu {
                position: fixed;
                top: 70px;
                left: -100%;
                width: 100%;
                height: calc(100vh - 70px);
                background: rgba(255, 255, 255, 0.95);
                backdrop-filter: blur(10px);
                flex-direction: column;
                justify-content: flex-start;
                padding-top: 50px;
                gap: 30px;
                transition: left 0.3s ease;
            }

            .nav-menu.active {
                left: 0;
            }

            .nav-link {
                font-size: 18px;
                padding: 15px 0;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .address-grid {
                grid-template-columns: 1fr;
            }

            .data-table {
                font-size: 11px;
            }

            .data-table th,
            .data-table td {
                padding: 6px 4px;
            }

            .action-buttons {
                flex-direction: column;
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .notification {
            position: fixed;
            top: 90px;
            right: 20px;
            padding: 16px 24px;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            z-index: 1001;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            max-width: 400px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: #48bb78;
        }

        .notification.error {
            background: #f56565;
        }

        .notification.warning {
            background: #ed8936;
        }

        .notification.info {
            background: #4299e1;
        }

        .urgent-reminder {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes pulse-offer {
            0%, 100% { box-shadow: 0 0 0 0 rgba(246, 173, 85, 0.4); }
            50% { box-shadow: 0 0 0 10px rgba(246, 173, 85, 0); }
        }

        .sync-indicator {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #48bb78;
            color: white;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .sync-indicator.show {
            opacity: 1;
            transform: translateY(0);
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="nav-container">
            <a href="#" class="logo">ğŸ”§ GazTech Services</a>
            
            <nav>
                <ul class="nav-menu" id="navMenu">
                    <li class="nav-item">
                        <a href="#" class="nav-link active" data-section="dashboard">Dashboard</a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-section="abonati">AbonaÈ›i</a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-section="programari">ProgramÄƒri</a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-section="remindere">Remindere</a>
                    </li>
                    <li class="nav-item">
                        <a href="#" class="nav-link" data-section="rapoarte">Rapoarte</a>
                    </li>
                </ul>
            </nav>

            <button class="mobile-menu-btn" id="mobileMenuBtn">â˜°</button>
        </div>
    </header>

    <main class="main-content">
        <!-- Dashboard Section -->
        <section id="dashboard" class="section active">
            <h1 class="section-title">ğŸ“Š Dashboard</h1>
            
            <div class="alerts-section">
                <div id="alerteUrgente"></div>
            </div>
            
            <div class="form-grid">
                <div class="form-container">
                    <h3 style="color: #4a5568; margin-bottom: 15px;">ğŸ“ˆ Statistici Rapide</h3>
                    <p style="color: #718096;">Total AbonaÈ›i: <strong id="totalAbonati">0</strong></p>
                    <p style="color: #718096;">ProgramÄƒri AstÄƒzi: <strong id="programariAstazi">0</strong></p>
                    <p style="color: #718096;">Remindere Active: <strong id="remindereActive">0</strong></p>
                    <p style="color: #718096;">Revizii Ã®n 7 zile: <strong id="reviziiSaptamana">0</strong></p>
                </div>
                <div class="form-container">
                    <h3 style="color: #4a5568; margin-bottom: 15px;">âš¡ AcÈ›iuni Rapide</h3>
                    <button class="btn btn-primary" onclick="showSection('abonati')" style="margin-bottom: 10px; width: 100%;">AdaugÄƒ Abonat</button>
                    <button class="btn btn-secondary" onclick="showSection('programari')" style="margin-bottom: 10px; width: 100%;">Programare NouÄƒ</button>
                    <button class="btn btn-secondary" onclick="sincronizareAvansata()" style="margin-bottom: 10px; width: 100%;">ğŸ”„ Sincronizare AvansatÄƒ</button>
                    <button class="btn btn-secondary" onclick="creeazaBackup()" style="width: 100%;">ğŸ’¾ Backup Date</button>
                </div>
                <div class="form-container">
                    <h3 style="color: #4a5568; margin-bottom: 15px;">ğŸ“± NotificÄƒri & Firebase</h3>
                    <button class="btn btn-primary" onclick="verificaNotificariAutomated()" style="margin-bottom: 10px; width: 100%;">ğŸ“± VerificÄƒ NotificÄƒri</button>
                    <button class="btn btn-secondary" onclick="sincronizareCuFirestore()" style="margin-bottom: 10px; width: 100%;">ğŸ”¥ Sync Firebase</button>
                    <button class="btn btn-secondary" onclick="trimiteNotificariInMasa()" style="margin-bottom: 10px; width: 100%;">ğŸ“¢ NotificÄƒri Ã®n MasÄƒ</button>
                    <button class="btn btn-success" onclick="testeazaWhatsApp()" style="margin-bottom: 10px; width: 100%; background: #25d366; color: white;">ğŸ’¬ Test WhatsApp</button>
                    <div style="margin-top: 10px; padding: 10px; background: #f0fff4; border-radius: 6px; border-left: 3px solid #38a169;">
                        <small style="color: #22543d;">Firebase: <span id="firebaseStatus">Verificare...</span></small><br>
                        <small style="color: #22543d;">Telefon firmÄƒ: <strong id="telefonFirma">0762614402</strong></small><br>
                        <small style="color: #22543d;">WhatsApp: <strong>Activ âœ…</strong></small>
                    </div>
                </div>
            </div>

            <!-- SecÈ›iune pentru preview mesaje -->
            <div class="form-container" style="margin-top: 30px;">
                <h3 style="color: #4a5568; margin-bottom: 15px;">ğŸ“‹ Exemple Mesaje SMS & WhatsApp</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px;">
                    <div style="background: #f7fafc; padding: 15px; border-radius: 8px; border-left: 4px solid #4299e1;">
                        <h4 style="color: #2b6cb0; margin-bottom: 10px;">ğŸ”” Expirare Revizie</h4>
                        <div style="background: white; padding: 10px; border-radius: 6px; font-size: 13px; color: #4a5568; white-space: pre-line;">${messageTemplates.expirareRevizie('Popescu Ion', '7', 'Verificare InstalaÈ›ie Gaz')}</div>
                    </div>
                    <div style="background: #fef5e7; padding: 15px; border-radius: 8px; border-left: 4px solid #ed8936;">
                        <h4 style="color: #c05621; margin-bottom: 10px;">ğŸ’° PlatÄƒ PendentÄƒ</h4>
                        <div style="background: white; padding: 10px; border-radius: 6px; font-size: 13px; color: #4a5568; white-space: pre-line;">${messageTemplates.plataPendenta('Ionescu Maria', '250', 'Revizie InstalaÈ›ie Gaz')}</div>
                    </div>
                    <div style="background: #f0fff4; padding: 15px; border-radius: 8px; border-left: 4px solid #38a169;">
                        <h4 style="color: #22543d; margin-bottom: 10px;">âœ… Confirmare Programare</h4>
                        <div style="background: white; padding: 10px; border-radius: 6px; font-size: 13px; color: #4a5568; white-space: pre-line;">${messageTemplates.confirmareProgramare('Georgescu Andrei', '15.12.2024 10:00', 'Verificare CentralÄƒ', 'Alexandria, Str. LibertÄƒÈ›ii 12')}</div>
                    </div>
                    <div style="background: #fed7d7; padding: 15px; border-radius: 8px; border-left: 4px solid #f56565;">
                        <h4 style="color: #742a2a; margin-bottom: 10px;">ğŸš¨ ProblemÄƒ TehnicÄƒ (WhatsApp)</h4>
                        <div style="background: white; padding: 10px; border-radius: 6px; font-size: 13px; color: #4a5568; white-space: pre-line;">ğŸš¨ ATENÈšIE - ${CONFIGURARI_FIRMA.nume}

BunÄƒ ziua Popescu Ion!

Am fost notificaÈ›i despre urmÄƒtoarea problemÄƒ:
âš ï¸ ScÄƒpare de gaz

ğŸ”§ VÄƒ rugÄƒm sÄƒ:
â€¢ Nu folosiÈ›i instalaÈ›ia pÃ¢nÄƒ la verificare
â€¢ AerisiÈ›i Ã®ncÄƒperea
â€¢ SunaÈ›i URGENT la ${CONFIGURARI_FIRMA.telefon}

${CONFIGURARI_FIRMA.nume} - IntervenÈ›ie RapidÄƒ</div>
                    </div>
                </div>
                <div style="margin-top: 15px; padding: 15px; background: #ebf8ff; border-radius: 8px; border-left: 4px solid #4299e1;">
                    <p style="color: #2a4365; margin: 0;"><strong>ğŸ¯ Cum funcÈ›ioneazÄƒ:</strong></p>
                    <p style="color: #2a4365; margin: 5px 0 0 0;">â€¢ <strong>ğŸ“± SMS</strong> â†’ mesaj simulat (vezi Ã®n consolÄƒ F12)</p>
                    <p style="color: #2a4365; margin: 5px 0 0 0;">â€¢ <strong>ğŸ’¬ WhatsApp</strong> â†’ deschide WhatsApp Web cu mesajul pregÄƒtit</p>
                    <p style="color: #2a4365; margin: 5px 0 0 0;">â€¢ <strong>Probleme urgente</strong> â†’ trimite automat pe WhatsApp</p>
                    <p style="color: #2a4365; margin: 5px 0 0 0;">â€¢ <strong>Test WhatsApp</strong> â†’ butonul "ğŸ’¬ Test WhatsApp" Ã®n dashboard</p>
                </div>
            </div>
        </section>

        <!-- AbonaÈ›i Section -->
        <section id="abonati" class="section">
            <h1 class="section-title">ğŸ‘¥ Gestionare AbonaÈ›i</h1>
            
            <!-- Alerts Section -->
            <div class="alerts-section">
                <div id="alerteAbonati"></div>
                
                <!-- AlertÄƒ pentru notificÄƒri -->
                <div class="alert alert-info" style="border-left: 4px solid #4299e1;">
                    <strong>ğŸ“± NotificÄƒri Profesionale Active!</strong><br>
                    â€¢ <strong>ğŸ“± SMS:</strong> Click pe ğŸ“± SMS pentru notificÄƒri expirÄƒri/plÄƒÈ›i<br>
                    â€¢ <strong>ğŸ’¬ WhatsApp:</strong> Click pe ğŸ’¬ WA pentru mesaje business instant<br>
                    â€¢ <strong>ğŸš¨ Automat:</strong> WhatsApp pentru revizii expirate (urgent)<br>
                    â€¢ <strong>Telefon firmÄƒ:</strong> <span id="telefonAlert1">0762614402</span> (Ã®n toate mesajele)
                </div>
            </div>

            <!-- Lists Section -->
            <div class="lists-section">
                <div class="search-container">
                    <input type="text" class="search-input" id="searchAbonati" placeholder="ğŸ” CautÄƒ abonaÈ›i...">
                </div>

                <div id="listaAbonati">
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ‘¥</div>
                        <h3>Nu existÄƒ abonaÈ›i Ã®nregistraÈ›i</h3>
                        <p>AdaugÄƒ primul abonat folosind formularul de mai jos.</p>
                    </div>
                </div>
            </div>

            <!-- Separator -->
            <div class="section-separator"></div>

            <!-- Forms Section -->
            <div class="forms-section">
                <div class="form-container">
                    <h3 style="color: #4a5568; margin-bottom: 20px;">â• AdaugÄƒ Abonat Nou</h3>
                    
                    <div class="client-type-container">
                        <div class="form-section-title">ğŸ‘¤ Tip Client</div>
                        <div class="form-group">
                            <select class="form-select" id="tipClient">
                                <option value="">SelecteazÄƒ tipul clientului</option>
                                <option value="nou">Client Nou</option>
                                <option value="actual">Client Actual</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-section-title">ğŸ“ Date Personale</div>
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Nume Complet *</label>
                            <input type="text" class="form-input" id="numeAbonat" placeholder="IntroduceÈ›i numele complet" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Telefon *</label>
                            <input type="tel" class="form-input" id="telefonAbonat" placeholder="0721234567" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Email</label>
                            <input type="email" class="form-input" id="emailAbonat" placeholder="email@exemplu.ro">
                        </div>
                        <div class="form-group">
                            <label class="form-label">CNP</label>
                            <input type="text" class="form-input" id="cnpAbonat" placeholder="1234567890123">
                        </div>
                    </div>

                    <div class="form-section-title">ğŸ“ AdresÄƒ CompletÄƒ</div>
                    <div class="address-grid">
                        <div class="form-group">
                            <label class="form-label">OraÈ™ *</label>
                            <select class="form-select" id="orasAbonat" required>
                                <option value="">SelecteazÄƒ oraÈ™ul</option>
                                <option value="RoÈ™iorii de Vede">RoÈ™iorii de Vede</option>
                                <option value="Alexandria">Alexandria</option>
                                <option value="Turnu MÄƒgurele">Turnu MÄƒgurele</option>
                                <option value="Videle">Videle</option>
                                <option value="Zimnicea">Zimnicea</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Strada</label>
                            <input type="text" class="form-input" id="stradaAbonat" placeholder="Str. Exemplu">
                        </div>
                        <div class="form-group">
                            <label class="form-label">NumÄƒrul</label>
                            <input type="text" class="form-input" id="numarAbonat" placeholder="Nr. 123">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Tip LocuinÈ›Äƒ</label>
                            <select class="form-select" id="tipAdresa">
                                <option value="">SelecteazÄƒ tipul</option>
                                <option value="Casa">CasÄƒ</option>
                                <option value="Bloc">Bloc</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Bloc (ex: Bl. 413, K1)</label>
                            <input type="text" class="form-input" id="numeBlocAbonat" placeholder="Bl. 413, K1, etc.">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Scara</label>
                            <input type="text" class="form-input" id="scaraAbonat" placeholder="A, B, C...">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Etaj</label>
                            <input type="text" class="form-input" id="etajAbonat" placeholder="1, 2, 3...">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Apartament</label>
                            <input type="text" class="form-input" id="apartamentAbonat" placeholder="12, 34...">
                        </div>
                    </div>

                    <div class="servicii-container">
                        <div class="form-section-title">ğŸ› ï¸ Servicii Contractate cu PreÈ›uri</div>
                        <div class="checkbox-group">
                            <div class="checkbox-item">
                                <input type="checkbox" id="serviciu_verificare_gaz" value="Verificare InstalaÈ›ie Gaz">
                                <label for="serviciu_verificare_gaz">Verificare InstalaÈ›ie Gaz - <strong>150 Lei</strong> <small>(valabilitate 2 ani)</small></label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="serviciu_revizie_gaz" value="Revizie InstalaÈ›ie Gaz">
                                <label for="serviciu_revizie_gaz">Revizie InstalaÈ›ie Gaz - <strong>250 Lei</strong> <small>(valabilitate 2 ani)</small></label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="serviciu_verificare_centrala" value="Verificare CentralÄƒ">
                                <label for="serviciu_verificare_centrala">Verificare CentralÄƒ - <strong>150 Lei</strong> <small>(valabilitate 2 ani)</small></label>
                            </div>
                            <div class="checkbox-item oferta-speciala">
                                <input type="checkbox" id="serviciu_pachet_complet" value="InstalaÈ›ii Gaz + CentralÄƒ">
                                <label for="serviciu_pachet_complet"><strong>ğŸ”¥ OFERTÄ‚: InstalaÈ›ii Gaz + CentralÄƒ - 250 Lei</strong> <small>(valabilitate 2 ani)</small></label>
                            </div>
                        </div>
                        <div style="background: #e6fffa; padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #38b2ac;">
                            <p style="color: #2c7a7b; font-weight: 600; margin: 0;">â„¹ï¸ Toate serviciile au valabilitate de 2 ani È™i se programeazÄƒ automat urmÄƒtoarea verificare!</p>
                            <div id="costTotal" style="margin-top: 10px; font-size: 18px; font-weight: bold; color: #2c7a7b;">
                                ğŸ’° Cost total: <span id="valoareTotala">0</span> Lei
                            </div>
                        </div>
                    </div>

                    <div class="date-range-container">
                        <div class="form-section-title">ğŸ“… Date Importante Revizie</div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">Data Revizie EfectuatÄƒ</label>
                                <input type="date" class="form-input" id="dataRevizieEfectuata">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Data Expirare (calculatÄƒ automat)</label>
                                <input type="date" class="form-input" id="dataExpirare" readonly style="background: #f7fafc;">
                            </div>
                        </div>
                    </div>

                    <div class="revizie-container">
                        <div class="form-section-title">ğŸ” Sistem Revizii Automate</div>
                        <div class="form-grid">
                            <div class="form-group">
                                <label class="form-label">Data Primei Revizii/VerificÄƒri</label>
                                <input type="date" class="form-input" id="dataPrimaRevizie">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Periodicitate Revizie (legal)</label>
                                <select class="form-select" id="periodicitateRevizie">
                                    <option value="2" selected>2 ani (obligatoriu legal pentru instalaÈ›iile de gaz)</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Zile Notificare Ãnainte</label>
                                <select class="form-select" id="zileNotificare">
                                    <option value="1">1 zi Ã®nainte</option>
                                    <option value="2" selected>2 zile Ã®nainte</option>
                                    <option value="3">3 zile Ã®nainte</option>
                                    <option value="7">1 sÄƒptÄƒmÃ¢nÄƒ Ã®nainte</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Data UrmÄƒtoarei Revizii</label>
                                <input type="date" class="form-input" id="dataUrmatoareaRevizie" readonly style="background: #f7fafc;">
                            </div>
                        </div>
                    </div>

                    <div class="form-container">
                        <div class="form-section-title">ğŸ“ Gestionare Documente</div>
                        <div class="file-upload-area" id="fileUploadArea">
                            <div style="font-size: 48px; color: #cbd5e0; margin-bottom: 15px;">ğŸ“„</div>
                            <p style="color: #4a5568; font-weight: 600; margin-bottom: 10px;">ÃncarcÄƒ documente pentru client</p>
                            <p style="color: #718096; font-size: 14px;">Drag & drop sau click pentru a selecta fiÈ™iere</p>
                            <p style="color: #a0aec0; font-size: 12px;">PDF, DOC, DOCX, JPG, PNG (max 5MB per fiÈ™ier)</p>
                            <input type="file" id="fileInput" multiple accept=".pdf,.doc,.docx,.jpg,.jpeg,.png" style="display: none;">
                        </div>
                        <div class="file-list" id="fileList"></div>
                    </div>

                    <div style="margin-top: 20px;">
                        <button class="btn btn-primary" onclick="adaugaAbonat()">
                            â• AdaugÄƒ Abonat
                        </button>
                        <button class="btn btn-secondary" onclick="resetFormAbonat()">
                            ğŸ”„ ReseteazÄƒ Formularul
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- ProgramÄƒri Section -->
        <section id="programari" class="section">
            <h1 class="section-title">ğŸ“… Gestionare ProgramÄƒri</h1>
            
            <!-- Alerts Section -->
            <div class="alerts-section">
                <div id="alerteProgramari"></div>
            </div>

            <!-- Lists Section -->
            <div class="lists-section">
                <div id="listaProgramari">
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ“…</div>
                        <h3>Nu existÄƒ programÄƒri</h3>
                        <p>AdaugÄƒ prima programare folosind formularul de mai jos.</p>
                    </div>
                </div>
            </div>

            <!-- Separator -->
            <div class="section-separator"></div>

            <!-- Forms Section -->
            <div class="forms-section">
                <div class="form-container">
                    <h3 style="color: #4a5568; margin-bottom: 20px;">â• Programare NouÄƒ</h3>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Client</label>
                            <select class="form-select" id="clientProgramare">
                                <option value="">SelecteazÄƒ clientul</option>
                                <option value="nou">â• Client Nou</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Tip Serviciu</label>
                            <select class="form-select" id="tipServiciu">
                                <option value="">SelecteazÄƒ serviciul</option>
                                <option value="Verificare InstalaÈ›ie Gaz">Verificare InstalaÈ›ie Gaz - 150 Lei</option>
                                <option value="Revizie InstalaÈ›ie Gaz">Revizie InstalaÈ›ie Gaz - 250 Lei</option>
                                <option value="Verificare CentralÄƒ">Verificare CentralÄƒ - 150 Lei</option>
                                <option value="InstalaÈ›ii Gaz + CentralÄƒ">ğŸ”¥ OFERTÄ‚: InstalaÈ›ii Gaz + CentralÄƒ - 250 Lei</option>
                                <option value="ReparaÈ›ie">ReparaÈ›ie</option>
                                <option value="ConsultanÈ›Äƒ">ConsultanÈ›Äƒ</option>
                                <option value="UrgenÈ›Äƒ">UrgenÈ›Äƒ</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Data ProgramÄƒrii</label>
                            <input type="datetime-local" class="form-input" id="dataProgramare">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Status</label>
                            <select class="form-select" id="statusProgramare">
                                <option value="ProgramatÄƒ">ğŸ“… ProgramatÄƒ</option>
                                <option value="Ãn Progres">âš¡ Ãn Progres</option>
                                <option value="FinalizatÄƒ">âœ… FinalizatÄƒ</option>
                                <option value="AnulatÄƒ">âŒ AnulatÄƒ</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">ObservaÈ›ii</label>
                        <textarea class="form-input" id="observatiiProgramare" rows="3" placeholder="Detalii despre programare..."></textarea>
                    </div>

                    <div style="margin-top: 20px;">
                        <button class="btn btn-primary" onclick="adaugaProgramare()">
                            ğŸ“… AdaugÄƒ Programare
                        </button>
                        <button class="btn btn-secondary" onclick="resetFormProgramare()">
                            ğŸ”„ ReseteazÄƒ
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Remindere Section -->
        <section id="remindere" class="section">
            <h1 class="section-title">ğŸ”” Gestionare Remindere</h1>
            
            <!-- Alerts Section -->
            <div class="alerts-section">
                <div id="alerteRemindere"></div>
                
                <!-- AlertÄƒ pentru remindere -->
                <div class="alert alert-success" style="border-left: 4px solid #38a169;">
                    <strong>ğŸ“‹ Sistem Remindere Profesional!</strong><br>
                    â€¢ <strong>ExpirÄƒri:</strong> UrmÄƒrire verificÄƒri È™i revizii care expirÄƒ<br>
                    â€¢ <strong>PlÄƒÈ›i:</strong> Remindere pentru facturi È™i plÄƒÈ›i pendente<br>
                    â€¢ <strong>WhatsApp automat:</strong> Mesaje pentru revizii expirate (urgent)<br>
                    â€¢ <strong>Dropdown:</strong> 12 tipuri de detalii pentru remindere complete
                </div>
            </div>

            <!-- Lists Section -->
            <div class="lists-section">
                <div id="listaRemindere">
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ””</div>
                        <h3>Nu existÄƒ remindere</h3>
                        <p>AdaugÄƒ primul reminder folosind formularul de mai jos.</p>
                    </div>
                </div>
            </div>

            <!-- Separator -->
            <div class="section-separator"></div>

            <!-- Forms Section -->
            <div class="forms-section">
                <div class="form-container">
                    <h3 style="color: #4a5568; margin-bottom: 20px;">â• Reminder Nou</h3>
                    
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">Client</label>
                            <select class="form-select" id="clientReminder">
                                <option value="">SelecteazÄƒ clientul</option>
                                <option value="nou">â• Client Nou</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Tip Reminder</label>
                            <select class="form-select" id="tipReminder">
                                <option value="">SelecteazÄƒ tipul</option>
                                <option value="Verificare InstalaÈ›ie Gaz">ğŸ” Verificare InstalaÈ›ie Gaz - Expirare</option>
                                <option value="Revizie InstalaÈ›ie Gaz">ğŸ”§ Revizie InstalaÈ›ie Gaz - Expirare</option>
                                <option value="Verificare CentralÄƒ">ğŸ  Verificare CentralÄƒ - Expirare</option>
                                <option value="InstalaÈ›ii Gaz + CentralÄƒ">ğŸ”¥ Pachet Complet - Expirare</option>
                                <option value="UrmÄƒrire PlatÄƒ">ğŸ“ UrmÄƒrire PlatÄƒ</option>
                                <option value="Facturare">ğŸ’° Facturare</option>
                                <option value="Reprogramare">ğŸ“… Reprogramare NecesarÄƒ</option>
                                <option value="DocumentaÈ›ie">ğŸ“„ DocumentaÈ›ie LipsÄƒ</option>
                                <option value="Confirmare">âœ… Confirmare Serviciu</option>
                                <option value="Altele">ğŸ“ Altele</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Detalii Reminder</label>
                            <select class="form-select" id="problemaSpecifica">
                                <option value="">SelecteazÄƒ detaliile</option>
                                <option value="Expirare Ã®n 30 zile">â° Expirare Ã®n 30 zile</option>
                                <option value="Expirare Ã®n 7 zile">ğŸ”´ Expirare Ã®n 7 zile</option>
                                <option value="Expirat - Reprogramare urgentÄƒ">ğŸš¨ Expirat - Reprogramare urgentÄƒ</option>
                                <option value="FacturÄƒ neplÄƒtitÄƒ">ğŸ’³ FacturÄƒ neplÄƒtitÄƒ</option>
                                <option value="PlatÄƒ parÈ›ialÄƒ">ğŸ’° PlatÄƒ parÈ›ialÄƒ</option>
                                <option value="Programare amÃ¢natÄƒ">ğŸ“… Programare amÃ¢natÄƒ</option>
                                <option value="Documente incomplete">ğŸ“„ Documente incomplete</option>
                                <option value="Confirmare necesarÄƒ">âœ… Confirmare necesarÄƒ</option>
                                <option value="Client nou - urmÄƒrire">ğŸ‘¤ Client nou - urmÄƒrire</option>
                                <option value="Feedback serviciu">â­ Feedback serviciu</option>
                                <option value="Contact telefonic">ğŸ“ Contact telefonic</option>
                                <option value="Altele">â“ Altele</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Data Reminder</label>
                            <input type="datetime-local" class="form-input" id="dataReminder">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Prioritate</label>
                            <select class="form-select" id="prioritateReminder">
                                <option value="JoasÄƒ">ğŸŸ¢ JoasÄƒ</option>
                                <option value="Medie">ğŸŸ¡ Medie</option>
                                <option value="ÃnaltÄƒ">ğŸ”´ ÃnaltÄƒ</option>
                                <option value="UrgentÄƒ">ğŸš¨ UrgentÄƒ</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Mesaj Reminder</label>
                        <textarea class="form-input" id="mesajReminder" rows="3" placeholder="Descrierea reminder-ului..."></textarea>
                    </div>

                    <div style="margin-top: 20px;">
                        <button class="btn btn-primary" onclick="adaugaReminder()">
                            ğŸ”” AdaugÄƒ Reminder
                        </button>
                        <button class="btn btn-secondary" onclick="resetFormReminder()">
                            ğŸ”„ ReseteazÄƒ
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Rapoarte Section -->
        <section id="rapoarte" class="section">
            <h1 class="section-title">ğŸ“Š Rapoarte È™i Statistici</h1>
            
            <div class="form-grid">
                <div class="form-container">
                    <h3 style="color: #4a5568; margin-bottom: 15px;">ğŸ“ˆ Rezumat General</h3>
                    <p style="color: #718096;">Total AbonaÈ›i: <strong id="raportTotalAbonati">0</strong></p>
                    <p style="color: #718096;">ProgramÄƒri Luna Aceasta: <strong id="raportProgramari">0</strong></p>
                    <p style="color: #718096;">Remindere Pending: <strong id="raportRemindere">0</strong></p>
                    <p style="color: #718096;">Revizii UrmÄƒtoarea LunÄƒ: <strong id="raportRevizii">0</strong></p>
                </div>
                <div class="form-container">
                    <h3 style="color: #4a5568; margin-bottom: 15px;">ğŸ™ï¸ DistribuÈ›ie pe OraÈ™e</h3>
                    <div id="distributieOrase">
                        <p style="color: #718096;">Nu existÄƒ date disponibile</p>
                    </div>
                </div>
            </div>

            <div class="form-container">
                <h3 style="color: #4a5568; margin-bottom: 15px;">ğŸ› ï¸ Servicii Contractate</h3>
                <div id="distributieServicii">
                    <p style="color: #718096;">Nu existÄƒ date disponibile</p>
                </div>
            </div>

            <div class="form-container">
                <h3 style="color: #4a5568; margin-bottom: 20px;">ğŸ“‹ Export Rapoarte Complete</h3>
                <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px;">
                    <button class="btn btn-primary" onclick="exportRaportPDF()">ğŸ“„ Raport PDF Complet</button>
                    <button class="btn btn-primary" onclick="exportRaportExcel()">ğŸ“Š Raport Excel Detaliat</button>
                    <button class="btn btn-secondary" onclick="exportAbonati()">ğŸ“¥ Export AbonaÈ›i CSV</button>
                    <button class="btn btn-secondary" onclick="exportProgramari()">ğŸ“¥ Export ProgramÄƒri CSV</button>
                    <button class="btn btn-secondary" onclick="exportRemindere()">ğŸ“¥ Export Remindere CSV</button>
                    <button class="btn btn-secondary" onclick="exportRevizii()">ğŸ“¥ Export Revizii CSV</button>
                </div>
                
                <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; padding-top: 15px; border-top: 2px solid #e2e8f0;">
                    <button class="btn btn-primary" onclick="sincronizareAvansata()">ğŸ”„ Sincronizare CompletÄƒ</button>
                    <button class="btn btn-secondary" onclick="creeazaBackup()">ğŸ’¾ Backup Date Complete</button>
                    <button class="btn btn-secondary" onclick="verificaConsistentaDatele(); showNotification('Verificare completÄƒ!', 'info')">ğŸ” VerificÄƒ ConsistenÈ›a</button>
                    <button class="btn btn-secondary" onclick="adaugaDateDeTest(); sincronizeazaDatele()">ğŸ§ª ReÃ®ncarcÄƒ Date Test</button>
                </div>
                
                <div style="background: #edf2f7; padding: 15px; border-radius: 8px;">
                    <h4 style="color: #4a5568; margin-bottom: 10px;">ğŸ“ˆ Statistici Raport:</h4>
                    <p style="color: #718096;">â€¢ PDF: Include toate datele, grafice È™i documente</p>
                    <p style="color: #718096;">â€¢ Excel: FiÈ™ier cu multiple foi pentru fiecare secÈ›iune</p>
                    <p style="color: #718096;">â€¢ CSV: Format simplu pentru import Ã®n alte sisteme</p>
                    <p style="color: #38a169; font-weight: 600;">â€¢ Sincronizare: Actualizare automatÄƒ la fiecare 30 secunde</p>
                    <p style="color: #38a169; font-weight: 600;">â€¢ Backup: Salvare completÄƒ a tuturor datelor Ã®n format JSON</p>
                </div>
            </div>
        </section>
    </main>

    <!-- Modal pentru Gestionare Documente -->
    <div id="modalDocumente" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">ğŸ“ Documente Client</h2>
                <button class="close-modal" onclick="inchideModalDocumente()">&times;</button>
            </div>
            <div id="continutModalDocumente">
                <!-- ConÈ›inutul se va Ã®ncÄƒrca dinamic -->
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification"></div>

    <!-- Sync Indicator -->
    <div id="syncIndicator" class="sync-indicator">
        âœ“ Sincronizat
    </div>

    <script>
        // ===========================================
        // FIREBASE CONFIGURATION & NOTIFICATIONS
        // ===========================================
        
        // Configurare Firebase
        const firebaseConfig = {
            apiKey: "your-api-key",
            authDomain: "adinstalgaz-pwa.firebaseapp.com",
            projectId: "adinstalgaz-pwa",
            storageBucket: "adinstalgaz-pwa.appspot.com",
            messagingSenderId: "your-sender-id",
            appId: "your-app-id"
        };

        // IniÈ›ializeazÄƒ Firebase
        let db, functions;
        try {
            if (typeof firebase !== 'undefined') {
                firebase.initializeApp(firebaseConfig);
                db = firebase.firestore();
                functions = firebase.functions();
                console.log('âœ… Firebase iniÈ›ializat cu succes!');
            }
        } catch (error) {
            console.warn('âš ï¸ Firebase nu este disponibil:', error.message);
            console.log('ğŸ“± AplicaÈ›ia va funcÈ›iona Ã®n modul offline');
        }

        // ===========================================
        // SISTEM NOTIFICÄ‚RI AUTOMATE
        // ===========================================

        // ===========================================
        // CONFIGURÄ‚RI FIRMÄ‚
        // ===========================================
        
        const CONFIGURARI_FIRMA = {
            nume: 'GazTech Services',
            telefon: '0762614402', // NUMÄ‚RUL FIRMEI
            email: 'contact@gaztech.ro',
            adresa: 'Alexandria, Teleorman',
            website: 'www.gaztech.ro'
        };

        // Template-uri de mesaje
        const messageTemplates = {
            expirareRevizie: (nume, zile, servicii) => 
                `ğŸ”” BunÄƒ ziua ${nume}!\n\n` +
                `Revizia dumneavoastrÄƒ pentru ${servicii} expirÄƒ Ã®n ${zile} zile.\n\n` +
                `Pentru reprogramare, sunaÈ›i la ğŸ“ ${CONFIGURARI_FIRMA.telefon}\n\n` +
                `${CONFIGURARI_FIRMA.nume} - Servicii profesionale de instalaÈ›ii gaz`,

            plataPendenta: (nume, suma, servicii) => 
                `ğŸ’° BunÄƒ ziua ${nume}!\n\n` +
                `AveÈ›i de plÄƒtit suma de ${suma} Lei pentru:\n${servicii}\n\n` +
                `Pentru platÄƒ: ğŸ“ ${CONFIGURARI_FIRMA.telefon}\n\n` +
                `${CONFIGURARI_FIRMA.nume} - MulÈ›umim!`,

            confirmareProgramare: (nume, data, serviciu, adresa) => 
                `âœ… BunÄƒ ziua ${nume}!\n\n` +
                `ConfirmÄƒm programarea pentru ${serviciu}\n` +
                `ğŸ“… Data: ${data}\nğŸ“ Adresa: ${adresa}\n\n` +
                `InformaÈ›ii: ğŸ“ ${CONFIGURARI_FIRMA.telefon}\n` +
                `${CONFIGURARI_FIRMA.nume}`,

            revizieCompletata: (nume, serviciu, valabilitate) => 
                `âœ… BunÄƒ ziua ${nume}!\n\n` +
                `Revizia pentru ${serviciu} a fost finalizatÄƒ cu succes!\n` +
                `ğŸ“‹ Valabilitate: ${valabilitate}\n\n` +
                `${CONFIGURARI_FIRMA.nume} - MulÈ›umim pentru Ã®ncredere!\n` +
                `ğŸ“ ${CONFIGURARI_FIRMA.telefon}`,

            abonatNou: (nume, servicii) =>
                `âœ… BunÄƒ ziua ${nume}!\n\n` +
                `VÄƒ confirmÄƒm Ã®nregistrarea Ã®n sistemul ${CONFIGURARI_FIRMA.nume}.\n` +
                `ğŸ“‹ Servicii contractate: ${servicii}\n\n` +
                `Pentru informaÈ›ii: ğŸ“ ${CONFIGURARI_FIRMA.telefon}\n` +
                `${CONFIGURARI_FIRMA.nume} - MulÈ›umim pentru Ã®ncredere!`,

            reminderGeneral: (nume, serviciu, zile) =>
                `ğŸ”” Reminder ${CONFIGURARI_FIRMA.nume}\n\n` +
                `BunÄƒ ziua ${nume}!\n` +
                `${serviciu} programat Ã®n ${zile} zile.\n\n` +
                `Contact: ğŸ“ ${CONFIGURARI_FIRMA.telefon}`
        };

        // FuncÈ›ie pentru trimitere SMS (simulare)
        async function trimiteNotificare(telefon, mesaj, tip = 'SMS') {
            try {
                if (db && functions) {
                    // Trimite prin Firebase Functions
                    const sendNotification = functions.httpsCallable('sendNotification');
                    const result = await sendNotification({
                        phone: telefon,
                        message: mesaj,
                        type: tip
                    });
                    
                    console.log(`ğŸ“± ${tip} trimis cu succes:`, result.data);
                    return { success: true, result: result.data };
                } else {
                    // Simulare pentru demo
                    console.log(`ğŸ“± SIMULARE ${tip} cÄƒtre ${telefon}:`);
                    console.log(mesaj);
                    
                    showNotification(`ğŸ“± ${tip} trimis cÄƒtre ${telefon}`, 'success');
                    return { success: true, simulated: true };
                }
            } catch (error) {
                console.error(`âŒ Eroare trimitere ${tip}:`, error);
                showNotification(`âŒ Eroare trimitere ${tip}: ${error.message}`, 'error');
                return { success: false, error: error.message };
            }
        }

        // FUNCÈšIE NOUÄ‚ PENTRU WHATSAPP
        function trimiteWhatsApp(telefon, mesaj) {
            // CurÄƒÈ›Äƒ numÄƒrul de telefon (eliminÄƒ 0 È™i adaugÄƒ +40)
            const telefonCurat = telefon.replace(/^0/, '+40').replace(/\s+/g, '');
            
            // Encode mesajul pentru URL
            const mesajEncoded = encodeURIComponent(mesaj);
            
            // CreeazÄƒ link-ul WhatsApp
            const linkWhatsApp = `https://wa.me/${telefonCurat}?text=${mesajEncoded}`;
            
            // Deschide WhatsApp Ã®n tab nou
            window.open(linkWhatsApp, '_blank');
            
            console.log(`ğŸ“± WHATSAPP cÄƒtre ${telefon}:`);
            console.log('='.repeat(50));
            console.log(mesaj);
            console.log('='.repeat(50));
            console.log(`ğŸ”— Link: ${linkWhatsApp}`);
            
            showNotification(`ğŸ“± WhatsApp deschis pentru ${telefon}`, 'success');
            return { success: true, whatsappLink: linkWhatsApp };
        }

        // FuncÈ›ie pentru notificare expirare revizie
        async function notificaExpirareRevizie(abonat) {
            const servicii = abonat.serviciiContractate ? abonat.serviciiContractate.join(', ') : 'servicii contractate';
            const dataExpirare = new Date(abonat.dataExpirare);
            const astazi = new Date();
            const zileRamase = Math.ceil((dataExpirare - astazi) / (1000 * 60 * 60 * 24));
            
            const mesaj = messageTemplates.expirareRevizie(
                abonat.nume,
                zileRamase,
                servicii
            );
            
            // AfiÈ™eazÄƒ mesajul Ã®n consolÄƒ pentru demonstraÈ›ie
            console.log('ğŸ“± MESAJ TRIMIS:');
            console.log('='.repeat(50));
            console.log(mesaj);
            console.log('='.repeat(50));
            
            return await trimiteNotificare(abonat.telefon, mesaj, 'SMS');
        }

        // FuncÈ›ie pentru notificare platÄƒ pendentÄƒ
        async function notificaPlata(abonat) {
            let costTotal = 0;
            if (abonat.serviciiContractate) {
                abonat.serviciiContractate.forEach(serviciu => {
                    switch(serviciu) {
                        case 'Verificare InstalaÈ›ie Gaz': costTotal += 150; break;
                        case 'Revizie InstalaÈ›ie Gaz': costTotal += 250; break;
                        case 'Verificare CentralÄƒ': costTotal += 150; break;
                        case 'InstalaÈ›ii Gaz + CentralÄƒ': costTotal += 250; break;
                    }
                });
            }
            
            const servicii = abonat.serviciiContractate ? abonat.serviciiContractate.join(', ') : 'servicii contractate';
            const mesaj = messageTemplates.plataPendenta(abonat.nume, costTotal, servicii);
            
            console.log('ğŸ“± MESAJ PLATÄ‚ TRIMIS:');
            console.log('='.repeat(50));
            console.log(mesaj);
            console.log('='.repeat(50));
            
            return await trimiteNotificare(abonat.telefon, mesaj, 'SMS');
        }

        // FuncÈ›ie pentru confirmare programare
        async function confirmareProgramare(programare) {
            const abonat = abonati.find(a => a.id == programare.clientId);
            if (!abonat) return;
            
            const data = new Date(programare.data).toLocaleString('ro-RO');
            const adresa = formatareAdresa(abonat.adresa);
            
            const mesaj = messageTemplates.confirmareProgramare(
                abonat.nume,
                data,
                programare.tipServiciu,
                adresa
            );
            
            console.log('ğŸ“± CONFIRMARE PROGRAMARE:');
            console.log('='.repeat(50));
            console.log(mesaj);
            console.log('='.repeat(50));
            
            return await trimiteNotificare(abonat.telefon, mesaj, 'SMS');
        }

        // ===========================================
        // FIREBASE FIRESTORE SYNC
        // ===========================================

        // Salvare Ã®n Firestore
        async function salveazaInFirestore(colectie, id, data) {
            if (!db) {
                console.log('ğŸ“± Firestore nu este disponibil - date salvate local');
                return false;
            }
            
            try {
                await db.collection(colectie).doc(id.toString()).set({
                    ...data,
                    lastModified: firebase.firestore.FieldValue.serverTimestamp(),
                    source: 'gaztech-web-app'
                });
                
                console.log(`âœ… ${colectie}/${id} salvat Ã®n Firestore`);
                return true;
            } catch (error) {
                console.error(`âŒ Eroare salvare ${colectie}:`, error);
                return false;
            }
        }

        // ÃncÄƒrcare din Firestore
        async function incarcaDinFirestore(colectie) {
            if (!db) return [];
            
            try {
                const snapshot = await db.collection(colectie).get();
                const data = [];
                
                snapshot.forEach(doc => {
                    data.push({
                        id: parseInt(doc.id) || doc.id,
                        ...doc.data()
                    });
                });
                
                console.log(`âœ… ${data.length} Ã®nregistrÄƒri Ã®ncÄƒrcate din ${colectie}`);
                return data;
            } catch (error) {
                console.error(`âŒ Eroare Ã®ncÄƒrcare ${colectie}:`, error);
                return [];
            }
        }

        // Sincronizare completÄƒ cu Firestore
        async function sincronizareCuFirestore() {
            if (!db) {
                showNotification('ğŸ“± Firestore nu este disponibil', 'warning');
                return;
            }
            
            try {
                showNotification('ğŸ”„ Sincronizare cu Firebase...', 'info');
                
                // SalveazÄƒ datele locale Ã®n Firestore
                const promiseSalvare = [];
                
                abonati.forEach(abonat => {
                    promiseSalvare.push(salveazaInFirestore('subscribers', abonat.id, abonat));
                });
                
                programari.forEach(programare => {
                    promiseSalvare.push(salveazaInFirestore('appointments', programare.id, programare));
                });
                
                remindere.forEach(reminder => {
                    promiseSalvare.push(salveazaInFirestore('reminders', reminder.id, reminder));
                });
                
                await Promise.all(promiseSalvare);
                
                showNotification('âœ… Sincronizare Firebase completÄƒ!', 'success');
                showSyncIndicator();
                
            } catch (error) {
                console.error('âŒ Eroare sincronizare:', error);
                showNotification('âŒ Eroare sincronizare Firebase', 'error');
            }
        }

        // ===========================================
        // VERIFICARE AUTOMATÄ‚ NOTIFICÄ‚RI
        // ===========================================

        function verificaNotificariAutomated() {
            const astazi = new Date();
            
            abonati.forEach(async (abonat) => {
                if (!abonat.dataExpirare) return;
                
                const dataExpirare = new Date(abonat.dataExpirare);
                const zileRamase = Math.ceil((dataExpirare - astazi) / (1000 * 60 * 60 * 24));
                
                // Notificare la 30, 7 È™i 1 zi Ã®nainte de expirare
                if ([30, 7, 1].includes(zileRamase)) {
                    console.log(`ğŸ“± Trimite notificare expirare pentru ${abonat.nume} (${zileRamase} zile)`);
                    await notificaExpirareRevizie(abonat);
                    
                    // MarcheazÄƒ notificarea ca trimisÄƒ
                    abonat.ultimaNotificare = astazi.toISOString();
                    saveData();
                }
            });
        }

        // Global Variables
        let abonati = JSON.parse(localStorage.getItem('abonati')) || [];
        let programari = JSON.parse(localStorage.getItem('programari')) || [];
        let remindere = JSON.parse(localStorage.getItem('remindere')) || [];
        let documenteTemp = []; // Temporare pentru upload

        // Sync indicator
        function showSyncIndicator() {
            const indicator = document.getElementById('syncIndicator');
            indicator.classList.add('show');
            setTimeout(() => {
                indicator.classList.remove('show');
            }, 2000);
        }

        // Navigation
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');
        const navMenu = document.getElementById('navMenu');

        mobileMenuBtn.addEventListener('click', () => {
            navMenu.classList.toggle('active');
            mobileMenuBtn.textContent = navMenu.classList.contains('active') ? 'âœ•' : 'â˜°';
        });

        // Close mobile menu when clicking outside
        document.addEventListener('click', (e) => {
            if (!navMenu.contains(e.target) && !mobileMenuBtn.contains(e.target)) {
                navMenu.classList.remove('active');
                mobileMenuBtn.textContent = 'â˜°';
            }
        });

        // Auto-calculate expiration date and next revision date
        document.getElementById('dataPrimaRevizie').addEventListener('change', calculeazaUrmatoareaRevizie);
        document.getElementById('periodicitateRevizie').addEventListener('change', calculeazaUrmatoareaRevizie);
        document.getElementById('dataRevizieEfectuata').addEventListener('change', calculeazaDataExpirare);

        function calculeazaDataExpirare() {
            const dataRevizie = document.getElementById('dataRevizieEfectuata').value;
            
            if (dataRevizie) {
                const data = new Date(dataRevizie);
                data.setFullYear(data.getFullYear() + 2); // Ãntotdeauna 2 ani pentru conformitatea legalÄƒ
                
                const dataFormatata = data.toISOString().split('T')[0];
                document.getElementById('dataExpirare').value = dataFormatata;
                
                // ActualizeazÄƒ È™i urmÄƒtoarea revizie dacÄƒ nu este deja setatÄƒ
                if (!document.getElementById('dataPrimaRevizie').value) {
                    document.getElementById('dataPrimaRevizie').value = dataRevizie;
                    calculeazaUrmatoareaRevizie();
                }
            } else {
                document.getElementById('dataExpirare').value = '';
            }
        }

        function calculeazaUrmatoareaRevizie() {
            const dataPrima = document.getElementById('dataPrimaRevizie').value;
            const periodicitate = document.getElementById('periodicitateRevizie').value;

            if (dataPrima && periodicitate) {
                const data = new Date(dataPrima);
                data.setFullYear(data.getFullYear() + parseInt(periodicitate));
                
                const dataFormatata = data.toISOString().split('T')[0];
                document.getElementById('dataUrmatoareaRevizie').value = dataFormatata;
            } else {
                document.getElementById('dataUrmatoareaRevizie').value = '';
            }
        }

        // Initialize file upload
        function initializeFileUpload() {
            const fileUploadArea = document.getElementById('fileUploadArea');
            const fileInput = document.getElementById('fileInput');
            
            if (!fileUploadArea || !fileInput) return;

            fileUploadArea.addEventListener('click', () => {
                fileInput.click();
            });

            fileUploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                fileUploadArea.classList.add('dragover');
            });

            fileUploadArea.addEventListener('dragleave', () => {
                fileUploadArea.classList.remove('dragover');
            });

            fileUploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                fileUploadArea.classList.remove('dragover');
                handleFiles(e.dataTransfer.files);
            });

            fileInput.addEventListener('change', (e) => {
                handleFiles(e.target.files);
            });
        }

        function handleFiles(files) {
            Array.from(files).forEach(file => {
                if (file.size > 5 * 1024 * 1024) { // 5MB limit
                    showNotification(`FiÈ™ierul ${file.name} este prea mare (max 5MB)`, 'error');
                    return;
                }

                const allowedTypes = ['application/pdf', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document', 'image/jpeg', 'image/png'];
                if (!allowedTypes.includes(file.type)) {
                    showNotification(`Tipul fiÈ™ierului ${file.name} nu este permis`, 'error');
                    return;
                }

                const reader = new FileReader();
                reader.onload = (e) => {
                    const documentNou = {
                        id: Date.now() + Math.random(),
                        nume: file.name,
                        tip: file.type,
                        marime: file.size,
                        continut: e.target.result.split(',')[1], // Base64 fÄƒrÄƒ header
                        dataIncarcare: new Date().toISOString()
                    };

                    documenteTemp.push(documentNou);
                    afiseazaListaFisiere();
                    showNotification(`FiÈ™ierul ${file.name} a fost Ã®ncÄƒrcat`, 'success');
                };
                reader.readAsDataURL(file);
            });
        }

        function afiseazaListaFisiere() {
            const fileList = document.getElementById('fileList');
            if (!fileList || documenteTemp.length === 0) {
                if (fileList) fileList.innerHTML = '';
                return;
            }

            let html = '<h4 style="color: #4a5568; margin-bottom: 15px;">ğŸ“„ FiÈ™iere Ã®ncÄƒrcate:</h4>';
            
            documenteTemp.forEach(doc => {
                const marimeMB = (doc.marime / (1024 * 1024)).toFixed(2);
                const iconFisier = getFileIcon(doc.tip);
                
                html += `
                    <div class="file-item">
                        <div class="file-info">
                            <span class="file-icon">${iconFisier}</span>
                            <div class="file-details">
                                <span class="file-name">${doc.nume}</span>
                                <span class="file-size">${marimeMB} MB â€¢ ${new Date(doc.dataIncarcare).toLocaleDateString('ro-RO')}</span>
                            </div>
                        </div>
                        <button class="btn btn-danger btn-small" onclick="stergeFisierTemp(${doc.id})" title="È˜terge fiÈ™ier">ğŸ—‘ï¸</button>
                    </div>
                `;
            });

            fileList.innerHTML = html;
        }

        function getFileIcon(tipFisier) {
            switch(tipFisier) {
                case 'application/pdf': return 'ğŸ“„';
                case 'application/msword':
                case 'application/vnd.openxmlformats-officedocument.wordprocessingml.document': return 'ğŸ“';
                case 'image/jpeg':
                case 'image/png': return 'ğŸ–¼ï¸';
                default: return 'ğŸ“';
            }
        }

        function stergeFisierTemp(idFisier) {
            documenteTemp = documenteTemp.filter(doc => doc.id !== idFisier);
            afiseazaListaFisiere();
            showNotification('FiÈ™ierul a fost È™ters', 'success');
        }

        function gestioneazaDocumente(idAbonat) {
            const abonat = abonati.find(a => a.id === idAbonat);
            if (!abonat) return;

            const modal = document.getElementById('modalDocumente');
            const continut = document.getElementById('continutModalDocumente');
            
            let html = `
                <h3 style="color: #4a5568; margin-bottom: 20px;">ğŸ“ Documente pentru ${abonat.nume}</h3>
                
                <div class="file-upload-area" onclick="document.getElementById('modalFileInput').click()">
                    <div style="font-size: 48px; color: #cbd5e0; margin-bottom: 15px;">ğŸ“„</div>
                    <p style="color: #4a5568; font-weight: 600; margin-bottom: 10px;">AdaugÄƒ documente noi</p>
                    <p style="color: #718096; font-size: 14px;">Click pentru a selecta fiÈ™iere</p>
                    <input type="file" id="modalFileInput" multiple accept=".pdf,.doc,.docx,.jpg,.jpeg,.png" style="display: none;">
                </div>
                
                <div style="margin-top: 30px;">
                    <h4 style="color: #4a5568; margin-bottom: 15px;">ğŸ“ Documente existente:</h4>
                    <div id="documenteExistente">
            `;

            if (abonat.documente && abonat.documente.length > 0) {
                abonat.documente.forEach(doc => {
                    const marimeMB = (doc.marime / (1024 * 1024)).toFixed(2);
                    const iconFisier = getFileIcon(doc.tip);
                    
                    html += `
                        <div class="file-item">
                            <div class="file-info">
                                <span class="file-icon">${iconFisier}</span>
                                <div class="file-details">
                                    <span class="file-name">${doc.nume}</span>
                                    <span class="file-size">${marimeMB} MB â€¢ ${new Date(doc.dataIncarcare).toLocaleDateString('ro-RO')}</span>
                                </div>
                            </div>
                            <div style="display: flex; gap: 8px;">
                                <button class="btn btn-secondary btn-small" onclick="descarcaDocument(${abonat.id}, ${doc.id})" title="DescarcÄƒ">ğŸ“¥</button>
                                <button class="btn btn-danger btn-small" onclick="stergeDocument(${abonat.id}, ${doc.id})" title="È˜terge">ğŸ—‘ï¸</button>
                            </div>
                        </div>
                    `;
                });
            } else {
                html += '<p style="color: #718096; text-align: center; padding: 20px;">Nu existÄƒ documente Ã®ncÄƒrcate</p>';
            }

            html += `
                    </div>
                </div>
                
                <div style="margin-top: 30px; display: flex; gap: 10px; justify-content: flex-end;">
                    <button class="btn btn-secondary" onclick="inchideModalDocumente()">Ãnchide</button>
                </div>
            `;

            continut.innerHTML = html;

            // Add event listener for new file uploads
            document.getElementById('modalFileInput').addEventListener('change', (e) => {
                adaugaDocumenteExistente(idAbonat, e.target.files);
            });

            modal.style.display = 'block';
        }

        function adaugaDocumenteExistente(idAbonat, files) {
            const abonat = abonati.find(a => a.id === idAbonat);
            if (!abonat) return;

            if (!abonat.documente) abonat.documente = [];

            Array.from(files).forEach(file => {
                if (file.size > 5 * 1024 * 1024) {
                    showNotification(`FiÈ™ierul ${file.name} este prea mare (max 5MB)`, 'error');
                    return;
                }

                const reader = new FileReader();
                reader.onload = (e) => {
                    const documentNou = {
                        id: Date.now() + Math.random(),
                        nume: file.name,
                        tip: file.type,
                        marime: file.size,
                        continut: e.target.result.split(',')[1],
                        dataIncarcare: new Date().toISOString()
                    };

                    abonat.documente.push(documentNou);
                    saveData();
                    showNotification(`Documentul ${file.name} a fost adÄƒugat`, 'success');
                    
                    // ReÃ®mprospÄƒteazÄƒ modalul
                    gestioneazaDocumente(idAbonat);
                    updateListaAbonati();
                    showSyncIndicator();
                };
                reader.readAsDataURL(file);
            });
        }

        function descarcaDocument(idAbonat, idDocument) {
            const abonat = abonati.find(a => a.id === idAbonat);
            if (!abonat || !abonat.documente) return;

            const document = abonat.documente.find(d => d.id === idDocument);
            if (!document) return;

            const link = document.createElement('a');
            link.href = `data:${document.tip};base64,${document.continut}`;
            link.download = document.nume;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);

            showNotification(`Documentul ${document.nume} a fost descÄƒrcat`, 'success');
        }

        function stergeDocument(idAbonat, idDocument) {
            if (!confirm('EÈ™ti sigur cÄƒ vrei sÄƒ È™tergi acest document?')) return;

            const abonat = abonati.find(a => a.id === idAbonat);
            if (!abonat || !abonat.documente) return;

            const document = abonat.documente.find(d => d.id === idDocument);
            if (!document) return;

            abonat.documente = abonat.documente.filter(d => d.id !== idDocument);
            saveData();
            showNotification(`Documentul ${document.nume} a fost È™ters`, 'success');
            
            // ReÃ®mprospÄƒteazÄƒ modalul È™i lista
            gestioneazaDocumente(idAbonat);
            updateListaAbonati();
            showSyncIndicator();
        }

        function inchideModalDocumente() {
            document.getElementById('modalDocumente').style.display = 'none';
        }

        // Section navigation
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });

            // Remove active class from all nav links
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });

            // Show target section
            document.getElementById(sectionId).classList.add('active');

            // Add active class to corresponding nav link
            document.querySelector(`[data-section="${sectionId}"]`).classList.add('active');

            // Close mobile menu
            navMenu.classList.remove('active');
            mobileMenuBtn.textContent = 'â˜°';

            // Update data when showing sections - SINCRONIZARE AUTOMATÄ‚
            sincronizeazaDatele();
            
            if (sectionId === 'dashboard') {
                updateDashboard();
                verificaReminderePendente();
            } else if (sectionId === 'abonati') {
                updateListaAbonati();
                verificaAlerteAbonati();
            } else if (sectionId === 'programari') {
                updateListaProgramari();
                verificaAlerteProgramari();
            } else if (sectionId === 'remindere') {
                updateListaRemindere();
                verificaAlerteRemindere();
            } else if (sectionId === 'rapoarte') {
                updateRapoarte();
            }
        }

        // FUNCÈšIE DE SINCRONIZARE CENTRALIZATÄ‚
        function sincronizeazaDatele() {
            // ActualizeazÄƒ toate dropdown-urile cu abonaÈ›i
            updateClientDropdowns();
            
            // ActualizeazÄƒ statisticile Ã®n toate secÈ›iunile
            updateDashboard();
            updateRapoarte();
            
            // VerificÄƒ reminder-urile È™i alertele
            verificaReminderePendente();
            verificaAlerteAbonati();
            verificaAlerteProgramari();
            verificaAlerteRemindere();
            
            showSyncIndicator();
        }

        // Add event listeners to nav links
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const sectionId = link.getAttribute('data-section');
                if (sectionId) {
                    showSection(sectionId);
                }
            });
        });

        // Notification system
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');

            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }

        // FUNCÈšII PENTRU NOTIFICÄ‚RI INDIVIDUALE
        async function trimiteNotificareExpirare(idAbonat) {
            const abonat = abonati.find(a => a.id === idAbonat);
            if (!abonat) return;
            
            const rezultat = await notificaExpirareRevizie(abonat);
            if (rezultat.success) {
                // MarcheazÄƒ notificarea ca trimisÄƒ
                abonat.ultimaNotificare = new Date().toISOString();
                abonat.numarNotificari = (abonat.numarNotificari || 0) + 1;
                saveData();
                
                // AfiÈ™eazÄƒ mesajul È™i Ã®n interfaÈ›Äƒ
                afiseazaMesajInInterfata('SMS Expirare Trimis', 
                    messageTemplates.expirareRevizie(
                        abonat.nume, 
                        Math.ceil((new Date(abonat.dataExpirare) - new Date()) / (1000 * 60 * 60 * 24)),
                        abonat.serviciiContractate ? abonat.serviciiContractate.join(', ') : 'servicii'
                    )
                );
                
                // SincronizeazÄƒ cu Firebase
                if (db) {
                    await salveazaInFirestore('subscribers', abonat.id, abonat);
                }
                
                updateListaAbonati();
            }
        }

        // FUNCÈšIE NOUÄ‚ PENTRU WHATSAPP EXPIRARE
        function trimiteWhatsAppExpirare(idAbonat) {
            const abonat = abonati.find(a => a.id === idAbonat);
            if (!abonat) return;
            
            const servicii = abonat.serviciiContractate ? abonat.serviciiContractate.join(', ') : 'servicii contractate';
            const dataExpirare = new Date(abonat.dataExpirare);
            const astazi = new Date();
            const zileRamase = Math.ceil((dataExpirare - astazi) / (1000 * 60 * 60 * 24));
            
            const mesaj = messageTemplates.expirareRevizie(abonat.nume, zileRamase, servicii);
            
            // Trimite pe WhatsApp
            trimiteWhatsApp(abonat.telefon, mesaj);
            
            // MarcheazÄƒ ca trimis
            abonat.ultimaNotificare = new Date().toISOString();
            abonat.numarNotificari = (abonat.numarNotificari || 0) + 1;
            saveData();
            
            updateListaAbonati();
        }

        // FUNCÈšIE PENTRU WHATSAPP EXPIRARE/PLATÄ‚
        function trimiteWhatsAppReminder(idAbonat, tipReminder, detalii) {
            const abonat = abonati.find(a => a.id === idAbonat);
            if (!abonat) return;
            
            let mesajReminder = '';
            
            // Mesaje pentru expirÄƒri
            if (tipReminder.includes('Expirare') || tipReminder.includes('Verificare') || tipReminder.includes('Revizie')) {
                const servicii = abonat.serviciiContractate ? abonat.serviciiContractate.join(', ') : 'serviciile contractate';
                
                if (detalii.includes('Expirat')) {
                    mesajReminder = `ğŸš¨ URGENT - ${CONFIGURARI_FIRMA.nume}\n\n` +
                        `BunÄƒ ziua ${abonat.nume}!\n\n` +
                        `Verificarea/Revizia pentru ${servicii} a EXPIRAT.\n\n` +
                        `ğŸ”§ Pentru reprogramare urgentÄƒ:\n` +
                        `ğŸ“ SunaÈ›i la ${CONFIGURARI_FIRMA.telefon}\n\n` +
                        `Este obligatoriu sÄƒ refaceÈ›i verificarea conform legii!\n\n` +
                        `${CONFIGURARI_FIRMA.nume}`;
                } else {
                    const zileText = detalii.includes('30') ? '30 de zile' : '7 zile';
                    mesajReminder = messageTemplates.expirareRevizie(abonat.nume, zileText, servicii);
                }
            }
            
            // Mesaje pentru plÄƒÈ›i
            else if (tipReminder.includes('PlatÄƒ') || tipReminder.includes('Facturare')) {
                let costTotal = 0;
                if (abonat.serviciiContractate) {
                    abonat.serviciiContractate.forEach(serviciu => {
                        switch(serviciu) {
                            case 'Verificare InstalaÈ›ie Gaz': costTotal += 150; break;
                            case 'Revizie InstalaÈ›ie Gaz': costTotal += 250; break;
                            case 'Verificare CentralÄƒ': costTotal += 150; break;
                            case 'InstalaÈ›ii Gaz + CentralÄƒ': costTotal += 250; break;
                        }
                    });
                }
                const servicii = abonat.serviciiContractate ? abonat.serviciiContractate.join(', ') : 'serviciile efectuate';
                mesajReminder = messageTemplates.plataPendenta(abonat.nume, costTotal, servicii);
            }
            
            // Mesaje generale
            else {
                mesajReminder = `ğŸ“‹ ${CONFIGURARI_FIRMA.nume}\n\n` +
                    `BunÄƒ ziua ${abonat.nume}!\n\n` +
                    `Reminder: ${tipReminder}\n` +
                    `Detalii: ${detalii}\n\n` +
                    `Pentru informaÈ›ii:\nğŸ“ ${CONFIGURARI_FIRMA.telefon}\n\n` +
                    `${CONFIGURARI_FIRMA.nume}`;
            }
            
            trimiteWhatsApp(abonat.telefon, mesajReminder);
            
            // MarcheazÄƒ ca trimis
            abonat.ultimaNotificare = new Date().toISOString();
            abonat.numarNotificari = (abonat.numarNotificari || 0) + 1;
            saveData();
            
            updateListaAbonati();
        }

        async function trimiteNotificarePlata(idAbonat) {
            const abonat = abonati.find(a => a.id === idAbonat);
            if (!abonat) return;
            
            const rezultat = await notificaPlata(abonat);
            if (rezultat.success) {
                abonat.ultimaNotificare = new Date().toISOString();
                abonat.numarNotificari = (abonat.numarNotificari || 0) + 1;
                saveData();
                
                // AfiÈ™eazÄƒ mesajul È™i Ã®n interfaÈ›Äƒ
                let costTotal = 0;
                if (abonat.serviciiContractate) {
                    abonat.serviciiContractate.forEach(serviciu => {
                        switch(serviciu) {
                            case 'Verificare InstalaÈ›ie Gaz': costTotal += 150; break;
                            case 'Revizie InstalaÈ›ie Gaz': costTotal += 250; break;
                            case 'Verificare CentralÄƒ': costTotal += 150; break;
                            case 'InstalaÈ›ii Gaz + CentralÄƒ': costTotal += 250; break;
                        }
                    });
                }
                
                afiseazaMesajInInterfata('Notificare PlatÄƒ TrimisÄƒ', 
                    messageTemplates.plataPendenta(
                        abonat.nume, 
                        costTotal,
                        abonat.serviciiContractate ? abonat.serviciiContractate.join(', ') : 'servicii'
                    )
                );
                
                if (db) {
                    await salveazaInFirestore('subscribers', abonat.id, abonat);
                }
                
                updateListaAbonati();
            }
        }

        // FuncÈ›ie pentru afiÈ™area mesajului Ã®n interfaÈ›Äƒ
        function afiseazaMesajInInterfata(titlu, mesaj) {
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed; z-index: 3000; left: 0; top: 0; 
                width: 100%; height: 100%; background: rgba(0,0,0,0.5);
                display: flex; align-items: center; justify-content: center;
            `;
            
            modal.innerHTML = `
                <div style="background: white; padding: 30px; border-radius: 16px; max-width: 500px; max-height: 80vh; overflow-y: auto;">
                    <h3 style="color: #2d3748; margin-bottom: 20px;">ğŸ“± ${titlu}</h3>
                    <div style="background: #f7fafc; padding: 15px; border-radius: 8px; border-left: 4px solid #4299e1; white-space: pre-line; font-family: monospace; font-size: 14px; color: #2d3748;">
${mesaj}
                    </div>
                    <div style="margin-top: 20px; text-align: right;">
                        <button onclick="this.closest('.modal-overlay').remove()" style="padding: 10px 20px; background: #4299e1; color: white; border: none; border-radius: 6px; cursor: pointer;">Ãnchide</button>
                    </div>
                </div>
            `;
            
            modal.className = 'modal-overlay';
            modal.onclick = (e) => {
                if (e.target === modal) {
                    modal.remove();
                }
            };
            
            document.body.appendChild(modal);
            
            // Auto-remove dupÄƒ 10 secunde
            setTimeout(() => {
                if (modal && modal.parentNode) {
                    modal.remove();
                }
            }, 10000);
        }

        // FUNCÈšII PENTRU NOTIFICÄ‚RI ÃN MASÄ‚
        async function trimiteNotificariInMasa() {
            if (!confirm('TrimiteÈ›i notificÄƒri pentru toate reviziile care expirÄƒ Ã®n urmÄƒtoarele 30 de zile?')) {
                return;
            }
            
            const astazi = new Date();
            const in30Zile = new Date(astazi.getTime() + 30 * 24 * 60 * 60 * 1000);
            
            const abonatiDeNotificat = abonati.filter(abonat => {
                if (!abonat.dataExpirare) return false;
                const dataExp = new Date(abonat.dataExpirare);
                return dataExp >= astazi && dataExp <= in30Zile;
            });
            
            if (abonatiDeNotificat.length === 0) {
                showNotification('Nu existÄƒ abonaÈ›i cu revizii care expirÄƒ Ã®n urmÄƒtoarele 30 de zile', 'info');
                return;
            }
            
            showNotification(`ğŸ“± Trimitere ${abonatiDeNotificat.length} notificÄƒri...`, 'info');
            
            let trimiseCuSucces = 0;
            for (const abonat of abonatiDeNotificat) {
                const rezultat = await notificaExpirareRevizie(abonat);
                if (rezultat.success) {
                    abonat.ultimaNotificare = new Date().toISOString();
                    abonat.numarNotificari = (abonat.numarNotificari || 0) + 1;
                    trimiseCuSucces++;
                }
                
                // PauzÄƒ Ã®ntre notificÄƒri pentru a nu supraÃ®ncÄƒrca sistemul
                await new Promise(resolve => setTimeout(resolve, 500));
            }
            
            saveData();
            showNotification(`âœ… ${trimiseCuSucces}/${abonatiDeNotificat.length} notificÄƒri trimise cu succes!`, 'success');
        }

        // FUNCÈšIE TEST WHATSAPP
        function testeazaWhatsApp() {
            const mesajTest = `ğŸ§ª Test WhatsApp - ${CONFIGURARI_FIRMA.nume}\n\n` +
                `Acesta este un mesaj de test pentru a verifica funcÈ›ionarea WhatsApp.\n\n` +
                `DacÄƒ primiÈ›i acest mesaj, sistemul funcÈ›ioneazÄƒ corect!\n\n` +
                `ğŸ“ ${CONFIGURARI_FIRMA.telefon}\n` +
                `${CONFIGURARI_FIRMA.nume}`;
            
            // FoloseÈ™te numÄƒrul firmei pentru test
            trimiteWhatsApp(CONFIGURARI_FIRMA.telefon, mesajTest);
        }

        // FuncÈ›ie pentru actualizarea valorilor Ã®n interfaÈ›Äƒ
        function actualizeazaInterfata() {
            // ActualizeazÄƒ telefonul firmei Ã®n toate locurile
            const telefonElements = document.querySelectorAll('#telefonFirma, #telefonAlert1');
            telefonElements.forEach(element => {
                if (element) {
                    element.textContent = CONFIGURARI_FIRMA.telefon;
                }
            });

            // ActualizeazÄƒ exemplele de mesaje
            actualizeazaExempleMesaje();
        }

        // FuncÈ›ie pentru actualizarea exemplelor de mesaje
        function actualizeazaExempleMesaje() {
            // GÄƒseÈ™te containerul exemplelor Ã®n Dashboard
            setTimeout(() => {
                const containerExemple = Array.from(document.querySelectorAll('h3')).find(h3 => 
                    h3.textContent.includes('Exemple Mesaje')
                );
                
                if (containerExemple) {
                    const parentContainer = containerExemple.parentElement;
                    
                    // GÄƒseÈ™te grid-ul cu exemple
                    const gridExemple = parentContainer.querySelector('div[style*="display: grid"]');
                    if (gridExemple) {
                        gridExemple.innerHTML = `
                            <div style="background: #f7fafc; padding: 15px; border-radius: 8px; border-left: 4px solid #4299e1;">
                                <h4 style="color: #2b6cb0; margin-bottom: 10px;">ğŸ”” Expirare Revizie (7 zile)</h4>
                                <div style="background: white; padding: 10px; border-radius: 6px; font-size: 13px; color: #4a5568; white-space: pre-line;">ğŸ”” BunÄƒ ziua Popescu Ion!

Revizia dumneavoastrÄƒ pentru Verificare InstalaÈ›ie Gaz expirÄƒ Ã®n 7 zile.

Pentru reprogramare, sunaÈ›i la ğŸ“ ${CONFIGURARI_FIRMA.telefon}

${CONFIGURARI_FIRMA.nume} - Servicii profesionale de instalaÈ›ii gaz</div>
                            </div>
                            <div style="background: #fef5e7; padding: 15px; border-radius: 8px; border-left: 4px solid #ed8936;">
                                <h4 style="color: #c05621; margin-bottom: 10px;">ğŸ’° PlatÄƒ PendentÄƒ</h4>
                                <div style="background: white; padding: 10px; border-radius: 6px; font-size: 13px; color: #4a5568; white-space: pre-line;">ğŸ’° BunÄƒ ziua Ionescu Maria!

AveÈ›i de plÄƒtit suma de 250 Lei pentru:
Revizie InstalaÈ›ie Gaz

Pentru platÄƒ: ğŸ“ ${CONFIGURARI_FIRMA.telefon}

${CONFIGURARI_FIRMA.nume} - MulÈ›umim!</div>
                            </div>
                            <div style="background: #f0fff4; padding: 15px; border-radius: 8px; border-left: 4px solid #38a169;">
                                <h4 style="color: #22543d; margin-bottom: 10px;">âœ… Confirmare Programare</h4>
                                <div style="background: white; padding: 10px; border-radius: 6px; font-size: 13px; color: #4a5568; white-space: pre-line;">âœ… BunÄƒ ziua Georgescu Andrei!

ConfirmÄƒm programarea pentru Verificare CentralÄƒ
ğŸ“… Data: 15.12.2024 10:00
ğŸ“ Adresa: Alexandria, Str. LibertÄƒÈ›ii 12

InformaÈ›ii: ğŸ“ ${CONFIGURARI_FIRMA.telefon}
${CONFIGURARI_FIRMA.nume}</div>
                            </div>
                            <div style="background: #fed7d7; padding: 15px; border-radius: 8px; border-left: 4px solid #f56565;">
                                <h4 style="color: #742a2a; margin-bottom: 10px;">ğŸš¨ Expirare URGENTÄ‚ (WhatsApp)</h4>
                                <div style="background: white; padding: 10px; border-radius: 6px; font-size: 13px; color: #4a5568; white-space: pre-line;">ğŸš¨ URGENT - ${CONFIGURARI_FIRMA.nume}

BunÄƒ ziua Popescu Ion!

Verificarea/Revizia pentru Verificare InstalaÈ›ie Gaz a EXPIRAT.

ğŸ”§ Pentru reprogramare urgentÄƒ:
ğŸ“ SunaÈ›i la ${CONFIGURARI_FIRMA.telefon}

Este obligatoriu sÄƒ refaceÈ›i verificarea conform legii!

${CONFIGURARI_FIRMA.nume}</div>
                            </div>
                        `;
                    }
                }
            }, 1000); // AÈ™teptÄƒ ca DOM-ul sÄƒ fie complet Ã®ncÄƒrcat
        }

        // Verificare status Firebase
        function verificaStatusFirebase() {
            const statusElement = document.getElementById('firebaseStatus');
            if (statusElement) {
                if (db) {
                    statusElement.textContent = 'âœ… Conectat';
                    statusElement.style.color = '#22543d';
                } else {
                    statusElement.textContent = 'âŒ Offline';
                    statusElement.style.color = '#742a2a';
                }
            }
        }

        // ÃncÄƒrcare iniÈ›ialÄƒ din Firebase
        async function incarcareInitialaDinFirebase() {
            if (!db) return;
            
            try {
                showNotification('ğŸ”„ ÃncÄƒrcare date din Firebase...', 'info');
                
                const [firestoreAbonati, firestoreProgramari, firestoreRemindere] = await Promise.all([
                    incarcaDinFirestore('subscribers'),
                    incarcaDinFirestore('appointments'),
                    incarcaDinFirestore('reminders')
                ]);
                
                // ÃmbinÄƒ datele locale cu cele din Firebase (prioritate Firebase)
                if (firestoreAbonati.length > 0) {
                    abonati = firestoreAbonati;
                }
                
                if (firestoreProgramari.length > 0) {
                    programari = firestoreProgramari;
                }
                
                if (firestoreRemindere.length > 0) {
                    remindere = firestoreRemindere;
                }
                
                // SalveazÄƒ local datele actualizate
                localStorage.setItem('abonati', JSON.stringify(abonati));
                localStorage.setItem('programari', JSON.stringify(programari));
                localStorage.setItem('remindere', JSON.stringify(remindere));
                
                showNotification('âœ… Date Ã®ncÄƒrcate din Firebase!', 'success');
                
            } catch (error) {
                console.error('âŒ Eroare Ã®ncÄƒrcare Firebase:', error);
                showNotification('âš ï¸ Eroare Ã®ncÄƒrcare Firebase - se folosesc datele locale', 'warning');
            }
        }

        // Modificare funcÈ›ia saveData pentru a include Firebase
        function saveData() {
            localStorage.setItem('abonati', JSON.stringify(abonati));
            localStorage.setItem('programari', JSON.stringify(programari));
            localStorage.setItem('remindere', JSON.stringify(remindere));
            
            // Sincronizare automatÄƒ cu Firebase
            if (db) {
                setTimeout(() => {
                    sincronizareCuFirestore();
                }, 500);
            }
            
            // Sincronizare automatÄƒ dupÄƒ salvare
            setTimeout(() => {
                sincronizeazaDatele();
            }, 100);
        }

        // Get selected services
        function getServiciiSelectate() {
            const servicii = [];
            const checkboxes = document.querySelectorAll('#serviciu_verificare_gaz, #serviciu_revizie_gaz, #serviciu_verificare_centrala, #serviciu_pachet_complet');
            
            checkboxes.forEach(checkbox => {
                if (checkbox.checked) {
                    servicii.push(checkbox.value);
                }
            });
            
            return servicii;
        }

        // Get total cost of selected services
        function calculeazaCostTotal() {
            const servicii = getServiciiSelectate();
            let costTotal = 0;
            
            servicii.forEach(serviciu => {
                switch(serviciu) {
                    case 'Verificare InstalaÈ›ie Gaz':
                        costTotal += 150;
                        break;
                    case 'Revizie InstalaÈ›ie Gaz':
                        costTotal += 250;
                        break;
                    case 'Verificare CentralÄƒ':
                        costTotal += 150;
                        break;
                    case 'InstalaÈ›ii Gaz + CentralÄƒ':
                        costTotal += 250;
                        break;
                }
            });
            
            return costTotal;
        }

        // Update cost display
        function actualizareaCostului() {
            const costTotal = calculeazaCostTotal();
            const valoareElement = document.getElementById('valoareTotala');
            if (valoareElement) {
                valoareElement.textContent = costTotal;
                
                // Add animation when cost changes
                if (costTotal > 0) {
                    valoareElement.style.color = '#38a169';
                    valoareElement.style.fontSize = '20px';
                } else {
                    valoareElement.style.color = '#2c7a7b';
                    valoareElement.style.fontSize = '18px';
                }
            }
        }

        // Add event listeners for cost calculation
        function adaugaListeneriCost() {
            const checkboxes = document.querySelectorAll('#serviciu_verificare_gaz, #serviciu_revizie_gaz, #serviciu_verificare_centrala, #serviciu_pachet_complet');
            checkboxes.forEach(checkbox => {
                checkbox.addEventListener('change', actualizareaCostului);
            });
        }

        // Create automatic reminder for revision
        function creeazaReminderAutomat(abonat) {
            if (!abonat.dataUrmatoareaRevizie || !abonat.zileNotificare) return;

            const dataUrmatoarei = new Date(abonat.dataUrmatoareaRevizie);
            const dataReminder = new Date(dataUrmatoarei);
            dataReminder.setDate(dataReminder.getDate() - parseInt(abonat.zileNotificare));

            // VerificÄƒ dacÄƒ data reminder-ului nu a trecut deja
            if (dataReminder > new Date()) {
                // CalculeazÄƒ costul total
                let costTotal = 0;
                if (abonat.serviciiContractate) {
                    abonat.serviciiContractate.forEach(serviciu => {
                        switch(serviciu) {
                            case 'Verificare InstalaÈ›ie Gaz': costTotal += 150; break;
                            case 'Revizie InstalaÈ›ie Gaz': costTotal += 250; break;
                            case 'Verificare CentralÄƒ': costTotal += 150; break;
                            case 'InstalaÈ›ii Gaz + CentralÄƒ': costTotal += 250; break;
                        }
                    });
                }

                const reminderAutomat = {
                    id: Date.now() + Math.random(),
                    clientId: abonat.id,
                    clientNume: abonat.nume,
                    tip: 'Verificare/Revizie AutomatÄƒ',
                    data: dataReminder.toISOString(),
                    prioritate: 'ÃnaltÄƒ',
                    mesaj: `REVIZIE EXPIRING pentru ${abonat.nume} - Servicii: ${abonat.serviciiContractate.join(', ')} - Cost total: ${costTotal} Lei - Adresa: ${formatareAdresa(abonat.adresa)} - Tel: ${abonat.telefon}`,
                    status: 'Activ',
                    tipAutomat: 'revizie',
                    dataCreare: new Date().toISOString()
                };

                remindere.push(reminderAutomat);
                
                // CreeazÄƒ È™i programarea automatÄƒ
                const programareAutomata = {
                    id: Date.now() + Math.random() + 1,
                    clientId: abonat.id,
                    clientNume: abonat.nume,
                    tipServiciu: 'Verificare/Revizie ProgramatÄƒ',
                    data: abonat.dataUrmatoareaRevizie,
                    status: 'ProgramatÄƒ',
                    observatii: `Revizie automatÄƒ - Servicii: ${abonat.serviciiContractate.join(', ')} - Cost: ${costTotal} Lei - Valabilitate: 2 ani`,
                    tipAutomat: 'revizie',
                    dataCreare: new Date().toISOString()
                };

                programari.push(programareAutomata);
            }
        }

        function formatareAdresa(adresa) {
            let adresaCompleta = adresa.oras;
            if (adresa.strada) adresaCompleta += `, ${adresa.strada}`;
            if (adresa.numar) adresaCompleta += ` ${adresa.numar}`;
            if (adresa.numeBlocAbonat) adresaCompleta += `, ${adresa.numeBlocAbonat}`;
            if (adresa.scara) adresaCompleta += `, Sc. ${adresa.scara}`;
            if (adresa.etaj) adresaCompleta += `, Et. ${adresa.etaj}`;
            if (adresa.apartament) adresaCompleta += `, Ap. ${adresa.apartament}`;
            return adresaCompleta;
        }

        // FUNCÈšII DE VERIFICARE ALERTE SPECIFICE
        function verificaAlerteAbonati() {
            const alerteContainer = document.getElementById('alerteAbonati');
            let alerteHtml = '';

            // VerificÄƒ abonaÈ›ii fÄƒrÄƒ documente
            const abonatiLipsaDocumente = abonati.filter(abonat => !abonat.documente || abonat.documente.length === 0);
            
            // VerificÄƒ expirÄƒri Ã®n urmÄƒtoarele 30 de zile
            const astazi = new Date();
            const in30Zile = new Date(astazi.getTime() + 30 * 24 * 60 * 60 * 1000);
            const expiraInCurand = abonati.filter(abonat => {
                if (!abonat.dataExpirare) return false;
                const dataExp = new Date(abonat.dataExpirare);
                return dataExp >= astazi && dataExp <= in30Zile;
            });

            if (abonatiLipsaDocumente.length > 0) {
                alerteHtml += `
                    <div class="alert alert-warning">
                        <strong>ğŸ“ Documente LipsÄƒ!</strong> ${abonatiLipsaDocumente.length} abonaÈ›i nu au documente Ã®ncÄƒrcate.
                    </div>
                `;
            }

            if (expiraInCurand.length > 0) {
                alerteHtml += `
                    <div class="alert alert-danger">
                        <strong>âš ï¸ ExpirÄƒri Ã®n 30 zile!</strong> ${expiraInCurand.length} revizii expirÄƒ Ã®n urmÄƒtoarele 30 de zile.
                    </div>
                `;
            }

            if (alerteContainer) {
                alerteContainer.innerHTML = alerteHtml;
            }
        }

        function verificaAlerteProgramari() {
            const alerteContainer = document.getElementById('alerteProgramari');
            let alerteHtml = '';

            const astazi = new Date();
            const programariAstazi = programari.filter(p => {
                const dataProgramare = new Date(p.data);
                return dataProgramare.toDateString() === astazi.toDateString() && p.status === 'ProgramatÄƒ';
            });

            if (programariAstazi.length > 0) {
                alerteHtml += `
                    <div class="alert alert-info">
                        <strong>ğŸ“… ProgramÄƒri AstÄƒzi!</strong> Ai ${programariAstazi.length} programÄƒri pentru astÄƒzi.
                    </div>
                `;
            }

            if (alerteContainer) {
                alerteContainer.innerHTML = alerteHtml;
            }
        }

        function verificaAlerteRemindere() {
            const alerteContainer = document.getElementById('alerteRemindere');
            let alerteHtml = '';

            const astazi = new Date();
            const remindereUrgente = remindere.filter(r => {
                const dataReminder = new Date(r.data);
                const diferenta = Math.ceil((dataReminder - astazi) / (1000 * 60 * 60 * 24));
                return diferenta >= 0 && diferenta <= 1 && r.status === 'Activ';
            });

            if (remindereUrgente.length > 0) {
                alerteHtml += `
                    <div class="alert alert-warning">
                        <strong>ğŸ”” Remindere Urgente!</strong> ${remindereUrgente.length} remindere expirÄƒ Ã®n urmÄƒtoarele 24 ore.
                    </div>
                `;
            }

            if (alerteContainer) {
                alerteContainer.innerHTML = alerteHtml;
            }
        }

        // AbonaÈ›i Functions
        function adaugaAbonat() {
            const tipClient = document.getElementById('tipClient').value;
            const nume = document.getElementById('numeAbonat').value.trim();
            const telefon = document.getElementById('telefonAbonat').value.trim();
            const email = document.getElementById('emailAbonat').value.trim();
            const cnp = document.getElementById('cnpAbonat').value.trim();
            const oras = document.getElementById('orasAbonat').value;
            const strada = document.getElementById('stradaAbonat').value.trim();
            const numar = document.getElementById('numarAbonat').value.trim();
            const tipAdresa = document.getElementById('tipAdresa').value;
            const numeBlocAbonat = document.getElementById('numeBlocAbonat').value.trim();
            const scara = document.getElementById('scaraAbonat').value.trim();
            const etaj = document.getElementById('etajAbonat').value.trim();
            const apartament = document.getElementById('apartamentAbonat').value.trim();
            const dataRevizieEfectuata = document.getElementById('dataRevizieEfectuata').value;
            const dataExpirare = document.getElementById('dataExpirare').value;
            const dataPrimaRevizie = document.getElementById('dataPrimaRevizie').value;
            const periodicitateRevizie = document.getElementById('periodicitateRevizie').value;
            const dataUrmatoareaRevizie = document.getElementById('dataUrmatoareaRevizie').value;
            const zileNotificare = document.getElementById('zileNotificare').value;
            const serviciiContractate = getServiciiSelectate();

            if (!tipClient) {
                showNotification('Te rog selecteazÄƒ tipul clientului!', 'warning');
                return;
            }

            if (!nume || !telefon || !oras) {
                showNotification('Te rog completeazÄƒ toate cÃ¢mpurile obligatorii!', 'warning');
                return;
            }

            // VerificÄƒ dacÄƒ abonatul existÄƒ deja
            const abonatExistent = abonati.find(abonat => 
                abonat.telefon === telefon || (cnp && abonat.cnp === cnp)
            );

            if (abonatExistent) {
                showNotification('Abonatul existÄƒ deja Ã®n baza de date!', 'error');
                return;
            }

            const abonatNou = {
                id: Date.now(),
                tipClient,
                nume,
                telefon,
                email,
                cnp,
                adresa: {
                    oras,
                    strada,
                    numar,
                    tipAdresa,
                    numeBlocAbonat,
                    scara,
                    etaj,
                    apartament
                },
                serviciiContractate,
                dataRevizieEfectuata,
                dataExpirare,
                dataPrimaRevizie,
                periodicitateRevizie,
                dataUrmatoareaRevizie,
                zileNotificare,
                documente: [...documenteTemp], // AdaugÄƒ documentele Ã®ncÄƒrcate
                dataCreare: new Date().toISOString(),
                status: 'Activ'
            };

            abonati.push(abonatNou);

            // CreeazÄƒ reminder È™i programare automatÄƒ pentru revizie
            if (dataUrmatoareaRevizie && zileNotificare) {
                creeazaReminderAutomat(abonatNou);
            }

            <!-- NOTIFICARE AUTOMATÄ‚ PENTRU ABONAT NOU -->
            setTimeout(async () => {
                const servicii = serviciiContractate.join(', ');
                const mesaj = messageTemplates.abonatNou(nume, servicii);
                
                console.log('ğŸ“± MESAJ ABONAT NOU:');
                console.log('='.repeat(50));
                console.log(mesaj);
                console.log('='.repeat(50));
                
                await trimiteNotificare(telefon, mesaj, 'SMS');
                abonatNou.numarNotificari = 1;
                abonatNou.ultimaNotificare = new Date().toISOString();
                saveData();
            }, 1000);

            saveData();
            resetFormAbonat();
            
            const costTotal = calculeazaCostTotal();
            showNotification(`Abonatul ${nume} a fost adÄƒugat cu succes! ${documenteTemp.length > 0 ? `(${documenteTemp.length} documente Ã®ncÄƒrcate)` : ''} ${dataUrmatoareaRevizie ? 'Reminder È™i programare automatÄƒ create!' : ''} ğŸ“± Notificare trimisÄƒ!`, 'success');
        }

        function resetFormAbonat() {
            document.getElementById('tipClient').value = '';
            document.getElementById('numeAbonat').value = '';
            document.getElementById('telefonAbonat').value = '';
            document.getElementById('emailAbonat').value = '';
            document.getElementById('cnpAbonat').value = '';
            document.getElementById('orasAbonat').value = '';
            document.getElementById('stradaAbonat').value = '';
            document.getElementById('numarAbonat').value = '';
            document.getElementById('tipAdresa').value = '';
            document.getElementById('numeBlocAbonat').value = '';
            document.getElementById('scaraAbonat').value = '';
            document.getElementById('etajAbonat').value = '';
            document.getElementById('apartamentAbonat').value = '';
            document.getElementById('dataRevizieEfectuata').value = '';
            document.getElementById('dataExpirare').value = '';
            document.getElementById('dataPrimaRevizie').value = '';
            document.getElementById('periodicitateRevizie').value = '2';
            document.getElementById('dataUrmatoareaRevizie').value = '';
            document.getElementById('zileNotificare').value = '2';
            
            // Reset checkboxes
            document.querySelectorAll('#serviciu_verificare_gaz, #serviciu_revizie_gaz, #serviciu_verificare_centrala, #serviciu_pachet_complet').forEach(checkbox => {
                checkbox.checked = false;
            });
            
            // Reset documente
            documenteTemp = [];
            afiseazaListaFisiere();
            
            // Reset cost display
            actualizareaCostului();
        }

        function updateListaAbonati() {
            const container = document.getElementById('listaAbonati');
            
            if (abonati.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ‘¥</div>
                        <h3>Nu existÄƒ abonaÈ›i Ã®nregistraÈ›i</h3>
                        <p>AdaugÄƒ primul abonat folosind formularul de mai jos.</p>
                    </div>
                `;
                return;
            }

            let html = `
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Nume</th>
                            <th>Telefon</th>
                            <th>AdresÄƒ</th>
                            <th>Servicii</th>
                            <th>Data Revizie</th>
                            <th>Data Expirare</th>
                            <th>Documente & AcÈ›iuni</th>
                            <th>NotificÄƒri Trimise</th>
                            <th>Status</th>
                            <th>Editare</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            abonati.forEach(abonat => {
                const adresaCompleta = formatareAdresa(abonat.adresa);
                const servicii = abonat.serviciiContractate ? abonat.serviciiContractate.join(', ') : '-';
                const dataRevizie = abonat.dataRevizieEfectuata ? new Date(abonat.dataRevizieEfectuata).toLocaleDateString('ro-RO') : '-';
                const dataExpirare = abonat.dataExpirare ? new Date(abonat.dataExpirare).toLocaleDateString('ro-RO') : '-';
                const numarDocumente = abonat.documente ? abonat.documente.length : 0;
                
                // VerificÄƒ dacÄƒ revizia expirÄƒ Ã®n curÃ¢nd
                let statusExpirare = 'status-active';
                if (abonat.dataExpirare) {
                    const expirare = new Date(abonat.dataExpirare);
                    const astazi = new Date();
                    const zilePanaLaExpirare = Math.ceil((expirare - astazi) / (1000 * 60 * 60 * 24));
                    
                    if (zilePanaLaExpirare < 0) {
                        statusExpirare = 'status-urgent'; // Expirat
                    } else if (zilePanaLaExpirare <= 30) {
                        statusExpirare = 'status-inactive'; // ExpirÄƒ Ã®n 30 zile
                    } else if (zilePanaLaExpirare <= 90) {
                        statusExpirare = 'status-pending'; // ExpirÄƒ Ã®n 90 zile
                    }
                }
                
                html += `
                    <tr>
                        <td><strong>${abonat.nume}</strong><br><small>${abonat.email || ''}</small></td>
                        <td>${abonat.telefon}</td>
                        <td><small>${adresaCompleta}</small></td>
                        <td><small>${servicii}</small></td>
                        <td><small>${dataRevizie}</small></td>
                        <td><span class="status-badge ${statusExpirare}"><small>${dataExpirare}</small></span></td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn btn-secondary btn-small" onclick="gestioneazaDocumente(${abonat.id})" title="GestioneazÄƒ documente">
                                    ğŸ“ ${numarDocumente}
                                </button>
                                <button class="btn btn-primary btn-small" onclick="trimiteNotificareExpirare(${abonat.id})" title="ğŸ“± SMS Expirare">
                                    ğŸ“± SMS
                                </button>
                                <button class="btn btn-success btn-small" onclick="trimiteWhatsAppExpirare(${abonat.id})" title="ğŸ’¬ WhatsApp Expirare" style="background: #25d366; color: white;">
                                    ğŸ’¬ WA
                                </button>
                                <button class="btn btn-warning btn-small" onclick="trimiteNotificarePlata(${abonat.id})" title="ğŸ’° Notificare platÄƒ" style="background: #f6ad55; color: white;">
                                    ğŸ’°
                                </button>
                            </div>
                        </td>
                        <td>
                            <div style="text-align: center;">
                                <span class="status-badge status-pending" style="font-size: 10px;">
                                    ğŸ“± ${abonat.numarNotificari || 0}
                                </span>
                                ${abonat.ultimaNotificare ? `<br><small style="color: #718096; font-size: 10px;">${new Date(abonat.ultimaNotificare).toLocaleDateString('ro-RO')}</small>` : ''}
                            </div>
                        </td>
                        <td><span class="status-badge status-active">${abonat.status}</span></td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn btn-secondary btn-small" onclick="editaAbonat(${abonat.id})" title="EditeazÄƒ">âœï¸</button>
                                <button class="btn btn-danger btn-small" onclick="stergeAbonat(${abonat.id})" title="È˜terge">ğŸ—‘ï¸</button>
                            </div>
                        </td>
                    </tr>
                `;
            });

            html += '</tbody></table>';
            container.innerHTML = html;
        }

        function stergeAbonat(id) {
            if (confirm('EÈ™ti sigur cÄƒ vrei sÄƒ È™tergi acest abonat? Vor fi È™terse È™i programÄƒrile È™i reminder-urile asociate.')) {
                abonati = abonati.filter(abonat => abonat.id !== id);
                programari = programari.filter(programare => programare.clientId != id);
                remindere = remindere.filter(reminder => reminder.clientId != id);
                saveData();
                showNotification('Abonatul È™i datele asociate au fost È™terse cu succes!', 'success');
            }
        }

        // Update client dropdowns with SYNC
        function updateClientDropdowns() {
            const dropdowns = ['clientProgramare', 'clientReminder'];
            
            dropdowns.forEach(dropdownId => {
                const dropdown = document.getElementById(dropdownId);
                if (dropdown) {
                    const currentValue = dropdown.value; // PÄƒstreazÄƒ valoarea selectatÄƒ
                    let html = '<option value="">SelecteazÄƒ clientul</option><option value="nou">â• Client Nou</option>';
                    
                    abonati.forEach(abonat => {
                        html += `<option value="${abonat.id}" ${currentValue == abonat.id ? 'selected' : ''}>${abonat.nume} - ${abonat.telefon}</option>`;
                    });
                    
                    dropdown.innerHTML = html;
                }
            });
        }

        // ProgramÄƒri Functions
        function adaugaProgramare() {
            const clientId = document.getElementById('clientProgramare').value;
            const tipServiciu = document.getElementById('tipServiciu').value;
            const data = document.getElementById('dataProgramare').value;
            const status = document.getElementById('statusProgramare').value;
            const observatii = document.getElementById('observatiiProgramare').value.trim();

            if (!clientId || !tipServiciu || !data) {
                showNotification('Te rog completeazÄƒ toate cÃ¢mpurile obligatorii!', 'warning');
                return;
            }

            const programareNoua = {
                id: Date.now(),
                clientId,
                clientNume: clientId === 'nou' ? 'Client Nou' : abonati.find(a => a.id == clientId)?.nume || 'Client Necunoscut',
                tipServiciu,
                data,
                status,
                observatii,
                dataCreare: new Date().toISOString()
            };

            programari.push(programareNoua);

            // NOTIFICARE AUTOMATÄ‚ PENTRU PROGRAMARE
            setTimeout(async () => {
                if (clientId !== 'nou') {
                    await confirmareProgramare(programareNoua);
                }
            }, 500);

            saveData();
            resetFormProgramare();
            
            showNotification('Programarea a fost adÄƒugatÄƒ cu succes! ğŸ“± Notificare trimisÄƒ!', 'success');
        }

        function resetFormProgramare() {
            document.getElementById('clientProgramare').value = '';
            document.getElementById('tipServiciu').value = '';
            document.getElementById('dataProgramare').value = '';
            document.getElementById('statusProgramare').value = 'ProgramatÄƒ';
            document.getElementById('observatiiProgramare').value = '';
        }

        function updateListaProgramari() {
            const container = document.getElementById('listaProgramari');
            
            if (programari.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ“…</div>
                        <h3>Nu existÄƒ programÄƒri</h3>
                        <p>AdaugÄƒ prima programare folosind formularul de mai jos.</p>
                    </div>
                `;
                return;
            }

            let html = `
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Client</th>
                            <th>Serviciu</th>
                            <th>Data</th>
                            <th>Status</th>
                            <th>ObservaÈ›ii</th>
                            <th>AcÈ›iuni</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            programari.forEach(programare => {
                const dataFormatata = new Date(programare.data).toLocaleString('ro-RO');
                const clasaUrgenta = programare.tipAutomat === 'revizie' ? 'urgent-reminder' : '';
                
                html += `
                    <tr class="${clasaUrgenta}">
                        <td><strong>${programare.clientNume}</strong></td>
                        <td>${programare.tipServiciu}${programare.tipAutomat === 'revizie' ? ' ğŸ”„' : ''}</td>
                        <td>${dataFormatata}</td>
                        <td><span class="status-badge ${getStatusClass(programare.status)}">${programare.status}</span></td>
                        <td><small>${programare.observatii || '-'}</small></td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn btn-secondary btn-small" onclick="editaProgramare(${programare.id})" title="EditeazÄƒ">âœï¸</button>
                                <button class="btn btn-danger btn-small" onclick="stergeProgramare(${programare.id})" title="È˜terge">ğŸ—‘ï¸</button>
                            </div>
                        </td>
                    </tr>
                `;
            });

            html += '</tbody></table>';
            container.innerHTML = html;
        }

        function stergeProgramare(id) {
            if (confirm('EÈ™ti sigur cÄƒ vrei sÄƒ È™tergi aceastÄƒ programare?')) {
                programari = programari.filter(programare => programare.id !== id);
                saveData();
                showNotification('Programarea a fost È™tearsÄƒ cu succes!', 'success');
            }
        }

        // Remindere Functions
        function adaugaReminder() {
            const clientId = document.getElementById('clientReminder').value;
            const tip = document.getElementById('tipReminder').value;
            const problemaSpecifica = document.getElementById('problemaSpecifica').value;
            const data = document.getElementById('dataReminder').value;
            const prioritate = document.getElementById('prioritateReminder').value;
            const mesaj = document.getElementById('mesajReminder').value.trim();

            if (!clientId || !tip || !data) {
                showNotification('Te rog completeazÄƒ toate cÃ¢mpurile obligatorii!', 'warning');
                return;
            }

            // ConstruieÈ™te mesajul final
            let mesajFinal = mesaj;
            if (problemaSpecifica) {
                mesajFinal = `${problemaSpecifica}${mesaj ? ' - ' + mesaj : ''}`;
            }

            const reminderNou = {
                id: Date.now(),
                clientId,
                clientNume: clientId === 'nou' ? 'Client Nou' : abonati.find(a => a.id == clientId)?.nume || 'Client Necunoscut',
                tip,
                problemaSpecifica: problemaSpecifica || null,
                data,
                prioritate,
                mesaj: mesajFinal,
                status: 'Activ',
                dataCreare: new Date().toISOString()
            };

            remindere.push(reminderNou);
            
            // TRIMITE AUTOMAT PE WHATSAPP DACÄ‚ E EXPIRARE URGENTÄ‚
            if ((problemaSpecifica && problemaSpecifica.includes('Expirat')) || 
                (prioritate === 'UrgentÄƒ' && (tip.includes('Verificare') || tip.includes('Revizie')))) {
                setTimeout(() => {
                    if (clientId !== 'nou') {
                        trimiteWhatsAppReminder(clientId, tip, problemaSpecifica || tip);
                    }
                }, 500);
            }

            saveData();
            resetFormReminder();
            
            const messageExtra = (problemaSpecifica && problemaSpecifica.includes('Expirat')) ? 'ğŸ“± WhatsApp trimis automat!' : '';
            showNotification(`Reminder adÄƒugat cu succes! ${messageExtra}`, 'success');
        }

        function resetFormReminder() {
            document.getElementById('clientReminder').value = '';
            document.getElementById('tipReminder').value = '';
            document.getElementById('problemaSpecifica').value = '';
            document.getElementById('dataReminder').value = '';
            document.getElementById('prioritateReminder').value = 'JoasÄƒ';
            document.getElementById('mesajReminder').value = '';
        }

        function updateListaRemindere() {
            const container = document.getElementById('listaRemindere');
            
            if (remindere.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ””</div>
                        <h3>Nu existÄƒ remindere</h3>
                        <p>AdaugÄƒ primul reminder folosind formularul de mai jos.</p>
                    </div>
                `;
                return;
            }

            let html = `
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Client</th>
                            <th>Tip</th>
                            <th>ProblemÄƒ</th>
                            <th>Data</th>
                            <th>Prioritate</th>
                            <th>Mesaj</th>
                            <th>AcÈ›iuni</th>
                        </tr>
                    </thead>
                    <tbody>
            `;

            remindere.forEach(reminder => {
                const dataFormatata = new Date(reminder.data).toLocaleString('ro-RO');
                const clasaUrgenta = reminder.tipAutomat === 'revizie' ? 'urgent-reminder' : '';
                const problemaAfisata = reminder.problemaSpecifica || '-';
                
                html += `
                    <tr class="${clasaUrgenta}">
                        <td><strong>${reminder.clientNume}</strong></td>
                        <td>${reminder.tip}${reminder.tipAutomat === 'revizie' ? ' ğŸ”„' : ''}</td>
                        <td><small style="color: ${reminder.problemaSpecifica && reminder.problemaSpecifica.includes('ğŸš¨') ? '#e53e3e' : '#4a5568'};">${problemaAfisata}</small></td>
                        <td>${dataFormatata}</td>
                        <td><span class="status-badge ${getPriorityClass(reminder.prioritate)}">${reminder.prioritate}</span></td>
                        <td><small>${reminder.mesaj || '-'}</small></td>
                        <td>
                            <div class="action-buttons">
                                ${reminder.problemaSpecifica ? `<button class="btn btn-success btn-small" onclick="trimiteWhatsAppReminder('${reminder.clientId}', '${reminder.tip}', '${reminder.problemaSpecifica}')" title="ğŸ’¬ Trimite pe WhatsApp" style="background: #25d366; color: white;">ğŸ’¬ WA</button>` : ''}
                                <button class="btn btn-secondary btn-small" onclick="editaReminder(${reminder.id})" title="EditeazÄƒ">âœï¸</button>
                                <button class="btn btn-danger btn-small" onclick="stergeReminder(${reminder.id})" title="È˜terge">ğŸ—‘ï¸</button>
                            </div>
                        </td>
                    </tr>
                `;
            });

            html += '</tbody></table>';
            container.innerHTML = html;
        }

        function stergeReminder(id) {
            if (confirm('EÈ™ti sigur cÄƒ vrei sÄƒ È™tergi acest reminder?')) {
                remindere = remindere.filter(reminder => reminder.id !== id);
                saveData();
                showNotification('Reminder-ul a fost È™ters cu succes!', 'success');
            }
        }

        // Check for pending reminders
        function verificaReminderePendente() {
            const astazi = new Date();
            const alerteContainer = document.getElementById('alerteUrgente');
            let alerteHtml = '';

            // VerificÄƒ reminder-urile care expirÄƒ astÄƒzi sau mÃ¢ine
            const reminderePendente = remindere.filter(reminder => {
                const dataReminder = new Date(reminder.data);
                const diferenta = Math.ceil((dataReminder - astazi) / (1000 * 60 * 60 * 24));
                return diferenta >= 0 && diferenta <= 2 && reminder.status === 'Activ';
            });

            // VerificÄƒ reviziile care expirÄƒ Ã®n urmÄƒtoarele 7 zile
            const reviziiExpira = abonati.filter(abonat => {
                if (!abonat.dataUrmatoareaRevizie) return false;
                const dataRevizie = new Date(abonat.dataUrmatoareaRevizie);
                const diferenta = Math.ceil((dataRevizie - astazi) / (1000 * 60 * 60 * 24));
                return diferenta >= 0 && diferenta <= 7;
            });

            if (reminderePendente.length > 0) {
                alerteHtml += `
                    <div class="alert alert-warning">
                        <strong>ğŸ”” Reminder-e Urgente!</strong> Ai ${reminderePendente.length} reminder-e care expirÄƒ Ã®n urmÄƒtoarele 2 zile.
                    </div>
                `;
                
                // AfiÈ™eazÄƒ notificare È™i pentru reminder-urile urgente
                if (reminderePendente.length > 0) {
                    showNotification(`âš ï¸ Ai ${reminderePendente.length} reminder-e urgente!`, 'warning');
                }
            }

            if (reviziiExpira.length > 0) {
                alerteHtml += `
                    <div class="alert alert-info">
                        <strong>ğŸ” Revizii Programate!</strong> ${reviziiExpira.length} revizii programate Ã®n urmÄƒtoarele 7 zile.
                    </div>
                `;
            }

            if (alerteContainer) {
                alerteContainer.innerHTML = alerteHtml;
            }
        }

        // Utility functions
        function getStatusClass(status) {
            switch(status) {
                case 'ProgramatÄƒ': return 'status-pending';
                case 'Ãn Progres': return 'status-active';
                case 'FinalizatÄƒ': return 'status-active';
                case 'AnulatÄƒ': return 'status-inactive';
                default: return 'status-pending';
            }
        }

        function getPriorityClass(prioritate) {
            switch(prioritate) {
                case 'JoasÄƒ': return 'status-active';
                case 'Medie': return 'status-pending';
                case 'ÃnaltÄƒ': return 'status-inactive';
                case 'UrgentÄƒ': return 'status-urgent';
                default: return 'status-pending';
            }
        }

        // Dashboard update
        function updateDashboard() {
            document.getElementById('totalAbonati').textContent = abonati.length;
            
            const astazi = new Date().toDateString();
            const programariAstazi = programari.filter(p => 
                new Date(p.data).toDateString() === astazi
            ).length;
            document.getElementById('programariAstazi').textContent = programariAstazi;
            
            const remindereActive = remindere.filter(r => r.status === 'Activ').length;
            document.getElementById('remindereActive').textContent = remindereActive;

            // CalculeazÄƒ reviziile din urmÄƒtoarele 7 zile
            const astazi7Zile = new Date();
            astazi7Zile.setDate(astazi7Zile.getDate() + 7);
            const reviziiSaptamana = abonati.filter(abonat => {
                if (!abonat.dataUrmatoareaRevizie) return false;
                const dataRevizie = new Date(abonat.dataUrmatoareaRevizie);
                return dataRevizie >= new Date() && dataRevizie <= astazi7Zile;
            }).length;
            document.getElementById('reviziiSaptamana').textContent = reviziiSaptamana;
        }

        // Reports update
        function updateRapoarte() {
            document.getElementById('raportTotalAbonati').textContent = abonati.length;
            document.getElementById('raportProgramari').textContent = programari.length;
            document.getElementById('raportRemindere').textContent = remindere.filter(r => r.status === 'Activ').length;

            // CalculeazÄƒ reviziile urmÄƒtoarea lunÄƒ
            const astazi = new Date();
            const lunaViitoare = new Date(astazi.getFullYear(), astazi.getMonth() + 1, astazi.getDate());
            const reviziiLunaViitoare = abonati.filter(abonat => {
                if (!abonat.dataUrmatoareaRevizie) return false;
                const dataRevizie = new Date(abonat.dataUrmatoareaRevizie);
                return dataRevizie >= astazi && dataRevizie <= lunaViitoare;
            }).length;
            document.getElementById('raportRevizii').textContent = reviziiLunaViitoare;

            // DistribuÈ›ie pe oraÈ™e
            const distributie = {};
            abonati.forEach(abonat => {
                const oras = abonat.adresa.oras;
                distributie[oras] = (distributie[oras] || 0) + 1;
            });

            let distributieHtml = '';
            Object.entries(distributie).forEach(([oras, count]) => {
                distributieHtml += `<p style="color: #718096;">${oras}: <strong>${count}</strong></p>`;
            });

            document.getElementById('distributieOrase').innerHTML = distributieHtml || '<p style="color: #718096;">Nu existÄƒ date disponibile</p>';

            // DistribuÈ›ie servicii
            const serviciiDistributie = {};
            abonati.forEach(abonat => {
                if (abonat.serviciiContractate) {
                    abonat.serviciiContractate.forEach(serviciu => {
                        serviciiDistributie[serviciu] = (serviciiDistributie[serviciu] || 0) + 1;
                    });
                }
            });

            let serviciiHtml = '';
            Object.entries(serviciiDistributie).forEach(([serviciu, count]) => {
                serviciiHtml += `<p style="color: #718096;">${serviciu}: <strong>${count}</strong></p>`;
            });

            document.getElementById('distributieServicii').innerHTML = serviciiHtml || '<p style="color: #718096;">Nu existÄƒ date disponibile</p>';
        }

        // Export PDF functionality
        function exportRaportPDF() {
            if (typeof window.jsPDF === 'undefined') {
                showNotification('Biblioteca PDF nu este Ã®ncÄƒrcatÄƒ. ÃncearcÄƒ din nou.', 'error');
                return;
            }

            const { jsPDF } = window.jsPDF;
            const doc = new jsPDF();
            
            // Header
            doc.setFontSize(20);
            doc.text('RAPORT COMPLET - GAZTECH SERVICES', 20, 20);
            
            doc.setFontSize(12);
            doc.text(`Generat pe: ${new Date().toLocaleDateString('ro-RO')}`, 20, 30);
            
            let yPosition = 50;
            
            // Statistici generale
            doc.setFontSize(16);
            doc.text('STATISTICI GENERALE', 20, yPosition);
            yPosition += 10;
            
            doc.setFontSize(12);
            doc.text(`Total AbonaÈ›i: ${abonati.length}`, 20, yPosition);
            yPosition += 7;
            doc.text(`Total ProgramÄƒri: ${programari.length}`, 20, yPosition);
            yPosition += 7;
            doc.text(`Total Remindere: ${remindere.length}`, 20, yPosition);
            yPosition += 15;
            
            // AbonaÈ›i
            doc.setFontSize(16);
            doc.text('LISTA ABONAÈšI', 20, yPosition);
            yPosition += 10;
            
            abonati.forEach((abonat, index) => {
                if (yPosition > 250) {
                    doc.addPage();
                    yPosition = 20;
                }
                
                const servicii = abonat.serviciiContractate ? abonat.serviciiContractate.join(', ') : 'N/A';
                const adresa = formatareAdresa(abonat.adresa);
                const dataRevizie = abonat.dataRevizieEfectuata ? new Date(abonat.dataRevizieEfectuata).toLocaleDateString('ro-RO') : 'N/A';
                const dataExpirare = abonat.dataExpirare ? new Date(abonat.dataExpirare).toLocaleDateString('ro-RO') : 'N/A';
                const numarDocumente = abonat.documente ? abonat.documente.length : 0;
                
                doc.setFontSize(12);
                doc.text(`${index + 1}. ${abonat.nume}`, 20, yPosition);
                yPosition += 6;
                doc.setFontSize(10);
                doc.text(`   Tel: ${abonat.telefon} | Email: ${abonat.email || 'N/A'}`, 20, yPosition);
                yPosition += 5;
                doc.text(`   Adresa: ${adresa}`, 20, yPosition);
                yPosition += 5;
                doc.text(`   Servicii: ${servicii}`, 20, yPosition);
                yPosition += 5;
                doc.text(`   Data Revizie: ${dataRevizie} | Expirare: ${dataExpirare}`, 20, yPosition);
                yPosition += 5;
                doc.text(`   Documente: ${numarDocumente}`, 20, yPosition);
                yPosition += 10;
            });
            
            // Salvare
            doc.save(`GazTech_Raport_Complet_${new Date().toISOString().split('T')[0]}.pdf`);
            showNotification('Raportul PDF a fost generat cu succes!', 'success');
        }

        // Export Excel functionality
        function exportRaportExcel() {
            if (typeof XLSX === 'undefined') {
                showNotification('Biblioteca Excel nu este Ã®ncÄƒrcatÄƒ. ÃncearcÄƒ din nou.', 'error');
                return;
            }

            const wb = XLSX.utils.book_new();
            
            // Foi Excel
            const foaieAbonati = [];
            const foaieProgramari = [];
            const foaieRemindere = [];
            const foaieStatistici = [];
            
            // Date abonaÈ›i
            foaieAbonati.push(['Nume', 'Telefon', 'Email', 'CNP', 'OraÈ™', 'Strada', 'NumÄƒr', 'Bloc', 'Scara', 'Etaj', 'Apartament', 'Servicii Contractate', 'Cost Total', 'Data Revizie', 'Data Expirare', 'Tip Client', 'NumÄƒr Documente', 'Status']);
            
            abonati.forEach(abonat => {
                let costTotal = 0;
                if (abonat.serviciiContractate) {
                    abonat.serviciiContractate.forEach(serviciu => {
                        switch(serviciu) {
                            case 'Verificare InstalaÈ›ie Gaz': costTotal += 150; break;
                            case 'Revizie InstalaÈ›ie Gaz': costTotal += 250; break;
                            case 'Verificare CentralÄƒ': costTotal += 150; break;
                            case 'InstalaÈ›ii Gaz + CentralÄƒ': costTotal += 250; break;
                        }
                    });
                }
                
                const servicii = abonat.serviciiContractate ? abonat.serviciiContractate.join('; ') : '';
                const dataRevizie = abonat.dataRevizieEfectuata || '';
                const dataExpirare = abonat.dataExpirare || '';
                const numarDocumente = abonat.documente ? abonat.documente.length : 0;
                
                foaieAbonati.push([
                    abonat.nume,
                    abonat.telefon,
                    abonat.email || '',
                    abonat.cnp || '',
                    abonat.adresa.oras,
                    abonat.adresa.strada || '',
                    abonat.adresa.numar || '',
                    abonat.adresa.numeBlocAbonat || '',
                    abonat.adresa.scara || '',
                    abonat.adresa.etaj || '',
                    abonat.adresa.apartament || '',
                    servicii,
                    costTotal + ' Lei',
                    dataRevizie,
                    dataExpirare,
                    abonat.tipClient === 'nou' ? 'Client Nou' : 'Client Actual',
                    numarDocumente,
                    abonat.status
                ]);
            });
            
            // Date programÄƒri
            foaieProgramari.push(['Client', 'Serviciu', 'Data', 'Status', 'ObservaÈ›ii', 'Tip', 'Data Creare']);
            programari.forEach(p => {
                foaieProgramari.push([
                    p.clientNume,
                    p.tipServiciu,
                    new Date(p.data).toLocaleString('ro-RO'),
                    p.status,
                    p.observatii || '',
                    p.tipAutomat || 'Manual',
                    new Date(p.dataCreare).toLocaleDateString('ro-RO')
                ]);
            });
            
            // Date remindere
            foaieRemindere.push(['Client', 'Tip', 'Data', 'Prioritate', 'Mesaj', 'Status', 'Tip', 'Data Creare']);
            remindere.forEach(r => {
                foaieRemindere.push([
                    r.clientNume,
                    r.tip,
                    new Date(r.data).toLocaleString('ro-RO'),
                    r.prioritate,
                    r.mesaj || '',
                    r.status,
                    r.tipAutomat || 'Manual',
                    new Date(r.dataCreare).toLocaleDateString('ro-RO')
                ]);
            });
            
            // Statistici
            foaieStatistici.push(['StatisticÄƒ', 'Valoare']);
            foaieStatistici.push(['Total AbonaÈ›i', abonati.length]);
            foaieStatistici.push(['Total ProgramÄƒri', programari.length]);
            foaieStatistici.push(['Total Remindere', remindere.length]);
            foaieStatistici.push(['Data Generare', new Date().toLocaleDateString('ro-RO')]);
            
            // AdaugÄƒ foile Ã®n Excel
            const wsAbonati = XLSX.utils.aoa_to_sheet(foaieAbonati);
            const wsProgramari = XLSX.utils.aoa_to_sheet(foaieProgramari);
            const wsRemindere = XLSX.utils.aoa_to_sheet(foaieRemindere);
            const wsStatistici = XLSX.utils.aoa_to_sheet(foaieStatistici);
            
            XLSX.utils.book_append_sheet(wb, wsAbonati, 'AbonaÈ›i');
            XLSX.utils.book_append_sheet(wb, wsProgramari, 'ProgramÄƒri');
            XLSX.utils.book_append_sheet(wb, wsRemindere, 'Remindere');
            XLSX.utils.book_append_sheet(wb, wsStatistici, 'Statistici');
            
            // Salvare
            XLSX.writeFile(wb, `GazTech_Raport_Excel_${new Date().toISOString().split('T')[0]}.xlsx`);
            showNotification('Raportul Excel a fost generat cu succes!', 'success');
        }

        // Export functions
        function exportAbonati() {
            let csvContent = "data:text/csv;charset=utf-8,Nume,Telefon,Email,CNP,OraÈ™,Strada,NumÄƒr,Tip AdresÄƒ,Bloc,Scara,Etaj,Apartament,Servicii Contractate,Tip Client,Prima Revizie,UrmÄƒtoarea Revizie,Status\n";
            
            abonati.forEach(a => {
                const servicii = a.serviciiContractate ? a.serviciiContractate.join(';') : '';
                const primaRevizie = a.dataPrimaRevizie || '';
                const urmatoareaRevizie = a.dataUrmatoareaRevizie || '';
                
                csvContent += `"${a.nume}","${a.telefon}","${a.email || ''}","${a.cnp || ''}","${a.adresa.oras}","${a.adresa.strada || ''}","${a.adresa.numar || ''}","${a.adresa.tipAdresa || ''}","${a.adresa.numeBlocAbonat || ''}","${a.adresa.scara || ''}","${a.adresa.etaj || ''}","${a.adresa.apartament || ''}","${servicii}","${a.tipClient}","${primaRevizie}","${urmatoareaRevizie}","${a.status}"\n`;
            });

            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "gaztech_abonati.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('Datele abonaÈ›ilor au fost exportate!', 'success');
        }

        function exportProgramari() {
            const csvContent = "data:text/csv;charset=utf-8," 
                + "Client,Serviciu,Data,Status,ObservaÈ›ii,Tip\n"
                + programari.map(p => 
                    `"${p.clientNume}","${p.tipServiciu}","${new Date(p.data).toLocaleString('ro-RO')}","${p.status}","${p.observatii || ''}","${p.tipAutomat || 'Manual'}"`
                ).join("\n");

            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "gaztech_programari.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('Datele programÄƒrilor au fost exportate!', 'success');
        }

        function exportRemindere() {
            const csvContent = "data:text/csv;charset=utf-8," 
                + "Client,Tip,Data,Prioritate,Mesaj,Status,Tip\n"
                + remindere.map(r => 
                    `"${r.clientNume}","${r.tip}","${new Date(r.data).toLocaleString('ro-RO')}","${r.prioritate}","${r.mesaj || ''}","${r.status}","${r.tipAutomat || 'Manual'}"`
                ).join("\n");

            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "gaztech_remindere.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('Datele reminder-urilor au fost exportate!', 'success');
        }

        function exportRevizii() {
            let csvContent = "data:text/csv;charset=utf-8,Nume,Telefon,AdresÄƒ CompletÄƒ,Servicii,Prima Revizie,UrmÄƒtoarea Revizie,Periodicitate,Zile Notificare\n";
            
            abonati.filter(a => a.dataUrmatoareaRevizie).forEach(a => {
                const adresaCompleta = formatareAdresa(a.adresa);
                const servicii = a.serviciiContractate ? a.serviciiContractate.join(';') : '';
                
                csvContent += `"${a.nume}","${a.telefon}","${adresaCompleta}","${servicii}","${a.dataPrimaRevizie || ''}","${a.dataUrmatoareaRevizie}","${a.periodicitateRevizie} ani","${a.zileNotificare} zile"\n`;
            });

            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "gaztech_revizii.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('Datele reviziilor au fost exportate!', 'success');
        }

        // Search functionality
        document.getElementById('searchAbonati')?.addEventListener('input', (e) => {
            const searchTerm = e.target.value.toLowerCase();
            const rows = document.querySelectorAll('#listaAbonati tbody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        });

        // Close modal when clicking outside
        window.addEventListener('click', (e) => {
            const modal = document.getElementById('modalDocumente');
            if (e.target === modal) {
                inchideModalDocumente();
            }
        });

        // ADAUGÄ‚ DATE DE TEST PENTRU DEMONSTRAÈšIA SINCRONIZÄ‚RII
        function adaugaDateDeTest() {
            if (abonati.length === 0) {
                // AbonaÈ›i de test
                const abonatiTest = [
                    {
                        id: 1000001,
                        tipClient: 'nou',
                        nume: 'Popescu Ion',
                        telefon: '0721234567',
                        email: 'ion.popescu@email.ro',
                        cnp: '1801010120001',
                        adresa: {
                            oras: 'Alexandria',
                            strada: 'Str. LibertÄƒÈ›ii',
                            numar: '12',
                            tipAdresa: 'Casa',
                            numeBlocAbonat: '',
                            scara: '',
                            etaj: '',
                            apartament: ''
                        },
                        serviciiContractate: ['Verificare InstalaÈ›ie Gaz', 'Verificare CentralÄƒ'],
                        dataRevizieEfectuata: '2023-06-15',
                        dataExpirare: '2025-06-15',
                        dataPrimaRevizie: '2023-06-15',
                        periodicitateRevizie: '2',
                        dataUrmatoareaRevizie: '2025-06-15',
                        zileNotificare: '7',
                        documente: [
                            {
                                id: 1001,
                                nume: 'Certificat_Instalatie.pdf',
                                tip: 'application/pdf',
                                marime: 245760,
                                continut: 'JVBERi0xLjQKJcOkw7zDtsO2CjIgMCBvYmoKPDwvTGVuZ3==',
                                dataIncarcare: '2024-01-15T10:30:00.000Z'
                            }
                        ],
                        numarNotificari: 2,
                        ultimaNotificare: '2024-12-01T10:00:00.000Z',
                        dataCreare: '2024-01-15T10:30:00.000Z',
                        status: 'Activ'
                    },
                    {
                        id: 1000002,
                        tipClient: 'actual',
                        nume: 'Ionescu Maria',
                        telefon: '0734567890',
                        email: 'maria.ionescu@yahoo.ro',
                        cnp: '2850505110002',
                        adresa: {
                            oras: 'RoÈ™iorii de Vede',
                            strada: 'Bd. Republicii',
                            numar: '45',
                            tipAdresa: 'Bloc',
                            numeBlocAbonat: 'Bl. A3',
                            scara: 'B',
                            etaj: '4',
                            apartament: '23'
                        },
                        serviciiContractate: ['InstalaÈ›ii Gaz + CentralÄƒ'],
                        dataRevizieEfectuata: '2024-01-20',
                        dataExpirare: '2026-01-20',
                        dataPrimaRevizie: '2024-01-20',
                        periodicitateRevizie: '2',
                        dataUrmatoareaRevizie: '2026-01-20',
                        zileNotificare: '3',
                        documente: [],
                        numarNotificari: 0,
                        ultimaNotificare: null,
                        dataCreare: '2024-02-10T14:20:00.000Z',
                        status: 'Activ'
                    },
                    {
                        id: 1000003,
                        tipClient: 'nou',
                        nume: 'Georgescu Andrei',
                        telefon: '0745123789',
                        email: '',
                        cnp: '',
                        adresa: {
                            oras: 'Turnu MÄƒgurele',
                            strada: 'Str. Mihai Viteazu',
                            numar: '78',
                            tipAdresa: 'Casa',
                            numeBlocAbonat: '',
                            scara: '',
                            etaj: '',
                            apartament: ''
                        },
                        serviciiContractate: ['Revizie InstalaÈ›ie Gaz'],
                        dataRevizieEfectuata: '2024-11-01',
                        dataExpirare: '2026-11-01',
                        dataPrimaRevizie: '2024-11-01',
                        periodicitateRevizie: '2',
                        dataUrmatoareaRevizie: '2026-11-01',
                        zileNotificare: '2',
                        documente: [
                            {
                                id: 1002,
                                nume: 'Plan_Instalatie.jpg',
                                tip: 'image/jpeg',
                                marime: 524288,
                                continut: '/9j/4AAQSkZJRgABAQAAAQABAAD/2wBD==',
                                dataIncarcare: '2024-11-02T09:15:00.000Z'
                            },
                            {
                                id: 1003,
                                nume: 'Factura_Revizie.pdf',
                                tip: 'application/pdf',
                                marime: 180224,
                                continut: 'JVBERi0xLjQKJcOkw7zDtsO2CjIgMCB==',
                                dataIncarcare: '2024-11-02T09:20:00.000Z'
                            }
                        ],
                        numarNotificari: 1,
                        ultimaNotificare: '2024-11-25T16:00:00.000Z',
                        dataCreare: '2024-11-01T16:45:00.000Z',
                        status: 'Activ'
                    }
                ];

                // ProgramÄƒri de test
                const programariTest = [
                    {
                        id: 2000001,
                        clientId: 1000001,
                        clientNume: 'Popescu Ion',
                        tipServiciu: 'Verificare InstalaÈ›ie Gaz',
                        data: new Date().toISOString(), // AstÄƒzi
                        status: 'ProgramatÄƒ',
                        observatii: 'Verificare anualÄƒ programatÄƒ automat',
                        tipAutomat: 'revizie',
                        dataCreare: '2024-12-01T08:00:00.000Z'
                    },
                    {
                        id: 2000002,
                        clientId: 1000002,
                        clientNume: 'Ionescu Maria',
                        tipServiciu: 'InstalaÈ›ii Gaz + CentralÄƒ',
                        data: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString(), // MÃ¢ine
                        status: 'ProgramatÄƒ',
                        observatii: 'Client prioritar - apartament',
                        dataCreare: '2024-12-02T10:30:00.000Z'
                    },
                    {
                        id: 2000003,
                        clientId: 1000003,
                        clientNume: 'Georgescu Andrei',
                        tipServiciu: 'Revizie InstalaÈ›ie Gaz',
                        data: '2024-11-25T14:00:00.000Z',
                        status: 'FinalizatÄƒ',
                        observatii: 'Revizie completatÄƒ cu succes',
                        dataCreare: '2024-11-20T12:00:00.000Z'
                    }
                ];

                // Remindere de test
                const remindereTest = [
                    {
                        id: 3000001,
                        clientId: 1000001,
                        clientNume: 'Popescu Ion',
                        tip: 'Verificare/Revizie AutomatÄƒ',
                        data: new Date(Date.now() + 12 * 60 * 60 * 1000).toISOString(), // Ãn 12 ore
                        prioritate: 'ÃnaltÄƒ',
                        mesaj: 'REVIZIE EXPIRING pentru Popescu Ion - Servicii: Verificare InstalaÈ›ie Gaz, Verificare CentralÄƒ - Cost total: 300 Lei - Adresa: Alexandria, Str. LibertÄƒÈ›ii 12 - Tel: 0721234567',
                        status: 'Activ',
                        tipAutomat: 'revizie',
                        dataCreare: '2024-11-01T09:00:00.000Z'
                    },
                    {
                        id: 3000002,
                        clientId: 1000002,
                        clientNume: 'Ionescu Maria',
                        tip: 'UrmÄƒrire Client',
                        data: new Date(Date.now() + 2 * 24 * 60 * 60 * 1000).toISOString(), // Ãn 2 zile
                        prioritate: 'Medie',
                        mesaj: 'UrmÄƒrire pentru Ã®ncÄƒrcarea documentelor lipsÄƒ',
                        status: 'Activ',
                        dataCreare: '2024-12-01T15:00:00.000Z'
                    },
                    {
                        id: 3000003,
                        clientId: 1000003,
                        clientNume: 'Georgescu Andrei',
                        tip: 'Facturare',
                        data: new Date(Date.now() + 48 * 60 * 60 * 1000).toISOString(), // Ãn 48 ore
                        prioritate: 'UrgentÄƒ',
                        mesaj: 'Facturare pentru revizia efectuatÄƒ',
                        status: 'Activ',
                        dataCreare: '2024-11-25T16:00:00.000Z'
                    }
                ];

                // AdaugÄƒ datele de test
                abonati.push(...abonatiTest);
                programari.push(...programariTest);
                remindere.push(...remindereTest);
                
                // SalveazÄƒ datele
                saveData();
                
                showNotification('âœ… Date de test adÄƒugate pentru demonstraÈ›ia sincronizÄƒrii!', 'success');
                console.log('ğŸ“Š Date de test adÄƒugate:', {
                    abonati: abonatiTest.length,
                    programari: programariTest.length, 
                    remindere: remindereTest.length
                });
            }
        }

        // FUNCÈšIE AVANSATÄ‚ DE SINCRONIZARE CU PROGRESS
        function sincronizareAvansata() {
            showNotification('ğŸ”„ Ãncepe sincronizarea avansatÄƒ...', 'info');
            
            setTimeout(() => {
                // ActualizeazÄƒ toate componentele
                updateClientDropdowns();
                updateDashboard();
                updateRapoarte();
                
                // VerificÄƒ È™i curÄƒÈ›Äƒ datele
                verificaConsistentaDatele();
                
                showNotification('âœ… Sincronizare avansatÄƒ completÄƒ!', 'success');
                showSyncIndicator();
            }, 1000);
        }

        function verificaConsistentaDatele() {
            let problemeGasite = 0;
            
            // VerificÄƒ programÄƒrile orfane
            programari.forEach((programare, index) => {
                if (programare.clientId !== 'nou' && !abonati.find(a => a.id == programare.clientId)) {
                    console.warn(`Programare orfanÄƒ gÄƒsitÄƒ: ${programare.clientNume}`);
                    problemeGasite++;
                }
            });
            
            // VerificÄƒ reminder-ele orfane
            remindere.forEach((reminder, index) => {
                if (reminder.clientId !== 'nou' && !abonati.find(a => a.id == reminder.clientId)) {
                    console.warn(`Reminder orfan gÄƒsit: ${reminder.clientNume}`);
                    problemeGasite++;
                }
            });
            
            if (problemeGasite > 0) {
                showNotification(`âš ï¸ ${problemeGasite} probleme de consistenÈ›Äƒ gÄƒsite`, 'warning');
            }
            
            console.log(`ğŸ” Verificare consistenÈ›Äƒ: ${problemeGasite} probleme gÄƒsite`);
        }

        // BACKUP È˜I RESTORE
        function creeazaBackup() {
            const backup = {
                timestamp: new Date().toISOString(),
                versiune: '1.0',
                abonati: abonati,
                programari: programari,
                remindere: remindere
            };
            
            const dataStr = JSON.stringify(backup, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `GazTech_Backup_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showNotification('ğŸ’¾ Backup creat cu succes!', 'success');
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', async function() {
            // Ãnregistrare Service Worker pentru PWA
            if ('serviceWorker' in navigator) {
                try {
                    // Service Worker inline pentru PWA
                    const swCode = `
                        const CACHE_NAME = 'gaztech-v1';
                        const urlsToCache = ['/'];
                        
                        self.addEventListener('install', event => {
                            event.waitUntil(
                                caches.open(CACHE_NAME)
                                    .then(cache => cache.addAll(urlsToCache))
                            );
                        });
                        
                        self.addEventListener('fetch', event => {
                            event.respondWith(
                                caches.match(event.request)
                                    .then(response => {
                                        if (response) {
                                            return response;
                                        }
                                        return fetch(event.request);
                                    })
                            );
                        });
                    `;
                    
                    const blob = new Blob([swCode], { type: 'application/javascript' });
                    const swUrl = URL.createObjectURL(blob);
                    
                    await navigator.serviceWorker.register(swUrl);
                    console.log('âœ… PWA Service Worker Ã®nregistrat cu succes!');
                    
                    // AfiÈ™eazÄƒ prompt pentru instalare PWA
                    window.addEventListener('beforeinstallprompt', (e) => {
                        e.preventDefault();
                        showNotification('ğŸ“± PoÈ›i instala GazTech ca aplicaÈ›ie pe telefon!', 'info');
                        
                        setTimeout(() => {
                            e.prompt();
                        }, 3000);
                    });
                    
                } catch (error) {
                    console.warn('âš ï¸ Service Worker nu s-a putut Ã®nregistra:', error);
                }
            }

            // ActualizeazÄƒ interfaÈ›a cu valorile corecte
            actualizeazaInterfata();
            
            // VerificÄƒ statusul Firebase
            verificaStatusFirebase();
            
            // ÃncearcÄƒ sÄƒ Ã®ncarce datele din Firebase
            await incarcareInitialaDinFirebase();
            
            // AdaugÄƒ date de test dacÄƒ nu existÄƒ
            if (abonati.length === 0) {
                adaugaDateDeTest();
            }
            
            // Sincronizare iniÈ›ialÄƒ
            sincronizeazaDatele();
            
            // IniÈ›ializeazÄƒ upload-ul de fiÈ™iere
            initializeFileUpload();
            
            // AdaugÄƒ event listeners pentru calculul costului
            adaugaListeneriCost();
            actualizareaCostului();
            
            // Check for urgent reminders every 5 minutes
            setInterval(verificaReminderePendente, 5 * 60 * 1000);
            
            // Verificare automatÄƒ notificÄƒri la fiecare 30 minute
            setInterval(verificaNotificariAutomated, 30 * 60 * 1000);
            
            // Sincronizare avansatÄƒ la fiecare 30 secunde
            setInterval(sincronizareAvansata, 30000);
            
            // Sincronizare cu Firebase la fiecare 2 minute
            if (db) {
                setInterval(sincronizareCuFirestore, 2 * 60 * 1000);
            }
            
            console.log('âœ… GazTech Services s-a Ã®ncÄƒrcat complet cu NOTIFICÄ‚RI & PWA!');
            console.log('ğŸ“Š AbonaÈ›i:', abonati.length);
            console.log('ğŸ“… ProgramÄƒri:', programari.length);
            console.log('ğŸ”” Remindere:', remindere.length);
            console.log('ğŸ”„ Sincronizare: ACTIVÄ‚');
            console.log('ğŸ“ Gestionare documente: COMPLETÄ‚');
            console.log('ğŸ’¾ Backup: DISPONIBIL');
            console.log('ğŸ“± NotificÄƒri expirÄƒri/plÄƒÈ›i: ACTIVE');
            console.log('ğŸ’¬ WhatsApp: INTEGRAT');
            console.log('ğŸ”¥ Firebase:', db ? 'CONECTAT' : 'OFFLINE');
            console.log('ğŸ“± PWA: Service Worker Ã®nregistrat');
            console.log('ğŸ“ Telefon firmÄƒ:', CONFIGURARI_FIRMA.telefon);
        });

        // Error handling
        window.addEventListener('error', function(e) {
            console.error('Error captat È™i gestionat:', e.error);
            showNotification('A apÄƒrut o eroare, dar aplicaÈ›ia continuÄƒ sÄƒ funcÈ›ioneze.', 'warning');
        });
    </script>
</body>
</html>
